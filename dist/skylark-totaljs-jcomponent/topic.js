/**
 * skylark-totaljs-jcomponent - A version of totaljs jcomponent that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylarkui/skylark-totaljs-jcomponent/
 * @license MIT
 */
define(["./jc","./langx"],function(n,t){var r={};var i=[];return n.topic={on:function n(e,s,u,a,o){if(-1!==e.indexOf(MULTIPLE)){for(var f=e.split(MULTIPLE).trim(),h=0;h<f.length;h++)n(f[h],s,u,a,o);return this}var l=!0;"^"===e.substring(0,1)&&(l=!1,e=e.substring(1));var c=null,g=e.indexOf("#");g&&(c=e.substring(0,g).trim(),e=e.substring(g+1).trim()),t.isFunction(s)?(u=s,s="watch"===e?"*":""):s=s.replace(".*","");var v={name:e,fn:u,owner:c||current_owner,context:o||(null==current_com?void 0:current_com)};if("watch"===e){f=[];var p=findFormat(s);if(p&&(s=p.path,v.format=p.fn),"."===s.substring(s.length-1)&&(s=s.substring(0,s.length-1)),37===s.charCodeAt(0)&&(s="jctmp."+s.substring(1)),33===(s=s.env()).charCodeAt(0))s=s.substring(1),f.push(s);else for(var m=s.split("."),d=[],b=0;b<m.length;b++){var w=m[b].lastIndexOf("[");if(-1!==w){var x=d.join(".");f.push(x+(x?".":"")+m[b].substring(0,w))}d.push(m[b]),f.push(d.join("."))}v.path=s,v.$path=f,l?i.push(v):i.unshift(v),a&&u.call(o||M,s,v.format?v.format(get(s),s,0):get(s),0)}else r[e]?l?r[e].push(v):r[e].unshift(v):r[e]=[v],!C.ready&&("ready"===e||"init"===e)&&u();return this},off:function n(t,e,s){if(-1!==t.indexOf("+")){for(var u=t.split("+").trim(),a=0;a<u.length;a++)n(u[a],e,s);return this}lang.isFunction(e)&&(s=e,e=""),void 0===e&&(e="");var o=null,f=t.indexOf("#");if(f&&(o=t.substring(0,f).trim(),t=t.substring(f+1).trim()),e){e=e.replace(".*","").trim();var h=findFormat(e);h&&(e=h.path),"."===e.substring(e.length-1)&&(e=e.substring(0,e.length-1))}var l=0;!o||e||s||t?o&&t&&!s&&!e?l=2:o&&t&&e?l=3:o&&t&&e&&s?l=4:t&&e&&s?l=5:t&&e?l=7:s&&(l=6):l=1;var c=function(n,r){return n.remove(function(n){return!(l>2&&l<5&&n.path!==e)&&(1===l?n.owner===o:2===l?r===t&&n.owner===o:3===l?r===t&&n.owner===o:4===l?r===t&&n.owner===o&&n.fn===s:5===l||6===l?r===t&&n.fn===s:6===l?n.fn===s:7===l?r===t&&n.path===e:r===t)})};return Object.keys(r).forEach(function(n){r[n]=c(r[n],n),r[n].length||delete r[n]}),i=c(i,"watch"),this},emit:function(n){var t=r[n];if(!t)return!1;for(var i=[],e=1,s=arguments.length;e<s;e++)i.push(arguments[e]);for(e=0,s=t.length;e<s;e++){var u=t[e].context;(void 0===u||null!==u&&!u.$removed)&&t[e].fn.apply(u||window,i)}return!0}}});
//# sourceMappingURL=sourcemaps/topic.js.map
