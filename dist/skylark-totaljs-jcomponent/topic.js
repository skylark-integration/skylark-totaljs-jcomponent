/**
 * skylark-totaljs-jcomponent - A version of totaljs jcomponent that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylarkui/skylark-totaljs-jcomponent/
 * @license MIT
 */
define(["./jc","./langx","./caches"],function(t,r,n){var e={};return t.topic={on:function t(r,n,i,s,a){if(-1!==r.indexOf(MULTIPLE)){for(var u=r.split(MULTIPLE).trim(),f=0;f<u.length;f++)t(u[f],n,i,s,a);return this}var o=!0;"^"===r.substring(0,1)&&(o=!1,r=r.substring(1));var h=null,c=r.indexOf("#");c&&(h=r.substring(0,c).trim(),r=r.substring(c+1).trim()),typeof n===TYPE_FN?(i=n,n="watch"===r?"*":""):n=n.replace(".*","");var l={name:r,fn:i,owner:h||current_owner,context:a||(null==current_com?void 0:current_com)};if("watch"===r){u=[];var g=findFormat(n);if(g&&(n=g.path,l.format=g.fn),"."===n.substring(n.length-1)&&(n=n.substring(0,n.length-1)),37===n.charCodeAt(0)&&(n="jctmp."+n.substring(1)),33===(n=n.env()).charCodeAt(0))n=n.substring(1),u.push(n);else for(var p=n.split("."),v=[],m=0;m<p.length;m++){var d=p[m].lastIndexOf("[");if(-1!==d){var w=v.join(".");u.push(w+(w?".":"")+p[m].substring(0,d))}v.push(p[m]),u.push(v.join("."))}l.path=n,l.$path=u,o?watches.push(l):watches.unshift(l),s&&i.call(a||M,n,l.format?l.format(get(n),n,0):get(n),0)}else e[r]?o?e[r].push(l):e[r].unshift(l):e[r]=[l],!C.ready&&("ready"===r||"init"===r)&&i();return this},off:function(t,r,n){if(-1!==t.indexOf("+")){for(var i=t.split("+").trim(),s=0;s<i.length;s++)W.OFF(i[s],r,n);return this}typeof r===TYPE_FN&&(n=r,r=""),void 0===r&&(r="");var a=null,u=t.indexOf("#");if(u&&(a=t.substring(0,u).trim(),t=t.substring(u+1).trim()),r){r=r.replace(".*","").trim();var f=findFormat(r);f&&(r=f.path),"."===r.substring(r.length-1)&&(r=r.substring(0,r.length-1))}var o=0;!a||r||n||t?a&&t&&!n&&!r?o=2:a&&t&&r?o=3:a&&t&&r&&n?o=4:t&&r&&n?o=5:t&&r?o=7:n&&(o=6):o=1;var h=function(e,i){return e.remove(function(e){return!(o>2&&o<5&&e.path!==r)&&(1===o?e.owner===a:2===o?i===t&&e.owner===a:3===o?i===t&&e.owner===a:4===o?i===t&&e.owner===a&&e.fn===n:5===o||6===o?i===t&&e.fn===n:6===o?e.fn===n:7===o?i===t&&e.path===r:i===t)})};return Object.keys(e).forEach(function(t){e[t]=h(e[t],t),e[t].length||delete e[t]}),watches=h(watches,"watch"),this},emit:function(t){var r=e[t];if(!r)return!1;for(var n=[],i=1,s=arguments.length;i<s;i++)n.push(arguments[i]);for(i=0,s=r.length;i<s;i++){var a=r[i].context;(void 0===a||null!==a&&!a.$removed)&&r[i].fn.apply(a||window,n)}return!0}}});
//# sourceMappingURL=sourcemaps/topic.js.map
