{"version":3,"sources":["views/plugins.js"],"names":["define","$","jc","plugins","registry","Plugin","name","fn","test","warn","$remove","t","this","element","id","call","prototype","register","find","clean","R","Object","keys","forEach","key","a","inDOM","innerHTML"],"mappings":";;;;;;;AAAAA,QACC,iBACA,SACC,SAASC,EAAGC,GAgGb,OA9FA,SAASC,IACR,IAAIC,KAEJ,SAASC,EAAOC,EAAMC,GACjB,KAAOC,KAAKF,IACfG,KAAK,4CAEFL,EAASE,IACZF,EAASE,GAAMI,SAAQ,GAExB,IAAIC,EAAIC,KAERD,EAAEE,QAAUZ,EAAE,cACdU,EAAEG,GAAK,OAASR,EAChBK,EAAEL,KAAOA,EACTF,EAASE,GAAQK,EAGjBJ,EAAGQ,KAAKJ,EAAGA,GAkEZ,OA7DAN,EAAOW,UAAUN,QAAU,WAG1B,OADWE,KACDC,UADCD,KA+BNC,QAAU,YAERT,EAjCIQ,KAiCUN,OACd,KA0BPD,OAAWA,EACXY,SAvBD,SAAkBX,EAAMC,GACvB,OAAOA,EAAK,IAAIF,EAAOC,EAAMC,GAAMH,EAASE,IAuB5CF,SAAaA,EACbc,KArBD,SAAcZ,GACb,OAAOF,EAASE,IAqBhBa,MAlBD,WAEE,IAAIC,EAAIjB,EAAQC,SAChBiB,OAAOC,KAAKF,GAAGG,QAAQ,SAASC,GAC/B,IAAIC,EAAIL,EAAEI,GACLE,MAAMD,EAAEZ,QAAQ,KAAQY,EAAEZ,QAAQ,GAAGc,YACzCF,EAAEf,iBACKU,EAAEI","file":"../../views/plugins.js","sourcesContent":["define([\r\n\t\"../utils/query\",\r\n\t\"../jc\"\r\n],function($, jc){\r\n\r\n\tfunction plugins() {\r\n\t\tvar registry = {}; // W.PLUGINS\r\n\r\n\t\tfunction Plugin(name, fn) {\r\n\t\t\tif ((/\\W/).test(name)) {\r\n\t\t\t\twarn('Plugin name must contain A-Z chars only.');\r\n\t\t\t}\r\n\t\t\tif (registry[name]) {\r\n\t\t\t\tregistry[name].$remove(true);\r\n\t\t\t}\r\n\t\t\tvar t = this;\r\n\t\t\t//t.element = $(caches.current.element || document.body); // TODO\r\n\t\t\tt.element = $(\".importing\");\r\n\t\t\tt.id = 'plug' + name;\r\n\t\t\tt.name = name;\r\n\t\t\tregistry[name] = t;\r\n\t\t\t//var a = caches.current.owner;\r\n\t\t\t//caches.current.owner = t.id;\r\n\t\t\tfn.call(t, t);\r\n\t\t\t//caches.current.owner = a;\r\n\t\t\t// topic.emit('plugin', t); // EMIT TODO\r\n\t\t}\r\n\r\n\t\tPlugin.prototype.$remove = function() {\r\n\r\n\t\t\tvar self = this;\r\n\t\t\tif (!self.element) {\t\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t\t/* TODO\r\n\t\t\ttopic.emit('plugin.destroy', self); // EMIT\r\n\t\t\tif (self.destroy) {\r\n\t\t\t\tself.destroy();\r\n\t\t\t}\r\n\r\n\t\t\t// Remove all global events\r\n\t\t\tObject.keys(events).forEach(function(e) {\r\n\t\t\t\tvar evt = events[e];\r\n\t\t\t\tevt = evt.remove('owner', self.id);\r\n\t\t\t\tif (!evt.length) {\r\n\t\t\t\t\tdelete events[e];\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\twatches = watches.remove('owner', self.id);\r\n\r\n\t\t\t// Remove events\r\n\t\t\ttopic.off(self.id + '#watch'); // OFF \r\n\t\t\t*/\r\n\r\n\t\t\t// Remove schedulers\r\n\t\t\t//schedulers = schedulers.remove('owner', self.id);\r\n\t\t\t//schedulers.clearAll(self.id);\r\n\r\n\t\t\t// self.element.remove();\r\n\t\t\tself.element = null;\r\n\r\n\t\t\tdelete registry[self.name];\r\n\t\t\treturn true;\r\n\t\t};\r\n\r\n\r\n\t\tfunction register(name, fn) { //W.PLUGIN = \r\n\t\t\treturn fn ? new Plugin(name, fn) : registry[name]; // W.PLUGINS\r\n\t\t};\r\n\r\n\t\tfunction find(name) {\r\n\t\t\treturn registry[name];\r\n\t\t}\r\n\r\n\t\tfunction clean() {\r\n\t\t\t\t// Checks PLUGINS\r\n\t\t\t\tvar R = plugins.registry; //W.PLUGINS;\r\n\t\t\t\tObject.keys(R).forEach(function(key) {\r\n\t\t\t\t\tvar a = R[key];\r\n\t\t\t\t\tif (!inDOM(a.element[0]) || !a.element[0].innerHTML) {\r\n\t\t\t\t\t\ta.$remove();\r\n\t\t\t\t\t\tdelete R[key];\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\treturn  {\r\n\t\t\t\"Plugin\" : Plugin,\r\n\t\t\t\"register\" : register,\r\n\t\t\t\"registry\" : registry,\r\n\t\t\t\"find\" : find,\r\n\t\t\t\"clean\" : clean\r\n\t\t};\r\n\r\n\t}\r\n\r\n\treturn plugins;\r\n});"]}