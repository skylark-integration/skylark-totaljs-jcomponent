{"version":3,"sources":["views/cleaner.js"],"names":["define","topic","cleaner","index","is","each","key","arr","item","undefined","context","element","inDOM","remove","$removed","splice","length","events","watches","all","component","c","attr","ATTRDEL","emit","name","statics","destroy","$","ID","nodeName","off","find","$main","$data","dom","path","setter","setter2","getter","getter2","make","$parser","$formatter","keys","Object","binders","i","j","o","el","e","$br","clear","R","plugins","registry","forEach","a","innerHTML","$remove","W","DATETIME","NOW","Date","now","getTime","is2","is3","blocked","MD","localstorage","M","isPRIVATEMODE","localStorage","setItem","$localstorage","JSON","stringify","storage","expire","save","refresh","setTimeout","compile","setInterval"],"mappings":"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","file":"../../views/cleaner.js","sourcesContent":["define([\r\n\t\"../topic\"\r\n],function(topic) {\r\n\tfunction cleaner2() {\r\n\t\tclear();\r\n\t\tcleaner();\r\n\t}\r\n\r\n\tfunction cleaner() {\r\n\t\tvar is = false;\r\n\t\tvar index;\r\n\r\n\t\ttopic.each(function(key,arr){\r\n\t\t\tindex = 0;\r\n\t\t\twhile (true) {\r\n\r\n\t\t\t\tvar item = arr[index++];\r\n\t\t\t\tif (item === undefined) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (item.context == null || (item.context.element && inDOM(item.context.element[0]))) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (item.context && item.context.element) {\r\n\t\t\t\t\titem.context.element.remove();\r\n\t\t\t\t}\r\n\r\n\t\t\t\titem.context.$removed = true;\r\n\t\t\t\titem.context = null;\r\n\t\t\t\tarr.splice(index - 1, 1);\r\n\r\n\t\t\t\tif (!arr.length) {\r\n\t\t\t\t\tdelete events[key];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tindex -= 2;\r\n\t\t\t\tis = true;\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n\t\tindex = 0;\r\n\t\twhile (true) {\r\n\t\t\tvar item = watches[index++];\r\n\t\t\tif (item === undefined)\r\n\t\t\t\tbreak;\r\n\t\t\tif (item.context == null || (item.context.element && inDOM(item.context.element[0])))\r\n\t\t\t\tcontinue;\r\n\t\t\titem.context && item.context.element && item.context.element.remove();\r\n\t\t\titem.context.$removed = true;\r\n\t\t\titem.context = null;\r\n\t\t\twatches.splice(index - 1, 1);\r\n\t\t\tindex -= 2;\r\n\t\t\tis = true;\r\n\t\t}\r\n\r\n\t\t//var all =  M.components;\r\n \t\tindex = 0;\r\n\t\tlength = all.length;\r\n\r\n\t\twhile (index < length) {\r\n\r\n\t\t\tvar component = all[index++];\r\n\r\n\t\t\tif (!component) {\r\n\t\t\t\tindex--;\r\n\t\t\t\tall.splice(index, 1);\r\n\t\t\t\tlength = all.length;\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tvar c = component.element;\r\n\t\t\tif (!component.$removed && c && inDOM(c[0])) {\r\n\t\t\t\tif (!component.attr(ATTRDEL)) {\r\n\t\t\t\t\tif (component.$parser && !component.$parser.length)\r\n\t\t\t\t\t\tcomponent.$parser = undefined;\r\n\t\t\t\t\tif (component.$formatter && !component.$formatter.length)\r\n\t\t\t\t\t\tcomponent.$formatter = undefined;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\ttopic.emit('destroy', component.name, component);\r\n\t\t\ttopic.emit('component.destroy', component.name, component);\r\n\r\n\t\t\tdelete statics['$ST_' + component.name];\r\n\t\t\tcomponent.destroy && component.destroy();\r\n\t\t\t$('#css' + component.ID).remove();\r\n\r\n\t\t\tif (c[0].nodeName !== 'BODY') {\r\n\t\t\t\tc.off();\r\n\t\t\t\tc.find('*').off();\r\n\t\t\t\tc.remove();\r\n\t\t\t}\r\n\r\n\t\t\tcomponent.$main = undefined;\r\n\t\t\tcomponent.$data = null;\r\n\t\t\tcomponent.dom = null;\r\n\t\t\tcomponent.$removed = 2;\r\n\t\t\tcomponent.path = null;\r\n\t\t\tcomponent.setter = null;\r\n\t\t\tcomponent.setter2 = null;\r\n\t\t\tcomponent.getter = null;\r\n\t\t\tcomponent.getter2 = null;\r\n\t\t\tcomponent.make = null;\r\n\r\n\t\t\tindex--;\r\n\t\t\tall.splice(index, 1);\r\n\t\t\tlength = all.length; // M.components.length\r\n\t\t\tis = true;\r\n\t\t}\r\n\r\n\t\tkeys = Object.keys(binders);\r\n\t\tfor (var i = 0; i < keys.length; i++) {\r\n\t\t\tarr = binders[keys[i]];\r\n\t\t\tvar j = 0;\r\n\t\t\twhile (true) {\r\n\t\t\t\tvar o = arr[j++];\r\n\t\t\t\tif (!o)\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tif (inDOM(o.el[0]))\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\tvar e = o.el;\r\n\t\t\t\tif (!e[0].$br) {\r\n\t\t\t\t\te.off();\r\n\t\t\t\t\te.find('*').off();\r\n\t\t\t\t\te[0].$br = 1;\r\n\t\t\t\t}\r\n\t\t\t\tj--;\r\n\t\t\t\tarr.splice(j, 1);\r\n\t\t\t}\r\n\t\t\tif (!arr.length)\r\n\t\t\t\tdelete binders[keys[i]];\r\n\t\t}\r\n\r\n\t\tclear('find');\r\n\r\n\t\t// Checks PLUGINS\r\n\t\tvar R = plugins.registry; //W.PLUGINS;\r\n\t\tObject.keys(R).forEach(function(key) {\r\n\t\t\tvar a = R[key];\r\n\t\t\tif (!inDOM(a.element[0]) || !a.element[0].innerHTML) {\r\n\t\t\t\ta.$remove();\r\n\t\t\t\tdelete R[key];\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tW.DATETIME = W.NOW = new Date();\r\n\t\tvar now = W.NOW.getTime();\r\n\t\tvar is2 = false;\r\n\t\tvar is3 = false;\r\n\r\n\t\tfor (var key in blocked) {\r\n\t\t\tif (blocked[key] <= now) {\r\n\t\t\t\tdelete blocked[key];\r\n\t\t\t\tis2 = true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (MD.localstorage && is2 && !M.isPRIVATEMODE)  // W.isPRIVATEMODE\r\n\t\t\tlocalStorage.setItem(M.$localstorage + '.blocked', JSON.stringify(blocked));\r\n\r\n\t\tfor (var key in storage) {\r\n\t\t\tvar item = storage[key];\r\n\t\t\tif (!item.expire || item.expire <= now) {\r\n\t\t\t\tdelete storage[key];\r\n\t\t\t\tis3 = true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tis3 && save();\r\n\r\n\t\tif (is) {\r\n\t\t\trefresh();\r\n\t\t\tsetTimeout(compile, 2000);\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tsetInterval(function() {\r\n//\t\ttemp = {};\r\n//\t\tpaths = {};\r\n\t\tcleaner();\r\n\t}, (1000 * 60) * 5);\r\n\r\n\treturn cleaner;\r\n});"]}