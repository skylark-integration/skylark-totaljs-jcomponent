{"version":3,"sources":["views/helper.js"],"names":["define","langx","domx","$","Component","configs","MD","keypress","view","ATTRCOM","ATTRURL","ATTRDATA","ATTRDEL","ATTRREL","ATTRSCOPE","ATTRCOMPILE","REGCOM","findControl","container","onElement","level","arr","childNodes","sub","inputable","i","length","el","tagName","getAttribute","push","attrcom","name","attrd","attrbind","attrscope","canCompile","html","innerHTML","test","findComponent","selector","callback","index","components","s","split","path","id","version","substring","indexOf","trim","lastIndexOf","undefined","stop","find","option","each","com","this","$com","$loaded","$removed","$name","$version","$pp","pathscope","findControl2","input","$inputcontrol","element","findUrl","kill","$el","removeData","attr","makeurl","url","make","builder","encodeURIComponent","join","nested","Array","apply","nocompile","value","released","scope","results","closest","reesults","startView","elm","keypressdelay","self","$jctimeout","dirty","getter","on","$jckeypress","$jcevent","tmp","config","$realtime","$binding","$jcdelay","$delay","delay","$jconly","$keypress","clearTimeout","setTimeout","e","type","$jcskip","$skip","setter","get","sel","selectedIndex","checked","setterX"],"mappings":"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","file":"../../views/helper.js","sourcesContent":["define([\r\n\t\"../langx\",\t\r\n\t\"../utils/domx\",\t\r\n\t\"../utils/query\",\t\r\n\t\"../components/Component\",\r\n\t\"../components/configs\"\r\n],function(langx, domx, $,Component,configs){\r\n\r\n\tvar MD = {\r\n\t\tkeypress : true,\r\n\r\n\t};\r\n\r\n\tfunction helper(view) {\r\n\t\tvar ATTRCOM = '[data-jc]',\r\n\t\t\tATTRURL = '[data-jc-url]',\r\n\t\t\tATTRDATA = 'jc',\r\n\t\t\tATTRDEL = 'data-jc-removed',\r\n\t\t\tATTRREL = 'data-jc-released',\r\n\t\t\tATTRSCOPE = 'data-jc-scope',\r\n\t\t\tATTRCOMPILE = 'data-jc-comile';\r\n\r\n\r\n\t\tvar REGCOM = /(data-jc|data-jc-url|data-jc-import|data-bind|bind)=|COMPONENT\\(/;\r\n\r\n\t\tfunction findControl2(com, input) {\r\n\r\n\t\t\tif (com.$inputcontrol) {\r\n\t\t\t\tif (com.$inputcontrol % 2 !== 0) {\r\n\t\t\t\t\tcom.$inputcontrol++;\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar target = input ? input : com.element;\r\n\t\t\tfindControl(target[0], function(el) {\r\n\t\t\t\tif (!el.$com || el.$com !== com) {\r\n\t\t\t\t\tel.$com = com;\r\n\t\t\t\t\tcom.$inputcontrol = 1;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tfunction findControl(container, onElement, level) {\r\n\r\n\t\t\tvar arr = container.childNodes;\r\n\t\t\tvar sub = [];\r\n\r\n\t\t\tdomx.inputable(container) && onElement(container);\r\n\r\n\t\t\tif (level == null) {\r\n\t\t\t\tlevel = 0;\r\n\t\t\t} else {\r\n\t\t\t\tlevel++;\r\n\t\t\t}\r\n\r\n\t\t\tfor (var i = 0, length = arr.length; i < length; i++) {\r\n\t\t\t\tvar el = arr[i];\r\n\t\t\t\tif (el && el.tagName) {\r\n\t\t\t\t\tel.childNodes.length && el.tagName !== 'SCRIPT' && el.getAttribute('data-jc') == null && sub.push(el);\r\n\t\t\t\t\tif (domx.inputable(el) && el.getAttribute('data-jc-bind') != null && onElement(el) === false)\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfor (var i = 0, length = sub.length; i < length; i++) {\r\n\t\t\t\tel = sub[i];\r\n\t\t\t\tif (el && findControl(el, onElement, level) === false) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// find all nested component\r\n\t\tfunction nested(el) {\r\n\t\t\tvar $el = $(el),\r\n\t\t\t\tarr = [];\r\n\t\t\t$el.find(ATTRCOM).each(function() {\r\n\t\t\t\tvar el = $(this);\r\n\t\t\t\tvar com = el[0].$com;\r\n\t\t\t\tif (com && !el.attr(ATTRDEL)) {\r\n\t\t\t\t\tif (com instanceof Array) {\r\n\t\t\t\t\t\tarr.push.apply(arr, com);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tarr.push(com);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn arr;\r\n\t\t}\r\n\r\n\t\t// destory all nested component\r\n\t\tfunction kill(el) {\r\n\t\t\tvar $el = $(el);\r\n\t\t\t$el.removeData(ATTRDATA);\r\n\t\t\t$el.attr(ATTRDEL, 'true').find(ATTRCOM).attr(ATTRDEL, 'true');\r\n\t\t}\r\n\r\n\t\tfunction findComponent(container, selector, callback) {\r\n\t\t\tvar components = view.components;\r\n\r\n\t\t\tvar s = (selector ? selector.split(' ') : []);\r\n\t\t\tvar path = '';\r\n\t\t\tvar name = '';\r\n\t\t\tvar id = '';\r\n\t\t\tvar version = '';\r\n\t\t\tvar index;\r\n\r\n\t\t\tfor (var i = 0, length = s.length; i < length; i++) {\r\n\t\t\t\tswitch (s[i].substring(0, 1)) {\r\n\t\t\t\t\tcase '*':\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase '.':\r\n\t\t\t\t\t\t// path\r\n\t\t\t\t\t\tpath = s[i].substring(1);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase '#':\r\n\t\t\t\t\t\t// id;\r\n\t\t\t\t\t\tid = s[i].substring(1);\r\n\t\t\t\t\t\tindex = id.indexOf('[');\r\n\t\t\t\t\t\tif (index !== -1) {\r\n\t\t\t\t\t\t\tpath = id.substring(index + 1, id.length - 1).trim();\r\n\t\t\t\t\t\t\tid = id.substring(0, index);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t// name\r\n\t\t\t\t\t\tname = s[i];\r\n\t\t\t\t\t\tindex = name.indexOf('[');\r\n\r\n\t\t\t\t\t\tif (index !== -1) {\r\n\t\t\t\t\t\t\tpath = name.substring(index + 1, name.length - 1).trim();\r\n\t\t\t\t\t\t\tname = name.substring(0, index);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tindex = name.lastIndexOf('@');\r\n\r\n\t\t\t\t\t\tif (index !== -1) {\r\n\t\t\t\t\t\t\tversion = name.substring(index + 1);\r\n\t\t\t\t\t\t\tname = name.substring(0, index);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar arr = callback ? undefined : [];\r\n\t\t\tif (container) {\r\n\t\t\t\tvar stop = false;\r\n\t\t\t\tcontainer.find('['+view.option(\"elmAttrNames.com.base\")+']').each(function() { // [data-jc]\r\n\t\t\t\t\tvar com = this.$com;\r\n\r\n\t\t\t\t\tif (stop || !com || !com.$loaded || com.$removed || (id && com.id !== id) || (name && com.$name !== name) || (version && com.$version !== version) || (path && (com.$pp || (com.path !== path && (!com.pathscope || ((com.pathscope + '.' + path) !== com.path))))))\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\tif (callback) {\r\n\t\t\t\t\t\tif (callback(com) === false) {\r\n\t\t\t\t\t\t\tstop = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tarr.push(com);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tfor (var i = 0, length = components.length; i < length; i++) { // M.components.length\r\n\t\t\t\t\tvar com = components[i]; // M.components[i]\r\n\t\t\t\t\tif (!com || !com.$loaded || com.$removed || (id && com.id !== id) || (name && com.$name !== name) || (version && com.$version !== version) || ((path && (com.$pp || (com.path !== path && (!com.pathscope || ((com.pathscope + '.' + path) !== com.path)))))))\r\n\t\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t\tif (callback) {\r\n\t\t\t\t\t\tif (callback(com) === false) {\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tarr.push(com);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn arr;\r\n\t\t}\r\n\r\n\t\tfunction attrcom(el, name) {\r\n\t\t\tname = name ? '-' + name : '';\r\n\t\t\treturn el.getAttribute ? el.getAttribute('data-jc' + name) : el.attrd('jc' + name);\r\n\t\t}\r\n\r\n\t\tfunction attrbind(el) {\r\n\t\t\treturn el.getAttribute('data-bind') || el.getAttribute('bind');\r\n\t\t}\r\n\r\n\t\tfunction attrscope(el) {\r\n\t\t\treturn el.getAttribute(ATTRSCOPE);\r\n\t\t}\r\n\r\n\t\tfunction scope(el) {\r\n\t\t\tvar results = $(el).closest('[' + ATTRCOMPILE + ']');\r\n\t\t\tif (results && results.length) {\r\n\t\t\t\treturn reesults[0];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfunction nocompile(el,value) {\r\n\t\t\tif (value === undefined) {\r\n\t\t\t\tvar value = $(el).attr(ATTRCOMPILE) ;\r\n\t\t\t\tif (value === '0' || value === 'false') {\r\n\t\t\t\t\t// no compile\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t$(el).attr(ATTRCOMPILE,value);\r\n\t\t\t\treturn this; \r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfunction released(el,value) {\r\n\t\t\tif (value === undefined) {\r\n\t\t\t\tvar value = $(el).attr(ATTRREL) ;\r\n\t\t\t\tif (value === '0' || value === 'false') {\r\n\t\t\t\t\t// no compile\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t$(el).attr(ATTRREL,value);\r\n\t\t\t\treturn this; \r\n\t\t\t}\r\n\t\t}\t\t\r\n\r\n\t\tfunction canCompile(el) {\r\n\t\t\tvar html = el.innerHTML ? el.innerHTML : el;\r\n\t\t\treturn REGCOM.test(html);\r\n\t\t}\r\n\r\n\t\tfunction findUrl(container) {\r\n\t\t\treturn $(ATTRURL,container);\r\n\t\t}\r\n\r\n\t\tfunction makeurl(url, make) {\r\n\r\n\t\t\t// TODO\r\n\t\t\t//defaults.makeurl && (url = defaults.makeurl(url));\r\n\t\t\t//\r\n\t\t\t//if (make)\r\n\t\t\t//\treturn url;\r\n\r\n\t\t\tvar builder = [];\r\n\t\t\tvar en = encodeURIComponent;\r\n\r\n\t\t\t//M.$version && builder.push('version=' + en(M.$version));\r\n\t\t\t//M.$language && builder.push('language=' + en(M.$language));\r\n\r\n\t\t\tif (!builder.length)\r\n\t\t\t\treturn url;\r\n\r\n\t\t\tvar index = url.indexOf('?');\r\n\t\t\tif (index == -1)\r\n\t\t\t\turl += '?';\r\n\t\t\telse\r\n\t\t\t\turl += '&';\r\n\r\n\t\t\treturn url + builder.join('&');\r\n\t\t}\r\n\r\n\t\tfunction startView() {\r\n\t\t\tvar $el = $(view.elm());\r\n\r\n\t\t\t//if ($ready) {\r\n\t\t\t//\tclearTimeout($ready);\r\n\t\t\t//\tload();\r\n\t\t\t//}\r\n\r\n\t\t\tfunction keypressdelay(self) {\r\n\t\t\t\tvar com = self.$com;\r\n\t\t\t\t// Reset timeout\r\n\t\t\t\tself.$jctimeout = 0;\r\n\t\t\t\t// It's not dirty\r\n\t\t\t\tcom.dirty(false, true);\r\n\t\t\t\t// Binds a value\r\n\t\t\t\tcom.getter(self.value, true);\r\n\t\t\t}\r\n\t\t\t\r\n\r\n\t\t\t$el.on('input', 'input[data-jc-bind],textarea[data-jc-bind]', function() {\r\n\r\n\t\t\t\t// realtime binding\r\n\t\t\t\tvar self = this;\r\n\t\t\t\tvar com = self.$com;\r\n\r\n\t\t\t\tif (!com || com.$removed || !com.getter || self.$jckeypress === false) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tself.$jcevent = 2;\r\n\r\n\t\t\t\tif (self.$jckeypress === undefined) {\r\n\t\t\t\t\tvar tmp = attrcom(self, 'keypress');\r\n\t\t\t\t\tif (tmp)\r\n\t\t\t\t\t\tself.$jckeypress = tmp === 'true';\r\n\t\t\t\t\telse if (com.config.$realtime != null)\r\n\t\t\t\t\t\tself.$jckeypress = com.config.$realtime === true;\r\n\t\t\t\t\telse if (com.config.$binding)\r\n\t\t\t\t\t\tself.$jckeypress = com.config.$binding === 1;\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\tself.$jckeypress = MD.keypress;\r\n\t\t\t\t\tif (self.$jckeypress === false)\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (self.$jcdelay === undefined) {\r\n\t\t\t\t\tself.$jcdelay = +(attrcom(self, 'keypress-delay') || com.config.$delay || MD.delay);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (self.$jconly === undefined) {\r\n\t\t\t\t\tself.$jconly = attrcom(self, 'keypress-only') === 'true' || com.config.$keypress === true || com.config.$binding === 2;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (self.$jctimeout) {\r\n\t\t\t\t\tclearTimeout(self.$jctimeout);\t\r\n\t\t\t\t} \r\n\t\t\t\tself.$jctimeout = setTimeout(keypressdelay, self.$jcdelay, self);\r\n\t\t\t});\r\n\r\n\t\t\t$el.on('focus blur', 'input[data-jc-bind],textarea[data-jc-bind],select[data-jc-bind]', function(e) {\r\n\r\n\t\t\t\tvar self = this;\r\n\t\t\t\tvar com = self.$com;\r\n\r\n\t\t\t\tif (!com || com.$removed || !com.getter)\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\tif (e.type === 'focusin')\r\n\t\t\t\t\tself.$jcevent = 1;\r\n\t\t\t\telse if (self.$jcevent === 1) {\r\n\t\t\t\t\tcom.dirty(false, true);\r\n\t\t\t\t\tcom.getter(self.value, 3);\r\n\t\t\t\t} else if (self.$jcskip) {\r\n\t\t\t\t\tself.$jcskip = false;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// formatter\r\n\t\t\t\t\tvar tmp = com.$skip;\r\n\t\t\t\t\tif (tmp)\r\n\t\t\t\t\t\tcom.$skip = false;\r\n\t\t\t\t\tcom.setter(com.get(), com.path, 2);\r\n\t\t\t\t\tif (tmp) {\r\n\t\t\t\t\t\tcom.$skip = tmp;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t$el.on('change', 'input[data-jc-bind],textarea[data-jc-bind],select[data-jc-bind]', function() {\r\n\r\n\t\t\t\tvar self = this;\r\n\t\t\t\tvar com = self.$com;\r\n\r\n\t\t\t\tif (self.$jconly || !com || com.$removed || !com.getter)\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\tif (self.$jckeypress === false) {\r\n\t\t\t\t\t// bind + validate\r\n\t\t\t\t\tself.$jcskip = true;\r\n\t\t\t\t\tcom.getter(self.value, false);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tswitch (self.tagName) {\r\n\t\t\t\t\tcase 'SELECT':\r\n\t\t\t\t\t\tvar sel = self[self.selectedIndex];\r\n\t\t\t\t\t\tself.$jcevent = 2;\r\n\t\t\t\t\t\tcom.dirty(false, true);\r\n\t\t\t\t\t\tcom.getter(sel.value, false);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\tcase 'INPUT':\r\n\t\t\t\t\t\tif (self.type === 'checkbox' || self.type === 'radio') {\r\n\t\t\t\t\t\t\tself.$jcevent = 2;\r\n\t\t\t\t\t\t\tcom.dirty(false, true);\r\n\t\t\t\t\t\t\tcom.getter(self.checked, false);\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (self.$jctimeout) {\r\n\t\t\t\t\tcom.dirty(false, true);\r\n\t\t\t\t\tcom.getter(self.value, true);\r\n\t\t\t\t\tclearTimeout(self.$jctimeout);\r\n\t\t\t\t\tself.$jctimeout = 0;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.$jcskip = true;\r\n\t\t\t\t\tcom.setter && com.setterX(com.get(), self.path, 2);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t//setTimeout(compile, 2);\r\n\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\t\"attrcom\" \t\t: attrcom,\r\n\t\t\t\"attrbind\"      : attrbind,\r\n\t\t\t\"attrscope\"     : attrscope,\r\n\t\t\t\"canCompile\"    : canCompile,\r\n\t\t\t\"Component\"     : Component,\r\n\t\t\t\"findComponent\" : findComponent,\r\n\t\t\t\"findControl\" \t: findControl,\r\n\t\t\t\"findControl2\" \t: findControl2,\r\n\t\t\t\"findUrl\"       : findUrl,\r\n\t\t\t\"kill\"          : kill,\r\n\t\t\t\"makeurl\"\t\t: makeurl,\r\n\t\t\t\"nested\"        : nested,\r\n\t\t\t\"nocompile\" \t: nocompile,\r\n\t\t\t\"released\" \t\t: released,\r\n\t\t\t\"scope\" \t\t: scope,\r\n\t\t\t\"startView\"     : startView\r\n\t\t};\r\n\r\n\t}\r\n\r\n\treturn helper;\r\n});"]}