{"version":3,"sources":["views/compose.js"],"names":["define","langx","fallback","lazycom","$","dependencies","declaration","callback","obj","el","importing","wait","length","item","next","isFunction","IMPORT","indexOf","setTimeout","view","name","dom","level","scope","meta","split","REGMETA","trim","has","statics","remove","instances","all","y","is","keys","i","key","M","$components","lazy","substring","toLowerCase","lastIndexOf","versions","MD","version","com","lo","namea","state","Component","parent","parentNode","$com","pc","owner","$children","nodeName","global","shared","element","p","attrcom","_id","$noscope","setPath","pathmaker","config","reconfigure","NOOP","tmp","$init","type","id","siblings","$lazy","configs","con","fn","caches","current","call","attrd","init","code","path","charCodeAt","$pp","output","initscopes","replace","$$path","EMPTYARRAY","pathscope","push","template","$released","warn","format","isString","data","prerender","make","c","html","k","HASH","a","get","makeurl","response","x","imports","import"],"mappings":"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","file":"../../views/compose.js","sourcesContent":["define([\r\n\t\"../langx\"\r\n],function(langx){\r\n\tvar\tfallback = 'https://cdn.componentator.com/j-{0}.html';\r\n\tvar\tfallbackcache = '';\r\n\r\n\tvar lazycom = {};\r\n\r\n\tvar fallback = { $: 0 }; // $ === count of new items in fallback\r\n\t\r\n\tfunction dependencies(declaration, callback, obj, el) {\r\n\r\n\t\tif (declaration.importing) {\r\n\t\t\tlangx.wait(function() {\r\n\t\t\t\treturn declaration.importing !== true;\r\n\t\t\t}, function() {\r\n\t\t\t\tcallback(obj, el);\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (!declaration.dependencies || !declaration.dependencies.length) {\r\n\t\t\tsetTimeout(function(callback, obj, el) {\r\n\t\t\t\tcallback(obj, el);\r\n\t\t\t}, 5, callback, obj, el);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tdeclaration.importing = true;\r\n\t\tdeclaration.dependencies.wait(function(item, next) {\r\n\t\t\tif (langx.isFunction(item)) {\r\n\t\t\t\titem(next);\r\n\t\t\t} else {\r\n\t\t\t\tIMPORT((item.indexOf('<') === -1 ? 'once ' : '') + item, next);\r\n\t\t\t}\r\n\t\t}, function() {\r\n\t\t\tdeclaration.importing = false;\r\n\t\t\tcallback(obj, el);\r\n\t\t}, 3);\r\n\t}\r\n\t\r\n\r\n\tfunction onComponent(view, name, dom, level, scope) {\r\n\r\n\t\tvar el = $(dom);\r\n\t\tvar meta = name.split(REGMETA);\r\n\t\tif (meta.length) {\r\n\t\t\tmeta = meta.trim(true);\r\n\t\t\tname = meta[0];\r\n\t\t} else\r\n\t\t\tmeta = null;\r\n\r\n\t\thas = true;\r\n\r\n\t\t// Check singleton instance\r\n\t\tif (statics['$ST_' + name]) {\r\n\t\t\tremove(el);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar instances = [];\r\n\t\tvar all = name.split(',');\r\n\r\n\t\tfor (var y = 0; y < all.length; y++) {\r\n\r\n\t\t\tvar name = all[y].trim();\r\n\t\t\tvar is = false;\r\n\r\n\t\t\tif (name.indexOf('|') !== -1) {\r\n\r\n\t\t\t\t// Multiple versions\r\n\t\t\t\tvar keys = name.split('|');\r\n\t\t\t\tfor (var i = 0; i < keys.length; i++) {\r\n\t\t\t\t\tvar key = keys[i].trim();\r\n\t\t\t\t\tif (key && M.$components[key]) {\r\n\t\t\t\t\t\tname = key;\r\n\t\t\t\t\t\tis = true;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!is) {\r\n\t\t\t\t\tname = keys[0].trim();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar lazy = false;\r\n\r\n\t\t\tif (name.substring(0, 5).toLowerCase() === 'lazy ') {\r\n\t\t\t\tname = name.substring(5);\r\n\t\t\t\tlazy = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (!is && name.lastIndexOf('@') === -1) {\r\n\t\t\t\tif (versions[name]) {\r\n\t\t\t\t\tname += '@' + versions[name];\r\n\t\t\t\t} else if (MD.version) {\r\n\t\t\t\t\tname += '@' + MD.version;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar com = M.$components[name];\r\n\t\t\tvar lo = null;\r\n\r\n\t\t\tif (lazy && name) {\r\n\t\t\t\tvar namea = name.substring(0, name.indexOf('@'));\r\n\t\t\t\tlo = lazycom[name];\r\n\t\t\t\tif (!lo) {\r\n\t\t\t\t\tif (namea && name !== namea) {\r\n\t\t\t\t\t\tlazycom[name] = lazycom[namea] = { state: 1 };\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tlazycom[name] = { state: 1 };\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tif (lo.state === 1) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (!com) {\r\n\r\n\t\t\t\tif (!fallback[name]) {\r\n\t\t\t\t\tfallback[name] = 1;\r\n\t\t\t\t\tfallback.$++;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar x = view.attrcom(el, 'import');\r\n\t\t\t\tif (!x) {\r\n\t\t\t\t\t!statics['$NE_' + name] && (statics['$NE_' + name] = true);\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (view.imports[x] === 1) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (view.imports[x] === 2) {\r\n\t\t\t\t\t!statics['$NE_' + name] && (statics['$NE_' + name] = true);\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tview.imports[x] = 1;\r\n\t\t\t\tview.importing++;\r\n\r\n\t\t\t\tM.import(x, function() {\r\n\t\t\t\t\tview.importing--;\r\n\t\t\t\t\tview.imports[x] = 2;\r\n\t\t\t\t});\r\n\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tif (fallback[name] === 1) {\r\n\t\t\t\tfallback.$--;\r\n\t\t\t\tdelete fallback[name];\r\n\t\t\t}\r\n\r\n\t\t\tvar obj = new Component(com.name);\r\n\t\t\tvar parent = dom.parentNode;\r\n\r\n\t\t\twhile (true) {\r\n\t\t\t\tif (parent.$com) {\r\n\t\t\t\t\tvar pc = parent.$com;\r\n\t\t\t\t\tobj.owner = pc;\r\n\t\t\t\t\tif (pc.$children) {\r\n\t\t\t\t\t\tpc.$children++;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tpc.$children = 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t} else if (parent.nodeName === 'BODY') {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tparent = parent.parentNode;\r\n\t\t\t\tif (parent == null) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tobj.global = com.shared;\r\n\t\t\tobj.element = el;\r\n\t\t\tobj.dom = dom;\r\n\r\n\t\t\tvar p = view.attrcom(el, 'path') || (meta ? meta[1] === 'null' ? '' : meta[1] : '') || obj._id;\r\n\r\n\t\t\tif (p.substring(0, 1) === '%') {\r\n\t\t\t\tobj.$noscope = true;\r\n\t\t\t}\r\n\r\n\t\t\tobj.setPath(pathmaker(p, true), 1);\r\n\t\t\tobj.config = {};\r\n\r\n\t\t\t// Default config\r\n\t\t\tif (com.config) {\r\n\t\t\t\tobj.reconfigure(com.config, NOOP);\r\n\t\t\t}\r\n\r\n\t\t\tvar tmp = attrcom(el, 'config') || (meta ? meta[2] === 'null' ? '' : meta[2] : '');\r\n\t\t\tif (tmp) {\r\n\t\t\t\tobj.reconfigure(tmp, NOOP);\r\n\t\t\t}\r\n\r\n\t\t\tif (!obj.$init) {\r\n\t\t\t\tobj.$init = attrcom(el, 'init') || null;\r\n\t\t\t}\r\n\r\n\t\t\tif (!obj.type) {\r\n\t\t\t\tobj.type = attrcom(el, 'type') || '';\r\n\t\t\t}\r\n\r\n\t\t\tif (!obj.id) {\r\n\t\t\t\tobj.id = attrcom(el, 'id') || obj._id;\r\n\t\t\t}\r\n\r\n\t\t\tobj.siblings = all.length > 1;\r\n\t\t\tobj.$lazy = lo;\r\n\r\n\t\t\tfor (var i = 0; i < configs.length; i++) {\r\n\t\t\t\tvar con = configs[i];\r\n\t\t\t\tcon.fn(obj) && obj.reconfigure(con.config, NOOP);\r\n\t\t\t}\r\n\r\n\t\t\tcaches.current.com = obj;\r\n\t\t\tcom.declaration.call(obj, obj, obj.config);\r\n\t\t\tcaches.current.com = null;\r\n\r\n\t\t\tmeta[3] && el.attrd('jc-value', meta[3]);\r\n\r\n\t\t\tif (obj.init && !statics[name]) {\r\n\t\t\t\tstatics[name] = true;\r\n\t\t\t\tobj.init();\r\n\t\t\t}\r\n\r\n\t\t\tdom.$com = obj;\r\n\r\n\t\t\tif (!obj.$noscope) {\r\n\t\t\t\tobj.$noscope = view.attrcom(el, 'noscope') === 'true';\r\n\t\t\t}\r\n\r\n\t\t\tvar code = obj.path ? obj.path.charCodeAt(0) : 0;\r\n\t\t\tif (!obj.$noscope && scope.length && !obj.$pp) {\r\n\r\n\t\t\t\tvar output = initscopes(scope);\r\n\r\n\t\t\t\tif (obj.path && code !== 33 && code !== 35) {\r\n\t\t\t\t\tobj.setPath(obj.path === '?' ? output.path : (obj.path.indexOf('?') === -1 ? output.path + '.' + obj.path : obj.path.replace(/\\?/g, output.path)), 2);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tobj.$$path = EMPTYARRAY;\r\n\t\t\t\t\tobj.path = '';\r\n\t\t\t\t}\r\n\r\n\t\t\t\tobj.scope = output;\r\n\t\t\t\tobj.pathscope = output.path;\r\n\t\t\t}\r\n\r\n\t\t\tinstances.push(obj);\r\n\r\n\t\t\tvar template = view.attrcom(el, 'template') || obj.template;\r\n\t\t\tif (template) {\r\n\t\t\t\tobj.template = template;\r\n\t\t\t}\r\n\r\n\t\t\tif (view.attrcom(el, 'released') === 'true') {\r\n\t\t\t\tobj.$released = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (view.attrcom(el, 'url')) {\r\n\t\t\t\twarn('Components: You have to use \"data-jc-template\" attribute instead of \"data-jc-url\" for the component: {0}[{1}].'.format(obj.name, obj.path));\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tif (langx.isString(template)) {\r\n\t\t\t\tvar fn = function(data) {\r\n\t\t\t\t\tif (obj.prerender) {\r\n\t\t\t\t\t\tdata = obj.prerender(data);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdependencies(com, function(obj, el) {\r\n\t\t\t\t\t\tif (langx.isFunction(obj.make)) {\r\n\t\t\t\t\t\t\tvar parent = caches.current.com;\r\n\t\t\t\t\t\t\tcaches.current.com = obj;\r\n\t\t\t\t\t\t\tobj.make(data);\r\n\t\t\t\t\t\t\tcaches.current.com = parent;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tinit(el, obj);\r\n\t\t\t\t\t}, obj, el);\r\n\t\t\t\t};\r\n\r\n\t\t\t\tvar c = template.substring(0, 1);\r\n\t\t\t\tif (c === '.' || c === '#' || c === '[') {\r\n\t\t\t\t\tfn($(template).html());\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar k = 'TE' + HASH(template);\r\n\t\t\t\tvar a = statics[k];\r\n\t\t\t\tif (a) {\r\n\t\t\t\t\tfn(a);\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$.get(makeurl(template), function(response) {\r\n\t\t\t\t\tstatics[k] = response;\r\n\t\t\t\t\tfn(response);\r\n\t\t\t\t});\r\n\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tif (langx.isString(obj.make)) {\r\n\r\n\t\t\t\tif (obj.make.indexOf('<') !== -1) {\r\n\t\t\t\t\tdependencies(com, function(obj, el) {\r\n\t\t\t\t\t\tif (obj.prerender)\r\n\t\t\t\t\t\t\tobj.make = obj.prerender(obj.make);\r\n\t\t\t\t\t\tel.html(obj.make);\r\n\t\t\t\t\t\tinit(el, obj);\r\n\t\t\t\t\t}, obj, el);\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$.get(makeurl(obj.make), function(data) {\r\n\t\t\t\t\tdependencies(com, function(obj, el) {\r\n\t\t\t\t\t\tif (obj.prerender) {\r\n\t\t\t\t\t\t\tdata = obj.prerender(data);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tel.html(data);\r\n\t\t\t\t\t\tinit(el, obj);\r\n\t\t\t\t\t}, obj, el);\r\n\t\t\t\t});\r\n\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tif (com.dependencies) {\r\n\t\t\t\tdependencies(com, function(obj, el) {\r\n\r\n\t\t\t\t\tif (obj.make) {\r\n\t\t\t\t\t\tvar parent = caches.current.com;\r\n\t\t\t\t\t\tcaches.current.com = obj;\r\n\t\t\t\t\t\tobj.make();\r\n\t\t\t\t\t\tcaches.current.com = parent;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tinit(el, obj);\r\n\t\t\t\t}, obj, el);\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// Because sometimes make doesn't contain the content of the element\r\n\t\t\t\tsetTimeout(function(init, el, obj) {\r\n\r\n\t\t\t\t\tif (obj.make) {\r\n\t\t\t\t\t\tvar parent = caches.current.com;\r\n\t\t\t\t\t\tcaches.current.com = obj;\r\n\t\t\t\t\t\tobj.make();\r\n\t\t\t\t\t\tcaches.current.com = parent;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tinit(el, obj);\r\n\t\t\t\t}, 5, init, el, obj);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// A reference to instances\r\n\t\tif (instances.length > 0) {\r\n\t\t\tel.$com = instances.length > 1 ? instances : instances[0];\r\n\t\t}\r\n\r\n\t}\r\n\t\r\n\treturn onComponent;\r\n});"]}