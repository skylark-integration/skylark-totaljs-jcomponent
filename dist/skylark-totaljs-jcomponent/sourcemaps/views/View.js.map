{"version":3,"sources":["views/View.js"],"names":["define","langx","compose","crawler","download","pend","$rebinder","Evented","inherit","options","elmComAttrNames","base","url","removed","released","scope","_construct","this","is","recompile","importing","pending","init","imports","ready","attrcom","el","compile","container","immediate","self","arr","W","READY","Array","push","apply","jComponent","components","length","fn","shift","clearTimeout","setTimeout","bindersnew","splice","i","item","com","exec","data","path","getx","undefined","toggles","async","next","toggle","element","tclass","refresh","setTimeout2","all","sort","a","b","$removed","al","bl","LCOMPARER"],"mappings":";;;;;;;AAAAA,QACC,WACA,YACA,YACA,aACA,UACC,SAASC,EAAOC,EAASC,EAASC,EAAUC,GAE7C,IAAIC,EA6HJ,OA1GWC,QAAQC,SACfC,SACEC,iBACEC,KAAO,UACPC,IAAM,cACNC,QAAU,kBACVC,SAAW,mBACXC,MAAQ,kBAIfC,WAAa,SAASP,GAErBQ,KAAKC,IAAK,EACVD,KAAKE,WAAY,EACjBF,KAAKG,UAAY,EACjBH,KAAKI,WACLJ,KAAKK,QACLL,KAAKM,WACLN,KAAKO,UAGNC,QAAU,SAASC,GAClB,OAAOD,QAAQC,IAGhBC,QAAU,SAAUC,EAAUC,GAC7B,IAAIC,EAAOb,KAEX,GAAIa,EAAKZ,GACRY,EAAKX,WAAY,MADlB,CAKA,IAAIY,KAYJ,GAVIC,EAAEC,iBAAiBC,OACtBH,EAAII,KAAKC,MAAML,EAAKC,EAAEC,OAEnBD,EAAEK,sBAAsBH,OAC3BH,EAAII,KAAKC,MAAML,EAAKC,EAAEK,YAEnBL,EAAEM,sBAAsBJ,OAC3BH,EAAII,KAAKC,MAAML,EAAKC,EAAEM,YAGnBP,EAAIQ,OACP,OAAa,CACZ,IAAIC,EAAKT,EAAIU,QACb,IAAKD,EACJ,MAEDA,IAOF,GAHAV,EAAKZ,IAAK,EACVd,EAAS0B,GAELA,EAAKT,QAAQkB,QAChB,SAAUX,GACTE,EAAKT,QAAQc,KAAK,WACjBR,QAAQG,EAAKF,KAFf,CAIGA,OALJ,CAoBA,GATAzB,EAAQ2B,EAAKF,EAAW1B,GAtFzBI,GAAaoC,aAAapC,GAC1BA,EAAYqC,WAAW,WAEtB,IADA,IAAIZ,EAAMa,WAAWC,OAAO,GACnBC,EAAI,EAAGA,EAAIf,EAAIQ,OAAQO,IAAK,CACpC,IAAIC,EAAOhB,EAAIe,GACVC,EAAKzB,OACLyB,EAAKC,IACRD,EAAKE,KAAKF,EAAKC,IAAIE,KAAKH,EAAKI,MAAOJ,EAAKI,MAEzCJ,EAAKE,KAAKG,KAAKL,EAAKI,MAAOJ,EAAKI,SAIjC,IA+EDrB,EAAKZ,IAAK,OAGOmC,IAAdzB,IAA4B0B,QAAQf,OACvC,OAAOlC,IAGRJ,EAAMsD,MAAMD,QAAS,SAASP,EAAMS,GACnC,IAAK,IAAIV,EAAI,EAAGP,EAASQ,EAAKU,OAAOlB,OAAQO,EAAIP,EAAQO,IACxDC,EAAKW,QAAQC,OAAOZ,EAAKU,OAAOX,IACjCU,KACEnD,MAGJuD,QAAU,WACTC,YAAY,WAAY,WACvBC,IAAIC,KAAK,SAASC,EAAGC,GACpB,GAAID,EAAEE,WAAaF,EAAEb,KACpB,OAAO,EACR,GAAIc,EAAEC,WAAaD,EAAEd,KACpB,OAAQ,EACT,IAAIgB,EAAKH,EAAEb,KAAKZ,OACZ6B,EAAKH,EAAEd,KAAKZ,OAChB,OAAO4B,EAAKC,GAAO,EAAID,IAAOC,EAAKC,UAAUL,EAAEb,KAAMc,EAAEd,MAAQ,KAE9D","file":"../../views/View.js","sourcesContent":["define([\r\n\t\"../langx\",\r\n\t\"./compose\",\r\n\t\"./crawler\",\r\n\t\"./download\",\r\n\t\"./pend\"\r\n],function(langx, compose, crawler, download, pend){\r\n\r\n\tvar $rebinder;\r\n\r\n\tfunction rebindbinder() {\r\n\t\t$rebinder && clearTimeout($rebinder);\r\n\t\t$rebinder = setTimeout(function() {\r\n\t\t\tvar arr = bindersnew.splice(0);\r\n\t\t\tfor (var i = 0; i < arr.length; i++) {\r\n\t\t\t\tvar item = arr[i];\r\n\t\t\t\tif (!item.init) {\r\n\t\t\t\t\tif (item.com) {\r\n\t\t\t\t\t\titem.exec(item.com.data(item.path), item.path);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\titem.exec(getx(item.path), item.path);  // GET\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}, 50);\r\n\t}\r\n\r\n\tvar View = Evented.inherit({\r\n\t    options : {\r\n\t      elmComAttrNames: {\r\n\t        base : \"data-jc\",\r\n\t        url : \"data-jc-url\",\r\n\t        removed : \"data-jc-removed\",\r\n\t        released : \"data-jc-released\",\r\n\t        scope : \"data-jc-scope\"\r\n\t      }\r\n\t    },\r\n\r\n\t\t_construct : function(options) {\r\n\r\n\t\t\tthis.is = false;\r\n\t\t\tthis.recompile = false;\r\n\t\t\tthis.importing = 0;\r\n\t\t\tthis.pending = [];\r\n\t\t\tthis.init = [];\r\n\t\t\tthis.imports = {};\r\n\t\t\tthis.ready = [];\r\n\t\t},\r\n\r\n\t\tattrcom : function(el) {\r\n\t\t\treturn attrcom(el);\r\n\t\t},\r\n\r\n\t\tcompile : function (container,immediate) {\r\n\t\t\tvar self = this;\r\n\r\n\t\t\tif (self.is) {\r\n\t\t\t\tself.recompile = true;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar arr = [];\r\n\r\n\t\t\tif (W.READY instanceof Array)  {\r\n\t\t\t\tarr.push.apply(arr, W.READY);\r\n\t\t\t}\r\n\t\t\tif (W.jComponent instanceof Array) {\r\n\t\t\t\tarr.push.apply(arr, W.jComponent);\r\n\t\t\t}\r\n\t\t\tif (W.components instanceof Array) {\r\n\t\t\t\tarr.push.apply(arr, W.components);\r\n\t\t\t}\r\n\r\n\t\t\tif (arr.length) {\r\n\t\t\t\twhile (true) {\r\n\t\t\t\t\tvar fn = arr.shift();\r\n\t\t\t\t\tif (!fn){\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfn();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tself.is = true;\r\n\t\t\tdownload(self);\r\n\r\n\t\t\tif (self.pending.length) {\r\n\t\t\t\t(function(container) {\r\n\t\t\t\t\tself.pending.push(function() {\r\n\t\t\t\t\t\tcompile(self,container);\r\n\t\t\t\t\t});\r\n\t\t\t\t})(container);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar has = false;\r\n\r\n\t\t\tcrawler(self,container, compose);\r\n\r\n\t\t\t// perform binder\r\n\t\t\trebindbinder();\r\n\r\n\t\t\tif (!has || !self.pending.length) {\r\n\t\t\t\tself.is = false;\r\n\t\t\t}\r\n\r\n\t\t\tif (container !== undefined || !toggles.length) {\r\n\t\t\t\treturn pend();\r\n\t\t\t}\r\n\r\n\t\t\tlangx.async(toggles, function(item, next) {\r\n\t\t\t\tfor (var i = 0, length = item.toggle.length; i < length; i++)\r\n\t\t\t\t\titem.element.tclass(item.toggle[i]);\r\n\t\t\t\tnext();\r\n\t\t\t}, pend);\r\n\t\t},\r\n\r\n\t\trefresh : function () {\r\n\t\t\tsetTimeout2('$refresh', function() {\r\n\t\t\t\tall.sort(function(a, b) {  // M.components.sort\r\n\t\t\t\t\tif (a.$removed || !a.path)\r\n\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\tif (b.$removed || !b.path)\r\n\t\t\t\t\t\treturn -1;\r\n\t\t\t\t\tvar al = a.path.length;\r\n\t\t\t\t\tvar bl = b.path.length;\r\n\t\t\t\t\treturn al > bl ? - 1 : al === bl ? LCOMPARER(a.path, b.path) : 1;\r\n\t\t\t\t});\r\n\t\t\t}, 200);\r\n\t\t}\r\n\r\n\t});\r\n\r\n\treturn View;\r\n});"]}