{"version":3,"sources":["utils/env.js"],"names":["define","langx","jc","topic","KEY_ENV","vars","env","name","value","isObject","Object","keys","forEach","key","publish","undefined"],"mappings":";;;;;;;AAAAA,QACC,WACA,SACC,SAASC,EAAOC,GACjB,IAAIC,EAAQF,EAAME,MAEdC,EAAU,kBAeVC,KAqCJ,OAAOH,EAAGI,IAnCV,SAAcC,EAAMC,GAEnB,OAAIP,EAAMQ,SAASF,IAClBA,GAAQG,OAAOC,KAAKJ,GAAMK,QAAQ,SAASC,GAC1CR,EAAKQ,GAAON,EAAKM,GACjBV,EAAMW,QAAQV,EAASS,EAAKN,EAAKM,MAE3BN,QAGMQ,IAAVP,GACHL,EAAMW,QAAQV,EAASG,EAAMC,GAEtBA,GAGDH,EAAKE","file":"../../utils/env.js","sourcesContent":["define([\r\n\t\"../langx\",\r\n\t\"../jc\",\r\n],function(langx, jc){\r\n\tvar topic = langx.topic;\r\n\r\n\tvar KEY_ENV = 'skylark.vmm.env',\r\n\t\tREGENV = /(\\[.*?\\])/gi;\r\n\r\n\t// The follow code is not used?\r\n\t//M.environment = function(name, version, language, env) {\r\n\t//\tM.$localstorage = name;\r\n\t//\tM.$version = version || '';\r\n\t//\tM.$language = language || '';\r\n\t//\tenv && ENV(env);\r\n\t//\treturn M;\r\n\t//};\r\n\r\n\r\n\r\n\t//var environment = MD.environment = {};\r\n\tvar vars = {};\r\n\r\n\tfunction env (name, value) { // W.ENV\r\n\r\n\t\tif (langx.isObject(name)) {\r\n\t\t\tname && Object.keys(name).forEach(function(key) {\r\n\t\t\t\tvars[key] = name[key];\r\n\t\t\t\ttopic.publish(KEY_ENV, key, name[key]);  // EMIT\r\n\t\t\t});\r\n\t\t\treturn name;\r\n\t\t}\r\n\r\n\t\tif (value !== undefined) {\r\n\t\t\ttopic.publish(KEY_ENV, name, value); // EMIT\r\n\t\t\t//ENV[name] = value;\r\n\t\t\treturn value;\r\n\t\t}\r\n\r\n\t\treturn vars[name];\r\n\t};\r\n\r\n\r\n\t/*\r\n\tSP.env = function() {\r\n\t\tvar self = this;\r\n\t\treturn self.replace(REGENV, function(val) {\r\n\t\t\treturn ENV[val.substring(1, val.length - 1)] || val;\r\n\t\t});\r\n\t};\r\n\r\n\tSP.$env = function() {\r\n\t\tvar self = this;\r\n\t\tvar index = this.indexOf('?');\r\n\t\treturn index === -1 ? self.env() : self.substring(0, index).env() + self.substring(index);\r\n\t};\r\n\t*/\r\n\r\n\treturn jc.env = env;\r\n});"]}