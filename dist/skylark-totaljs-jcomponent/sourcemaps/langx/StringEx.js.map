{"version":3,"sources":["langx/StringEx.js"],"names":["define","regexp","now","REGWILDCARD","REGEMPTY","REGSEARCH","DIACRITICS","225","228","269","271","233","283","357","382","250","367","252","369","237","239","244","243","246","353","318","314","253","255","263","345","341","328","337","MV","url","phone","email","SP","String","prototype","trimAll","this","replace","ROOT","noBase","r","MD","root","b","baseurl","ext","TYPE_FN","test","t","substring","replaceWildcard","parseConfig","$config","def","callback","output","TYPE_S","TYPE_O","arr","env","split","num","colon","i","length","kv","text","k","trim","v","tmp","isNaN","render","a","Tangular","isJSONDate","l","charCodeAt","parseExpire","str","number","parseInt","removeDiacritics","buf","c","code","isUpper","undefined","toLowerCase","toUpperCase","toSearch","prev","push","join","slug","max","self","builder","isEmail","isPhone","isURL","val","match","int","parseFloat","float","indexOf","padLeft","e","toString","Array","Math","padRight","format","arg","arguments","value","parseDate","lc","Date","parse","index","noTime","firstDay","date","time","parsed","getFullYear","getMonth","getDate"],"mappings":"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","file":"../../langx/StringEx.js","sourcesContent":["define([\r\n\t\"./regexp\",\r\n\t\"./now\"\r\n],function(regexp,now){\r\n\tvar REGWILDCARD = /\\.\\*/;\r\n\r\n\tvar REGEMPTY = /\\s/g;\r\n\r\n\r\n\tvar REGSEARCH = /[^a-zA-Zá-žÁ-Žа-яА-Я\\d\\s:]/g;\r\n\tvar DIACRITICS = {225:'a',228:'a',269:'c',271:'d',233:'e',283:'e',357:'t',382:'z',250:'u',367:'u',252:'u',369:'u',237:'i',239:'i',244:'o',243:'o',246:'o',353:'s',318:'l',314:'l',253:'y',255:'y',263:'c',345:'r',341:'r',328:'n',337:'o'};\r\n\t\r\n\tvar MV =  {}; //jc.validators =\r\n\tMV.url = /^(https?:\\/\\/(?:www\\.|(?!www))[^\\s.#!:?+=&@!$'~*,;/()[\\]]+\\.[^\\s#!?+=&@!$'~*,;()[\\]\\\\]{2,}\\/?|www\\.[^\\s#!:.?+=&@!$'~*,;/()[\\]]+\\.[^\\s#!?+=&@!$'~*,;()[\\]\\\\]{2,}\\/?)/i;\r\n\tMV.phone = /^[+]?[(]?[0-9]{3}[)]?[-\\s.]?[0-9]{3}[-\\s.]?[0-9]{4,6}$/im;\r\n\tMV.email = /^[a-zA-Z0-9-_.+]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$/i;\t\r\n\r\n\tvar SP = String.prototype;\r\n\tSP.trimAll = function() {\r\n\t\treturn this.replace(REGEMPTY, '');\r\n\t};\r\n\r\n\tSP.ROOT = function(noBase) {\r\n\t\tvar url = this;\r\n\t\tvar r = MD.root;\r\n\t\tvar b = MD.baseurl;\r\n\t\tvar ext = /(https|http|wss|ws|file):\\/\\/|\\/\\/[a-z0-9]|[a-z]:/i;\r\n\t\tvar replace = function(t) {\r\n\t\t\treturn t.substring(0, 1) + '/';\r\n\t\t};\r\n\t\tif (r)\r\n\t\t\turl = typeof(r) === TYPE_FN ? r(url) : ext.test(url) ? url : (r + url);\r\n\t\telse if (!noBase && b)\r\n\t\t\turl = typeof(b) === TYPE_FN ? b(url) : ext.test(url) ? url : (b + url);\r\n\t\treturn url.replace(/[^:]\\/{2,}/, replace);\r\n\t};\r\n\r\n\tSP.replaceWildcard = function() {\r\n\t\treturn this.replace(REGWILDCARD, '');\r\n\t};\r\n\r\n\tSP.parseConfig = SP.$config = function(def, callback) {\r\n\r\n\t\tvar output;\r\n\r\n\t\tswitch (typeof(def)) {\r\n\t\t\tcase TYPE_FN:\r\n\t\t\t\tcallback = def;\r\n\t\t\t\toutput = {};\r\n\t\t\t\tbreak;\r\n\t\t\tcase TYPE_S:\r\n\t\t\t\toutput = def.parseConfig();\r\n\t\t\t\tbreak;\r\n\t\t\tcase TYPE_O:\r\n\t\t\t\tif (def != null)\r\n\t\t\t\t\toutput = def;\r\n\t\t\t\telse\r\n\t\t\t\t\toutput = {};\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\toutput = {};\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tvar arr = this.env().replace(/\\\\;/g, '\\0').split(';');\r\n\t\tvar num = /^(-)?[0-9.]+$/;\r\n\t\tvar colon = /(https|http|wss|ws):\\/\\//gi;\r\n\r\n\t\tfor (var i = 0, length = arr.length; i < length; i++) {\r\n\r\n\t\t\tvar item = arr[i].replace(/\\0/g, ';').replace(/\\\\:/g, '\\0').replace(colon, function(text) {\r\n\t\t\t\treturn text.replace(/:/g, '\\0');\r\n\t\t\t});\r\n\r\n\t\t\tvar kv = item.split(':');\r\n\t\t\tvar l = kv.length;\r\n\r\n\t\t\tif (l !== 2)\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\tvar k = kv[0].trim();\r\n\t\t\tvar v = kv[1].trim().replace(/\\0/g, ':').env();\r\n\r\n\t\t\tif (v === 'true' || v === 'false')\r\n\t\t\t\tv = v === 'true';\r\n\t\t\telse if (num.test(v)) {\r\n\t\t\t\tvar tmp = +v;\r\n\t\t\t\tif (!isNaN(tmp))\r\n\t\t\t\t\tv = tmp;\r\n\t\t\t}\r\n\r\n\t\t\toutput[k] = v;\r\n\t\t\tcallback && callback(k, v);\r\n\t\t}\r\n\r\n\t\treturn output;\r\n\t};\r\n\r\n\tSP.render = function(a, b) {\r\n\t\treturn Tangular.render(this, a, b);\r\n\t};\r\n\r\n\tSP.isJSONDate = function() {\r\n\t\tvar t = this;\r\n\t\tvar l = t.length - 1;\r\n\t\treturn l > 18 && l < 30 && t.charCodeAt(l) === 90 && t.charCodeAt(10) === 84 && t.charCodeAt(4) === 45 && t.charCodeAt(13) === 58 && t.charCodeAt(16) === 58;\r\n\t};\r\n\r\n\tSP.parseExpire = function() {\r\n\r\n\t\tvar str = this.split(' ');\r\n\t\tvar number = parseInt(str[0]);\r\n\r\n\t\tif (isNaN(number))\r\n\t\t\treturn 0;\r\n\r\n\t\tvar min = 60000 * 60;\r\n\r\n\t\tswitch (str[1].trim().replace(/\\./g, '')) {\r\n\t\t\tcase 'minutes':\r\n\t\t\tcase 'minute':\r\n\t\t\tcase 'min':\r\n\t\t\tcase 'mm':\r\n\t\t\tcase 'm':\r\n\t\t\t\treturn 60000 * number;\r\n\t\t\tcase 'hours':\r\n\t\t\tcase 'hour':\r\n\t\t\tcase 'HH':\r\n\t\t\tcase 'hh':\r\n\t\t\tcase 'h':\r\n\t\t\tcase 'H':\r\n\t\t\t\treturn min * number;\r\n\t\t\tcase 'seconds':\r\n\t\t\tcase 'second':\r\n\t\t\tcase 'sec':\r\n\t\t\tcase 'ss':\r\n\t\t\tcase 's':\r\n\t\t\t\treturn 1000 * number;\r\n\t\t\tcase 'days':\r\n\t\t\tcase 'day':\r\n\t\t\tcase 'DD':\r\n\t\t\tcase 'dd':\r\n\t\t\tcase 'd':\r\n\t\t\t\treturn (min * 24) * number;\r\n\t\t\tcase 'months':\r\n\t\t\tcase 'month':\r\n\t\t\tcase 'MM':\r\n\t\t\tcase 'M':\r\n\t\t\t\treturn (min * 24 * 28) * number;\r\n\t\t\tcase 'weeks':\r\n\t\t\tcase 'week':\r\n\t\t\tcase 'W':\r\n\t\t\tcase 'w':\r\n\t\t\t\treturn (min * 24 * 7) * number;\r\n\t\t\tcase 'years':\r\n\t\t\tcase 'year':\r\n\t\t\tcase 'yyyy':\r\n\t\t\tcase 'yy':\r\n\t\t\tcase 'y':\r\n\t\t\t\treturn (min * 24 * 365) * number;\r\n\t\t\tdefault:\r\n\t\t\t\treturn 0;\r\n\t\t}\r\n\t};\r\n\r\n\tSP.removeDiacritics = function() {\r\n\t\tvar buf = '';\r\n\t\tfor (var i = 0, length = this.length; i < length; i++) {\r\n\t\t\tvar c = this[i];\r\n\t\t\tvar code = c.charCodeAt(0);\r\n\t\t\tvar isUpper = false;\r\n\r\n\t\t\tvar r = DIACRITICS[code];\r\n\t\t\tif (r === undefined) {\r\n\t\t\t\tcode = c.toLowerCase().charCodeAt(0);\r\n\t\t\t\tr = DIACRITICS[code];\r\n\t\t\t\tisUpper = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (r === undefined) {\r\n\t\t\t\tbuf += c;\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tc = r;\r\n\t\t\tbuf += isUpper ? c.toUpperCase() : c;\r\n\t\t}\r\n\t\treturn buf;\r\n\t};\r\n\r\n\tSP.toSearch = function() {\r\n\r\n\t\tvar str = this.replace(REGSEARCH, '').trim().toLowerCase().removeDiacritics();\r\n\t\tvar buf = [];\r\n\t\tvar prev = '';\r\n\r\n\t\tfor (var i = 0, length = str.length; i < length; i++) {\r\n\t\t\tvar c = str.substring(i, i + 1);\r\n\t\t\tif (c === 'y')\r\n\t\t\t\tc = 'i';\r\n\t\t\tif (c !== prev) {\r\n\t\t\t\tprev = c;\r\n\t\t\t\tbuf.push(c);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn buf.join('');\r\n\t};\r\n\r\n\tSP.slug = function(max) {\r\n\t\tmax = max || 60;\r\n\r\n\t\tvar self = this.trim().toLowerCase().removeDiacritics();\r\n\t\tvar builder = '';\r\n\t\tvar length = self.length;\r\n\r\n\t\tfor (var i = 0; i < length; i++) {\r\n\t\t\tvar c = self.substring(i, i + 1);\r\n\t\t\tvar code = self.charCodeAt(i);\r\n\r\n\t\t\tif (builder.length >= max)\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tif (code > 31 && code < 48) {\r\n\t\t\t\tif (builder.substring(builder.length - 1, builder.length) !== '-')\r\n\t\t\t\t\tbuilder += '-';\r\n\t\t\t} else if (code > 47 && code < 58)\r\n\t\t\t\tbuilder += c;\r\n\t\t\telse if (code > 94 && code < 123)\r\n\t\t\t\tbuilder += c;\r\n\t\t}\r\n\r\n\t\tvar l = builder.length - 1;\r\n\t\treturn builder[l] === '-' ? builder.substring(0, l) : builder;\r\n\t};\r\n\r\n\tSP.isEmail = function() {\r\n\t\tvar str = this;\r\n\t\treturn str.length <= 4 ? false : MV.email.test(str);\r\n\t};\r\n\r\n\tSP.isPhone = function() {\r\n\t\tvar str = this;\r\n\t\treturn str.length < 6 ? false : MV.phone.test(str);\r\n\t};\r\n\r\n\tSP.isURL = function() {\r\n\t\tvar str = this;\r\n\t\treturn str.length <= 7 ? false : MV.url.test(str);\r\n\t};\r\n\r\n\tSP.parseInt = function(def) {\r\n\t\tvar str = this.trim();\r\n\t\tvar val = str.match(regexp.int);\r\n\t\tif (!val)\r\n\t\t\treturn def || 0;\r\n\t\tval = +val[0];\r\n\t\treturn isNaN(val) ? def || 0 : val;\r\n\t};\r\n\r\n\tSP.parseFloat = function(def) {\r\n\t\tvar str = this.trim();\r\n\t\tvar val = str.match(regexp.float);\r\n\t\tif (!val)\r\n\t\t\treturn def || 0;\r\n\t\tval = val[0];\r\n\t\tif (val.indexOf(',') !== -1)\r\n\t\t\tval = val.replace(',', '.');\r\n\t\tval = +val;\r\n\t\treturn isNaN(val) ? def || 0 : val;\r\n\t};\r\n\r\n\tSP.padLeft = function(t, e) {\r\n\t\tvar r = this.toString();\r\n\t\treturn Array(Math.max(0, t - r.length + 1)).join(e || ' ') + r;\r\n\t};\r\n\r\n\tSP.padRight = function(t, e) {\r\n\t\tvar r = this.toString();\r\n\t\treturn r + Array(Math.max(0, t - r.length + 1)).join(e || ' ');\r\n\t};\r\n\t\r\n\tSP.format = function() {\r\n\t\tvar arg = arguments;\r\n\t\treturn this.replace(regexp.format, function(text) {\r\n\t\t\tvar value = arg[+text.substring(1, text.length - 1)];\r\n\t\t\treturn value == null ? '' : value instanceof Array ? value.join('') : value;\r\n\t\t});\r\n\t};\r\n\r\n\tSP.parseDate = function() {\r\n\t\tvar self = this.trim();\r\n\t\tif (!self)\r\n\t\t\treturn null;\r\n\r\n\t\tvar lc = self.charCodeAt(self.length - 1);\r\n\r\n\t\t// Classic date\r\n\t\tif (lc === 41)\r\n\t\t\treturn new Date(self);\r\n\r\n\t\t// JSON format\r\n\t\tif (lc === 90)\r\n\t\t\treturn new Date(Date.parse(self));\r\n\r\n\t\tvar arr = self.indexOf(' ') === -1 ? self.split('T') : self.split(' ');\r\n\t\tvar index = arr[0].indexOf(':');\r\n\t\tvar length = arr[0].length;\r\n\r\n\t\tif (index !== -1) {\r\n\t\t\tvar tmp = arr[1];\r\n\t\t\tarr[1] = arr[0];\r\n\t\t\tarr[0] = tmp;\r\n\t\t}\r\n\r\n\t\tif (arr[0] === undefined)\r\n\t\t\tarr[0] = '';\r\n\r\n\t\tvar noTime = arr[1] === undefined ? true : arr[1].length === 0;\r\n\r\n\t\tfor (var i = 0; i < length; i++) {\r\n\t\t\tvar c = arr[0].charCodeAt(i);\r\n\t\t\tif ((c > 47 && c < 58) || c === 45 || c === 46)\r\n\t\t\t\tcontinue;\r\n\t\t\tif (noTime)\r\n\t\t\t\treturn new Date(self);\r\n\t\t}\r\n\r\n\t\tif (arr[1] === undefined)\r\n\t\t\tarr[1] = '00:00:00';\r\n\r\n\t\tvar firstDay = arr[0].indexOf('-') === -1;\r\n\r\n\t\tvar date = (arr[0] || '').split(firstDay ? '.' : '-');\r\n\t\tvar time = (arr[1] || '').split(':');\r\n\t\tvar parsed = [];\r\n\r\n\t\tif (date.length < 4 && time.length < 2)\r\n\t\t\treturn new Date(self);\r\n\r\n\t\tindex = (time[2] || '').indexOf('.');\r\n\r\n\t\t// milliseconds\r\n\t\tif (index !== -1) {\r\n\t\t\ttime[3] = time[2].substring(index + 1);\r\n\t\t\ttime[2] = time[2].substring(0, index);\r\n\t\t} else\r\n\t\t\ttime[3] = '0';\r\n\r\n\t\tparsed.push(+date[firstDay ? 2 : 0]); // year\r\n\t\tparsed.push(+date[1]); // month\r\n\t\tparsed.push(+date[firstDay ? 0 : 2]); // day\r\n\t\tparsed.push(+time[0]); // hours\r\n\t\tparsed.push(+time[1]); // minutes\r\n\t\tparsed.push(+time[2]); // seconds\r\n\t\tparsed.push(+time[3]); // miliseconds\r\n\r\n\t\tvar def = now(true); //def = W.DATETIME = W.NOW = new Date();\r\n\r\n\t\tfor (var i = 0, length = parsed.length; i < length; i++) {\r\n\t\t\tif (isNaN(parsed[i]))\r\n\t\t\t\tparsed[i] = 0;\r\n\r\n\t\t\tvar value = parsed[i];\r\n\t\t\tif (value !== 0)\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\tswitch (i) {\r\n\t\t\t\tcase 0:\r\n\t\t\t\t\tif (value <= 0)\r\n\t\t\t\t\t\tparsed[i] = def.getFullYear();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 1:\r\n\t\t\t\t\tif (value <= 0)\r\n\t\t\t\t\t\tparsed[i] = def.getMonth() + 1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 2:\r\n\t\t\t\t\tif (value <= 0)\r\n\t\t\t\t\t\tparsed[i] = def.getDate();\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn new Date(parsed[0], parsed[1] - 1, parsed[2], parsed[3], parsed[4], parsed[5]);\r\n\t};\r\n});"]}