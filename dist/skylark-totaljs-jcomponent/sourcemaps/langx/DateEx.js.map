{"version":3,"sources":["langx/DateEx.js"],"names":["define","langx","regexp","statics","Date","months","split","days","MD","window","$jcdatempam","value","DP","prototype","toNumber","format","this","parseDate","add","type","undefined","arr","parseInt","isString","env","dt","getTime","substring","setSeconds","getSeconds","setMinutes","getMinutes","setHours","getHours","setDate","getDate","setMonth","getMonth","setFullYear","getFullYear","toUTC","ticks","getTimezoneOffset","utc","self","toString","padLeft","getMilliseconds","key","half","beg","end","before","ismm","isdd","isww","replace","date","push","Function","join"],"mappings":"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","file":"../../langx/DateEx.js","sourcesContent":["define([\r\n\t\"skylark-langx/langx\",\r\n\t\"./regexp\",\r\n\t\"./statics\"\r\n],function(langx,regexp,statics){\r\n\r\n\tDate.months = 'January,February,March,April,May,June,July,August,September,October,November,December'.split(',');\r\n\tDate.days = 'Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday'.split(',');\r\n\r\n\tvar MD = {\r\n\t\tdateformat : null\r\n\r\n\t};\r\n\t\r\n\twindow.$jcdatempam = function(value) {  // TODO: will be changed\r\n\t\treturn value >= 12 ? value - 12 : value;\r\n\t};\r\n\r\n\r\n\tvar DP = Date.prototype;\r\n\tDP.toNumber = function(format) {\r\n\t\treturn +this.format(format || 'yyyyMMdd');\r\n\t};\r\n\r\n\tDP.parseDate = function() {\r\n\t\treturn this;\r\n\t};\r\n\r\n\tDP.add = function(type, value) {\r\n\r\n\t\tif (value === undefined) {\r\n\t\t\tvar arr = type.split(' ');\r\n\t\t\ttype = arr[1];\r\n\t\t\tvalue = parseInt(arr[0]);\r\n\t\t}\r\n\r\n\t\tif (langx.isString(value) )\r\n\t\t\tvalue = value.env();\r\n\r\n\t\tvar self = this;\r\n\t\tvar dt = new Date(self.getTime());\r\n\r\n\t\tswitch(type.substring(0, 3)) {\r\n\t\t\tcase 's':\r\n\t\t\tcase 'ss':\r\n\t\t\tcase 'sec':\r\n\t\t\t\tdt.setSeconds(dt.getSeconds() + value);\r\n\t\t\t\treturn dt;\r\n\t\t\tcase 'm':\r\n\t\t\tcase 'mm':\r\n\t\t\tcase 'min':\r\n\t\t\t\tdt.setMinutes(dt.getMinutes() + value);\r\n\t\t\t\treturn dt;\r\n\t\t\tcase 'h':\r\n\t\t\tcase 'hh':\r\n\t\t\tcase 'hou':\r\n\t\t\t\tdt.setHours(dt.getHours() + value);\r\n\t\t\t\treturn dt;\r\n\t\t\tcase 'd':\r\n\t\t\tcase 'dd':\r\n\t\t\tcase 'day':\r\n\t\t\t\tdt.setDate(dt.getDate() + value);\r\n\t\t\t\treturn dt;\r\n\t\t\tcase 'w':\r\n\t\t\tcase 'ww':\r\n\t\t\tcase 'wee':\r\n\t\t\t\tdt.setDate(dt.getDate() + (value * 7));\r\n\t\t\t\treturn dt;\r\n\t\t\tcase 'M':\r\n\t\t\tcase 'MM':\r\n\t\t\tcase 'mon':\r\n\t\t\t\tdt.setMonth(dt.getMonth() + value);\r\n\t\t\t\treturn dt;\r\n\t\t\tcase 'y':\r\n\t\t\tcase 'yy':\r\n\t\t\tcase 'yyy':\r\n\t\t\tcase 'yea':\r\n\t\t\t\tdt.setFullYear(dt.getFullYear() + value);\r\n\t\t\t\treturn dt;\r\n\t\t}\r\n\t\treturn dt;\r\n\t};\r\n\r\n\tDP.toUTC = function(ticks) {\r\n\t\tvar self = this;\r\n\t\tvar dt = self.getTime() + self.getTimezoneOffset() * 60000;\r\n\t\treturn ticks ? dt : new Date(dt);\r\n\t};\r\n\r\n\tDP.format = function(format, utc) {\r\n\r\n\t\tvar self = utc ? this.toUTC() : this;\r\n\r\n\t\tif (format == null)\r\n\t\t\tformat = MD.dateformat;\r\n\r\n\t\tif (!format)\r\n\t\t\treturn self.getFullYear() + '-' + (self.getMonth() + 1).toString().padLeft(2, '0') + '-' + self.getDate().toString().padLeft(2, '0') + 'T' + self.getHours().toString().padLeft(2, '0') + ':' + self.getMinutes().toString().padLeft(2, '0') + ':' + self.getSeconds().toString().padLeft(2, '0') + '.' + self.getMilliseconds().toString().padLeft(3, '0') + 'Z';\r\n\r\n\t\tvar key = 'dt_' + format;\r\n\r\n\t\tif (statics[key])\r\n\t\t\treturn statics[key](self);\r\n\r\n\t\tvar half = false;\r\n\r\n\t\tformat = format.env();\r\n\r\n\t\tif (format && format.substring(0, 1) === '!') {\r\n\t\t\thalf = true;\r\n\t\t\tformat = format.substring(1);\r\n\t\t}\r\n\r\n\t\tvar beg = '\\'+';\r\n\t\tvar end = '+\\'';\r\n\t\tvar before = [];\r\n\r\n\t\tvar ismm = false;\r\n\t\tvar isdd = false;\r\n\t\tvar isww = false;\r\n\r\n\t\tformat = format.replace(regexp.date, function(key) {\r\n\t\t\tswitch (key) {\r\n\t\t\t\tcase 'yyyy':\r\n\t\t\t\t\treturn beg + 'd.getFullYear()' + end;\r\n\t\t\t\tcase 'yy':\r\n\t\t\t\t\treturn beg + 'd.getFullYear().toString().substring(2)' + end;\r\n\t\t\t\tcase 'MMM':\r\n\t\t\t\t\tismm = true;\r\n\t\t\t\t\treturn beg + 'mm.substring(0, 3)' + end;\r\n\t\t\t\tcase 'MMMM':\r\n\t\t\t\t\tismm = true;\r\n\t\t\t\t\treturn beg + 'mm' + end;\r\n\t\t\t\tcase 'MM':\r\n\t\t\t\t\treturn beg + '(d.getMonth() + 1).padLeft(2, \\'0\\')' + end;\r\n\t\t\t\tcase 'M':\r\n\t\t\t\t\treturn beg + '(d.getMonth() + 1)' + end;\r\n\t\t\t\tcase 'ddd':\r\n\t\t\t\t\tisdd = true;\r\n\t\t\t\t\treturn beg + 'dd.substring(0, 2).toUpperCase()' + end;\r\n\t\t\t\tcase 'dddd':\r\n\t\t\t\t\tisdd = true;\r\n\t\t\t\t\treturn beg + 'dd' + end;\r\n\t\t\t\tcase 'dd':\r\n\t\t\t\t\treturn beg + 'd.getDate().padLeft(2, \\'0\\')' + end;\r\n\t\t\t\tcase 'd':\r\n\t\t\t\t\treturn beg + 'd.getDate()' + end;\r\n\t\t\t\tcase 'HH':\r\n\t\t\t\tcase 'hh':\r\n\t\t\t\t\treturn beg + (half ? 'window.$jcdatempam(d.getHours()).padLeft(2, \\'0\\')' : 'd.getHours().padLeft(2, \\'0\\')') + end;\r\n\t\t\t\tcase 'H':\r\n\t\t\t\tcase 'h':\r\n\t\t\t\t\treturn beg + (half ? 'window.$jcdatempam(d.getHours())' : 'd.getHours()') + end;\r\n\t\t\t\tcase 'mm':\r\n\t\t\t\t\treturn beg + 'd.getMinutes().padLeft(2, \\'0\\')' + end;\r\n\t\t\t\tcase 'm':\r\n\t\t\t\t\treturn beg + 'd.getMinutes()' + end;\r\n\t\t\t\tcase 'ss':\r\n\t\t\t\t\treturn beg + 'd.getSeconds().padLeft(2, \\'0\\')' + end;\r\n\t\t\t\tcase 's':\r\n\t\t\t\t\treturn beg + 'd.getSeconds()' + end;\r\n\t\t\t\tcase 'w':\r\n\t\t\t\tcase 'ww':\r\n\t\t\t\t\tisww = true;\r\n\t\t\t\t\treturn beg + (key === 'ww' ? 'ww.padLeft(2, \\'0\\')' : 'ww') + end;\r\n\t\t\t\tcase 'a':\r\n\t\t\t\t\tvar b = '\\'PM\\':\\'AM\\'';\r\n\t\t\t\t\treturn beg + '(d.getHours() >= 12 ? ' + b + ')' + end;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tismm && before.push('var mm = M.months[d.getMonth()];');\r\n\t\tisdd && before.push('var dd = M.days[d.getDay()];');\r\n\t\tisww && before.push('var ww = new Date(+d);ww.setHours(0, 0, 0);ww.setDate(ww.getDate() + 4 - (ww.getDay() || 7));ww = Math.ceil((((ww - new Date(ww.getFullYear(), 0, 1)) / 8.64e7) + 1) / 7);');\r\n\r\n\t\tstatics[key] = new Function('d', before.join('\\n') + 'return \\'' + format + '\\';');\r\n\t\treturn statics[key](self);\r\n\t};\r\n\t\r\n});"]}