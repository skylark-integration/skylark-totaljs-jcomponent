{"version":3,"sources":["stores.js"],"names":["define","langx","jc","caches","stores","paths","get","path","scope","charCodeAt","substring","key","root","indexOf","arr","parsepath","builder","i","length","item","push","v","fn","Function","join","MD","REGPARAMS","proxy","REGISARR","binders","binderbind","absolutePath","ticks","exec","getx","set","value","is","binder","type","test","p","this","split","all","index","a","splice","make","obj","update","call","setx","undefined","C","ready","$set","immSetx","immUpdate","Array","prototype","findValue","cb","def","cache","isFunction","val","temp","findIndex","String","params","arg","replace","text","l","trim","reset","wasset","M","pathmaker","replaceWildcard","$get","state","skipproxy","components","com","disabled","$removed","$loaded","$compare","result","setter","$skip","setterX","$interaction","$ready","$dirty_disabled","$dirty","$valid_disabled","$valid","$validate","validate","findcontrol2","valid","clear","stateX","emitwatch","setInterval","Window","unwatch","watch","getr","set2","setx2","setr","toggle","toogle2","expire","rebind","WATCH","storages","put","immInc","current","isNumber","parseFloat","isNaN","immExtend","$","extend","immPush","n","apply","bind","create","callback","isString","setTimeout","arguments","$ticks","Math","random","toString","j","notify","delaybinder","blocked","get2","handler","target","property","receiver","Proxy","err","Reflect","defineProperty","descriptor","deleteProperty","thisArg","argumentsList","BLACKLIST","name","o","defaultValue","timeout","REGMETA","SET","default","errors","evaluate","expression","nopath","exp","modified","rewrite","except","flags","remove","visible","hidden","enabled","find","SELINPUT"],"mappings":"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","file":"../stores.js","sourcesContent":["define([\r\n\t\"skylark-langx/langx\",\r\n\t\"./jc\",\r\n\t\"./utils/cache\"\r\n],function(langx, jc, caches){\r\n\tvar changed = {\r\n\t\tonupdate : null,\r\n\t\tonset : null\r\n\t};\r\n\r\n\tvar stores = {\r\n\t\t},\r\n\t\tpaths = {},\r\n\t\t$parser = [];\r\n\r\n\r\n\t//get... \r\n\r\n\tfunction get(path, scope) {\r\n\r\n\t\tif (path == null) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar code = path.charCodeAt(0);\r\n\t\tif (code === 37)　{  // % \r\n\t\t\tpath = 'jctmp.' + path.substring(1);\r\n\t\t}\r\n\r\n\t\tvar key = '=' + path;\r\n\t\tif (paths[key]) {\r\n\t\t\treturn paths[key](scope || stores.root);\r\n\t\t}\r\n\r\n\t\tif (path.indexOf('?') !== -1) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar arr = parsepath(path);\r\n\t\tvar builder = [];\r\n\r\n\t\tfor (var i = 0, length = arr.length - 1; i < length; i++) {\r\n\t\t\tvar item = arr[i];\r\n\t\t\tif (item.substring(0, 1) !== '[') {\r\n\t\t\t\titem = '.' + item;\r\n\t\t\t}\r\n\t\t\tbuilder.push('if(!w' + item + ')return');\r\n\t\t}\r\n\r\n\t\tvar v = arr[arr.length - 1];\r\n\t\tif (v.substring(0, 1) !== '['){\r\n\t\t\tv = '.' + v;\r\n\t\t}\r\n\r\n\t\tvar fn = (new Function('w', builder.join(';') + ';return w' + v));\r\n\t\tpaths[key] = fn;\r\n\t\treturn fn(scope || MD.scope);\r\n\t}\r\n\r\n   /**\r\n   * Evaluate String expression as JavaScript code.\r\n   * @param  {String/Object} path Can be object if \"path_is_real_value\" is \"true\"\r\n   * @param  {String} expression A condition.\r\n   * @param  {Boolean} path_is_real_value Optional, default: false\r\n   * @returns {Boolean}   \r\n   */\r\n\tfunction evaluate(path, expression, nopath) { //W.EVALUATE = \r\n\r\n\t\tvar key = 'eval' + expression;\r\n\t\tvar exp = caches.temp[key];\r\n\t\tvar val = null;\r\n\r\n\t\tif (nopath) {\r\n\t\t\tval = path;\r\n\t\t} else {\r\n\t\t\tval = get(path);\r\n\t\t}\r\n\r\n\t\tif (exp) {\r\n\t\t\treturn exp.call(val, val, path);\r\n\t\t}\r\n\r\n\t\tif (expression.indexOf('return') === -1) {\r\n\t\t\texpression = 'return ' + expression;\r\n\t\t}\r\n\r\n\t\texp = new Function('value', 'path', expression);\r\n\t\tcaches.temp[key] = exp;\r\n\t\treturn exp.call(val, val, path);\r\n\t}\r\n\r\n\r\n\t\r\n\t// paths -> view model\r\n\r\n\tvar REGPARAMS = /\\{{1,2}[a-z0-9_.-\\s]+\\}{1,2}/gi;\r\n\r\n\tvar skipproxy = ''\r\n\tvar proxy = {};\r\n\r\n\t// ===============================================================\r\n\t// PRIVATE FUNCTIONS\r\n\t// ===============================================================\r\n\r\n\tvar MULTIPLE = ' + ';\r\n\tvar REGISARR = /\\[\\d+\\]$/;\r\n\r\n\tvar paths = {}; // saved paths from get() and set()\r\n\r\n\tvar binders = {};\r\n\tvar bindersnew = [];\r\n\r\n\tfunction binderbind(path, absolutePath, ticks) {\r\n\t\tvar arr = binders[path];\r\n\t\tfor (var i = 0; i < arr.length; i++) {\r\n\t\t\tvar item = arr[i];\r\n\t\t\tif (item.ticks !== ticks) {\r\n\t\t\t\titem.ticks = ticks;\r\n\t\t\t\titem.exec(getx(item.path), absolutePath);  //GET\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\r\n\r\n\tArray.prototype.findValue = function(cb, value, path, def, cache) {\r\n\r\n\t\tif (langx.isFunction(cb)) {\r\n\t\t\tdef = path;\r\n\t\t\tpath = value;\r\n\t\t\tvalue = undefined;\r\n\t\t\tcache = false;\r\n\t\t}\r\n\r\n\t\tvar key, val = def;\r\n\r\n\t\tif (cache) {\r\n\t\t\tkey = 'fv_' + cb + '=' + value;\r\n\t\t\tif (caches.temp[key]) {\r\n\t\t\t\treturn caches.temp[key];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar index = this.findIndex(cb, value);\r\n\t\tif (index !== -1) {\r\n\t\t\tvar item = this[index];\r\n\t\t\tif (path.indexOf('.') === -1) {\r\n\t\t\t\titem = item[path];\r\n\t\t\t} else {\r\n\t\t\t\titem = get(path, item);\r\n\t\t\t}\r\n\t\t\tcache && (caches.temp[key] = val);\r\n\t\t\tval = item == null ? def : item;\r\n\t\t}\r\n\r\n\t\treturn val;\r\n\t};\r\n\r\n\tString.prototype.params = String.prototype.arg = function(obj) {\r\n\t\treturn this.replace(REGPARAMS, function(text) {\r\n\t\t\t// Is double?\r\n\t\t\tvar l = text.charCodeAt(1) === 123 ? 2 : 1;\r\n\t\t\tvar val = get(text.substring(l, text.length - l).trim(), obj);\r\n\t\t\treturn val == null ? text : val;\r\n\t\t});\r\n\t};\r\n\r\n\r\n\t// set...\r\n\tfunction set(path, value, is) {\r\n\r\n\t\tif (path == null) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar key = '+' + path;\r\n\r\n\t\tif (paths[key]) {\r\n\t\t\treturn paths[key](MD.scope, value, path, binders, binderbind, is);\r\n\t\t}\r\n\r\n\t\tif (path.indexOf('?') !== -1) {\r\n\t\t\tpath = '';\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar arr = parsepath(path);\r\n\t\tvar builder = [];\r\n\t\tvar binder = [];\r\n\r\n\t\tfor (var i = 0; i < arr.length - 1; i++) {\r\n\t\t\tvar item = arr[i];\r\n\t\t\tvar type = arr[i + 1] ? (REGISARR.test(arr[i + 1]) ? '[]' : '{}') : '{}';\r\n\t\t\tvar p = 'w' + (item.substring(0, 1) === '[' ? '' : '.') + item;\r\n\t\t\tbuilder.push('if(typeof(' + p + ')!==\\'object\\'||' + p + '==null)' + p + '=' + type);\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < arr.length - 1; i++) {\r\n\t\t\tvar item = arr[i];\r\n\t\t\tbinder.push('binders[\\'' + item + '\\']&&binderbind(\\'' + item + '\\',\\'' + path + '\\',$ticks)');\r\n\t\t}\r\n\r\n\t\tvar v = arr[arr.length - 1];\r\n\t\tbinder.push('binders[\\'' + v + '\\']&&binderbind(\\'' + v + '\\',\\'' + path + '\\',$ticks)');\r\n\t\tbinder.push('binders[\\'!' + v + '\\']&&binderbind(\\'!' + v + '\\',\\'' + path + '\\',$ticks)');\r\n\r\n\t\tif (v.substring(0, 1) !== '['){\r\n\t\t\tv = '.' + v;\r\n\t\t}\r\n\r\n\t\tvar fn = (new Function('w', 'a', 'b', 'binders', 'binderbind', 'nobind', 'var $ticks=Math.random().toString().substring(2,8);if(!nobind){' + builder.join(';') + ';var v=typeof(a)==\\'function\\'?a(MAIN.compiler.get(b)):a;w' + v + '=v}' + binder.join(';') + ';return a'));\r\n\t\tpaths[key] = fn;\r\n\t\tfn(stores.root, value, path, binders, binderbind, is);\r\n\r\n\t\treturn this; //C\r\n\t}\r\n\r\n\tfunction set2(scope, path, value) {\r\n\r\n\t\tif (path == null) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar key = '++' + path;\r\n\r\n\t\tif (paths[key]) {\r\n\t\t\treturn paths[key](scope, value, path);\r\n\t\t}\r\n\r\n\t\tvar arr = parsepath(path);\r\n\t\tvar builder = [];\r\n\r\n\t\tfor (var i = 0; i < arr.length - 1; i++) {\r\n\t\t\tvar item = arr[i];\r\n\t\t\tvar type = arr[i + 1] ? (REGISARR.test(arr[i + 1]) ? '[]' : '{}') : '{}';\r\n\t\t\tvar p = 'w' + (item.substring(0, 1) === '[' ? '' : '.') + item;\r\n\t\t\tbuilder.push('if(typeof(' + p + ')!==\\'object\\'||' + p + '==null)' + p + '=' + type);\r\n\t\t}\r\n\r\n\t\tvar v = arr[arr.length - 1];\r\n\r\n\t\tif (v.substring(0, 1) !== '[')\r\n\t\t\tv = '.' + v;\r\n\r\n\t\tvar fn = (new Function('w', 'a', 'b', builder.join(';') + ';w' + v + '=a;return a'));\r\n\t\tpaths[key] = fn;\r\n\t\tfn(scope, value, path);\r\n\t\treturn scope;\r\n\t}\r\n\r\n\r\n \t//cache\r\n\tfunction cache(path, expire, rebind) { // W.CACHEPATH = \r\n\t\tvar key = '$jcpath';\r\n\t\tWATCH(path, function(p, value) {\r\n\t\t\tvar obj = storages.get(key); // cachestorage(key);\r\n\t\t\tif (obj) {\r\n\t\t\t\tobj[path] = value;\r\n\t\t\t}else {\r\n\t\t\t\tobj = {};\r\n\t\t\t\tobj[path] = value;\r\n\t\t\t}\r\n\t\t\tstorages.put(key, obj, expire); // cachestorage(key, obj, expire);\r\n\t\t});\r\n\r\n\t\tif (rebind === undefined || rebind) {\r\n\t\t\tvar cache = storages.get(key); // cachestorage(key);\r\n\t\t\tif (cache && cache[path] !== undefined && cache[path] !== get(path)){\r\n\t\t\t\timmSetx(path, cache[path], true);\t\r\n\t\t\t} \r\n\t\t}\r\n\t\treturn this; //W \r\n\t};\r\n\r\n\r\n\tfunction parsepath(path) {\r\n\r\n\t\tvar arr = path.split('.');\r\n\t\tvar builder = [];\r\n\t\tvar all = [];\r\n\r\n\t\tfor (var i = 0; i < arr.length; i++) {\r\n\t\t\tvar p = arr[i];\r\n\t\t\tvar index = p.indexOf('[');\r\n\t\t\tif (index === -1) {\r\n\t\t\t\tif (p.indexOf('-') === -1) {\r\n\t\t\t\t\tall.push(p);\r\n\t\t\t\t\tbuilder.push(all.join('.'));\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar a = all.splice(all.length - 1);\r\n\t\t\t\t\tall.push(a + '[\\'' + p + '\\']');\r\n\t\t\t\t\tbuilder.push(all.join('.'));\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (p.indexOf('-') === -1) {\r\n\t\t\t\t\tall.push(p.substring(0, index));\r\n\t\t\t\t\tbuilder.push(all.join('.'));\r\n\t\t\t\t\tall.splice(all.length - 1);\r\n\t\t\t\t\tall.push(p);\r\n\t\t\t\t\tbuilder.push(all.join('.'));\r\n\t\t\t\t} else {\r\n\t\t\t\t\tall.push('[\\'' + p.substring(0, index) + '\\']');\r\n\t\t\t\t\tbuilder.push(all.join(''));\r\n\t\t\t\t\tall.push(p.substring(index));\r\n\t\t\t\t\tbuilder.push(all.join(''));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn builder;\r\n\t}\r\n\t\r\n   /**\r\n   * Creates a watcher for all changes.\r\n   * @param  {String} path \r\n   */\r\n\tfunction create(path) { //W.CREATE\r\n\r\n\t\tvar is = false;\r\n\t\tvar callback;\r\n\r\n\t\tif (langx.isString(path)) {\r\n\t\t\tif (proxy[path]) {\r\n\t\t\t\treturn proxy[path];\r\n\t\t\t}\r\n\t\t\tis = true;\r\n\t\t\tcallback = function(key) {\r\n\r\n\t\t\t\tvar p = path + (key ? '.' + key : '');\r\n\t\t\t\tif (M.skipproxy === p) {\r\n\t\t\t\t\tM.skipproxy = '';\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tif (M.skipproxy === p) {\r\n\t\t\t\t\t\tM.skipproxy = '';\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tnotify(p);  // NOTIFY\r\n\t\t\t\t\t\treset(p);   // REEST\r\n\t\t\t\t\t}\r\n\t\t\t\t}, MD.delaybinder);\r\n\t\t\t};\r\n\r\n\t\t} else {\r\n\t\t\tcallback = path;\r\n\t\t}\r\n\r\n\t\tvar blocked = false;\r\n\t\tvar obj = path ? (get2(path) || {}) : {};\r\n\t\tvar handler = {\r\n\t\t\tget: function(target, property, receiver) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\treturn new Proxy(target[property], handler);\r\n\t\t\t\t} catch (err) {\r\n\t\t\t\t\treturn Reflect.get(target, property, receiver);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tdefineProperty: function(target, property, descriptor) {\r\n\t\t\t\t!blocked && callback(property, descriptor);\r\n\t\t\t\treturn Reflect.defineProperty(target, property, descriptor);\r\n\t\t\t},\r\n\t\t\tdeleteProperty: function(target, property) {\r\n\t\t\t\t!blocked && callback(property);\r\n\t\t\t\treturn Reflect.deleteProperty(target, property);\r\n\t\t\t},\r\n\t\t\tapply: function(target, thisArg, argumentsList) {\r\n\t\t\t\tif (BLACKLIST[target.name]) {\r\n\t\t\t\t\tblocked = true;\r\n\t\t\t\t\tvar result = Reflect.apply(target, thisArg, argumentsList);\r\n\t\t\t\t\tcallback('', argumentsList[0]);\r\n\t\t\t\t\tblocked = false;\r\n\t\t\t\t\treturn result;\r\n\t\t\t\t}\r\n\t\t\t\treturn Reflect.apply(target, thisArg, argumentsList);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tvar o = new Proxy(obj, handler);\r\n\r\n\t\tif (is) {\r\n\t\t\tM.skipproxy = path;\r\n\t\t\tgetx(path) == null && setx(path, obj, true);  // GET SET\r\n\t\t\treturn proxy[path] = o;\r\n\t\t} else\r\n\t\t\treturn o;\r\n\t}\r\n\r\n   /**\r\n   * Creates an object on the path and notifies all components\r\n   * @param  {String} path \r\n   * @param  {Function} fn \r\n   * @param  {Boolean} update Optional Optional, default \"true\"\r\n   */\r\n\tfunction make(obj, fn, update) { // W.MAKE\r\n\r\n\t\tswitch (typeof(obj)) {\r\n\t\t\tcase 'function':\r\n\t\t\t\tfn = obj;\r\n\t\t\t\tobj = {};\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'string':\r\n\t\t\t\tvar p = obj;\r\n\t\t\t\tvar is = true;\r\n\t\t\t\tobj = get(p);\r\n\t\t\t\tif (obj == null) {\r\n\t\t\t\t\tis = false;\r\n\t\t\t\t\tobj = {};\r\n\t\t\t\t}\r\n\t\t\t\tfn.call(obj, obj, p, function(path, value) {\r\n\t\t\t\t\tsetx(obj, path, value);\r\n\t\t\t\t});\r\n\t\t\t\tif (is && (update === undefined || update === true))\r\n\t\t\t\t\timmUpdate(p, true);\r\n\t\t\t\telse {\r\n\t\t\t\t\tif (C.ready)\r\n\t\t\t\t\t\t$set(p, obj);\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\timmSetx(p, obj, true);\r\n\t\t\t\t}\r\n\t\t\t\treturn obj;\r\n\t\t}\r\n\r\n\t\tfn.call(obj, obj, '');\r\n\t\treturn obj;\r\n\t}\r\n\r\n  /**\r\n   * Notifies a setter in all components on the path.\r\n   * @param  {String} path \r\n   */\r\n\tfunction notify() { // W.NOTIFY\r\n\r\n\t\tvar arg = arguments;\r\n\t\tvar all = M.components.all;//M.components;\r\n\r\n\t\tvar $ticks = Math.random().toString().substring(2, 8);\r\n\t\tfor (var j = 0; j < arg.length; j++) {\r\n\t\t\tvar p = arg[j];\r\n\t\t\tbinders[p] && binderbind(p, p, $ticks);\r\n\t\t}\r\n\r\n\t\tfor (var i = 0, length = all.length; i < length; i++) {\r\n\t\t\tvar com = all[i];\r\n\t\t\tif (!com || com.$removed || com.disabled || !com.$loaded || !com.path)\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\tvar is = 0;\r\n\t\t\tfor (var j = 0; j < arg.length; j++) {\r\n\t\t\t\tif (com.path === arg[j]) {\r\n\t\t\t\t\tis = 1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (is) {\r\n\t\t\t\tvar val = com.get();\r\n\t\t\t\tcom.setter && com.setterX(val, com.path, 1);\r\n\t\t\t\tcom.state && com.stateX(1, 6);\r\n\t\t\t\tcom.$interaction(1);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor (var j = 0; j < arg.length; j++) {\r\n\t\t\temitwatch(arg[j], getx(arg[j]), 1);  // GET\r\n\t\t}\r\n\r\n\t\treturn this;  // W\r\n\t};\r\n\r\n\tfunction validate(path, except) { //W.VALIDATE =\r\n\r\n\t\tvar arr = [];\r\n\t\tvar valid = true;\r\n\r\n\t\tpath = pathmaker(path.replaceWildcard()); //pathmaker(path.replace(REGWILDCARD, ''));\r\n\r\n\t\tvar flags = null;\r\n\t\tif (except) {\r\n\t\t\tvar is = false;\r\n\t\t\tflags = {};\r\n\t\t\texcept = except.remove(function(item) {\r\n\t\t\t\tif (item.substring(0, 1) === '@') {\r\n\t\t\t\t\tflags[item.substring(1)] = true;\r\n\t\t\t\t\tis = true;\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t});\r\n\t\t\t!is && (flags = null);\r\n\t\t\t!except.length && (except = null);\r\n\t\t}\r\n\r\n\t\tvar all = M.components.all;//M.components;\r\n\t\tfor (var i = 0, length = all.length; i < length; i++) {\r\n\t\t\tvar com = all[i];\r\n\t\t\tif (!com || com.$removed || com.disabled || !com.$loaded || !com.path || !com.$compare(path))\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\tif (flags && ((flags.visible && !com.visible()) || (flags.hidden && !com.hidden()) || (flags.enabled && com.find(SELINPUT).is(':disabled')) || (flags.disabled && com.find(SELINPUT).is(':enabled'))))\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\tcom.state && arr.push(com);\r\n\r\n\t\t\tif (com.$valid_disabled)\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\tcom.$validate = true;\r\n\t\t\tif (com.validate) {\r\n\t\t\t\tcom.$valid = com.validate(get(com.path));\r\n\t\t\t\tcom.$interaction(102);\r\n\t\t\t\tif (!com.$valid)\r\n\t\t\t\t\tvalid = false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tclear('valid');\r\n\t\tstate(arr, 1, 1);\r\n\t\treturn valid;\r\n\t}\r\n\r\n   /**\r\n   * Sets default values for all declared components listen on the path.\r\n   * All components need to have declared data-jc-value=\"VALUE\" attribute. \r\n   * @param  {String} path \r\n   * @param  {Number} delay Optional, default: 0 \r\n   * @param  {Boolean} reset Optional, default: true\r\n   */\r\n\tfunction defaultValue(path, timeout, reset) { //W.DEFAULT = \r\n\t\tvar arr = path.split(REGMETA);\r\n\t\tif (arr.length > 1) {\r\n\t\t\tvar def = arr[1];\r\n\t\t\tpath = arr[0];\r\n\t\t\tvar index = path.indexOf('.*');\r\n\t\t\tif (index !== -1)　{\r\n\t\t\t\tpath = path.substring(0, index);\r\n\t\t\t}\r\n\t\t\tSET(path, new Function('return ' + def)(), timeout > 10 ? timeout : 3, timeout > 10 ? 3 : null);\r\n\t\t}\r\n\t\treturn M.default(arr[0], timeout, null, reset);\r\n\t}\r\n\r\n\r\n\tvar nmCache = {};  // notmodified cache \r\n\r\n   /**\r\n   * Checks whether the value has not been modified on the path.\r\n   * @param  {String} path \r\n   * @param {Object} value  Optional\r\n   * @param {Array<String>} fields  Optional, field names\r\n   * @returns {Booean}   \r\n   */\r\n\tfunction notmodified(path, value, fields) { // W.NOTMODIFIED = \r\n\r\n\t\tif (value === undefined) {\r\n\t\t\tvalue = get(path);\r\n\t\t}\r\n\r\n\t\tif (value === undefined) {\r\n\t\t\tvalue = null;\r\n\t\t}\r\n\r\n\t\tif (fields) {\r\n\t\t\tpath = path.concat('#', fields);\r\n\t\t}\r\n\r\n\t\tvar s = langx.stringify(value, false, fields); // STRINGIFY\r\n\t\tvar hash = langx.hashCode(s); // HASH\r\n\t\tvar key =  path; // 'notmodified.' + path\r\n\r\n\t\tif (nmCache[key] === hash) { // cache\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tnmCache[key] = hash; //cache \r\n\t\treturn false;\r\n\t};\r\n\r\n\r\n\tfunction rewrite(path, value, type) { // W.REWRITE = \r\n\t\tpath = pathmaker(path);\r\n\t\tif (path) {\r\n\t\t\tM.skipproxy = path;\r\n\t\t\tset(path, value);\r\n\t\t\temitwatch(path, value, type);\r\n\t\t}\r\n\t\treturn this; // W\r\n\t}\r\n\r\n\r\n\t// inc.. \r\n\tfunction immInc(path, value, type) {  // M.inc\r\n\r\n\t\tif (path instanceof Array) {\r\n\t\t\tfor (var i = 0; i < path.length; i++)\r\n\t\t\t\timmInc(path[i], value, type);\r\n\t\t\treturn this; // M\r\n\t\t}\r\n\r\n\t\t//path = pathmaker(path); ---\r\n\r\n\t\tif (!path)\r\n\t\t\treturn this; // M\r\n\r\n\t\tvar current = get(path);\r\n\t\tif (!current) {\r\n\t\t\tcurrent = 0;\r\n\t\t} else if (!langx.isNumber(current)) {\r\n\t\t\tcurrent = parseFloat(current);\r\n\t\t\tif (isNaN(current))\r\n\t\t\t\tcurrent = 0;\r\n\t\t}\r\n\r\n\t\tcurrent += value;\r\n\t\timmSetx(path, current, type);\r\n\t\treturn this; // M\r\n\t}\r\n\r\n\r\n\t// extend...\r\n\tfunction immExtend(path, value, type) { // M.extend\r\n\t\tpath = pathmaker(path);\r\n\t\tif (path) {\r\n\t\t\tvar val = get(path);\r\n\t\t\tif (val == null) {\r\n\t\t\t\tval = {};\r\n\t\t\t}\r\n\t\t\timmSetx(path, $.extend(val, value), type);\r\n\t\t}\r\n\t\treturn this; // M\r\n\t}\r\n\r\n\r\n\tfunction immPush(path, value, type) { // M.push\r\n\r\n\t\tif (path instanceof Array) {\r\n\t\t\tfor (var i = 0; i < path.length; i++) {\r\n\t\t\t\timmPush(path[i], value, type);\r\n\t\t\t}\r\n\t\t\treturn this; // M\r\n\t\t}\r\n\r\n\t\tvar arr = get(path);\r\n\t\tvar n = false;\r\n\r\n\t\tif (!(arr instanceof Array)) {\r\n\t\t\tarr = [];\r\n\t\t\tn = true;\r\n\t\t}\r\n\r\n\t\tvar is = true;\r\n\t\tM.skipproxy = path;\r\n\r\n\t\tif (value instanceof Array) {\r\n\t\t\tif (value.length)\r\n\t\t\t\tarr.push.apply(arr, value);\r\n\t\t\telse {\r\n\t\t\t\tis = false;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tarr.push(value);\r\n\t\t}\r\n\r\n\t\tif (n) {\r\n\t\t\timmSetx(path, arr, type);\r\n\t\t} else if (is) {\r\n\t\t\timmUpdate(path, undefined, type);\r\n\t\t}\r\n\r\n\t\treturn this; // M\r\n\t}\r\n\r\n\r\n\t// 1 === manually\r\n\t// 2 === by input\r\n\tfunction immUpdate(path, reset, type, wasset) { // M.update = \r\n\r\n\t\tif (path instanceof Array) {\r\n\t\t\tfor (var i = 0; i < path.length; i++)\r\n\t\t\t\timmUpdate(path[i], reset, type);\r\n\t\t\treturn M;\r\n\t\t}\r\n\r\n\t\tpath = pathmaker(path);\r\n\t\tif (!path) {\r\n\t\t\treturn M;\r\n\t\t}\r\n\r\n\t\tvar is = path.charCodeAt(0) === 33; // !\r\n\t\tif (is) {\r\n\t\t\tpath = path.substring(1);\r\n\t\t}\r\n\r\n\t\tpath = path.replaceWildcard();\r\n\t\tif (!path)\r\n\t\t\treturn M;\r\n\r\n\t\t!wasset && $set(path, $get(path), true);\r\n\r\n\t\tvar state = [];\r\n\r\n\t\tif (type === undefined) {\r\n\t\t\ttype = 1; // manually\r\n\t\t}\r\n\r\n\t\tM.skipproxy = path;\r\n\r\n\t\tvar all = M.components.all;//M.components;\r\n\t\tfor (var i = 0, length = all.length; i < length; i++) {\r\n\t\t\tvar com = all[i];\r\n\r\n\t\t\tif (!com || com.disabled || com.$removed || !com.$loaded || !com.path || !com.$compare(path))\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\tvar result = com.get();\r\n\t\t\tif (com.setter) {\r\n\t\t\t\tcom.$skip = false;\r\n\t\t\t\tcom.setterX(result, path, type);\r\n\t\t\t\tcom.$interaction(type);\r\n\t\t\t}\r\n\r\n\t\t\tif (!com.$ready) {\r\n\t\t\t\tcom.$ready = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (reset === true) {\r\n\r\n\t\t\t\tif (!com.$dirty_disabled) {\r\n\t\t\t\t\tcom.$dirty = true;\r\n\t\t\t\t\tcom.$interaction(101);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!com.$valid_disabled) {\r\n\t\t\t\t\tcom.$valid = true;\r\n\t\t\t\t\tcom.$validate = false;\r\n\t\t\t\t\tif (com.validate) {\r\n\t\t\t\t\t\tcom.$valid = com.validate(result);\r\n\t\t\t\t\t\tcom.$interaction(102);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfindcontrol2(com);\r\n\r\n\t\t\t} else if (com.validate && !com.$valid_disabled)\r\n\t\t\t\tcom.valid(com.validate(result), true);\r\n\r\n\t\t\tcom.state && state.push(com);\r\n\t\t}\r\n\r\n\t\treset && clear('dirty', 'valid');\r\n\r\n\t\tfor (var i = 0, length = state.length; i < length; i++) {\r\n\t\t\tstate[i].stateX(1, 4);\r\n\t\t}\r\n\r\n\t\temitwatch(path, get(path), type);\r\n\r\n\t\treturn M;\r\n\t}\r\n\r\n\r\n\t// ===============================================================\r\n\t// MAIN FUNCTIONS\r\n\t// ===============================================================\r\n\r\n   /**\r\n   * Evaluates a global parser.\r\n   * @param  {String} path \r\n   * @param  {Object} value\r\n   * @param  {String} type \r\n   * @returns {Boolean}   \r\n   * OR\r\n   * Registers a global parser.\r\n   * @param  {Function} value \r\n   */\r\n\tfunction parser(value, path, type) { //W.PARSER = M.parser =  \r\n\r\n\t\tif (langx.isFunction(value)) {\r\n\r\n\t\t\t// Prepend\r\n\t\t\tif (path === true) {\r\n\t\t\t\t$parser.unshift(value);\r\n\t\t\t} else {\r\n\t\t\t\t$parser.push(value);\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tvar a = $parser;\r\n\t\tif (a && a.length) {\r\n\t\t\tfor (var i = 0, length = a.length; i < length; i++) {\r\n\t\t\t\tvalue = a[i].call(this, path, value, type);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn value;\r\n\t}\r\n\r\n\r\n\tsetInterval(function() {\r\n//\t\ttemp = {};\r\n\t\tpaths = {};\r\n//\t\tcleaner();\r\n\t}, (1000 * 60) * 5);\t\r\n\r\n\treturn jc.stores  = stores = {\r\n\t\troot : Window,\r\n\r\n\t\tunwatch : unwatch,\r\n\t\twatch : watch,\r\n\r\n\t\tget,\r\n\t\tgetx,\r\n\t\tgetr,\r\n\r\n\t\tset,\r\n\t\tset2,\r\n\t\timmSetx,\r\n\t\tsetx,\r\n\t\tsetx2,\r\n\t\tsetr,\r\n\r\n\t\ttoggle,\r\n\t\ttoogle2,\r\n\r\n\t\tcache,\r\n\r\n\t\timmInc,\r\n\r\n\r\n\t\timmExtend,\r\n\r\n\t\timmPush,\r\n\r\n\t\timmUpdate,\r\n\r\n\t\tbind,\r\n\t\tcreate,\r\n\t\tdefaultValue,\r\n\t\terrors,\r\n\t\tmake,\r\n\t\tevaluate,\r\n\t\tmake,\r\n\t\tmodified,\r\n//\t\tnotmodified,\r\n\t\tpathmaker,\r\n\t\trewrite,\r\n\t\tvalidate\r\n\t};\r\n});"]}