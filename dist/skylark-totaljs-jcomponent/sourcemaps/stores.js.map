{"version":3,"sources":["stores.js"],"names":["define","langx","jc","Store","REGPARAMS","Array","prototype","findValue","cb","value","path","def","cache","isFunction","undefined","key","val","caches","temp","index","this","findIndex","item","indexOf","get","String","params","arg","obj","replace","text","l","charCodeAt","substring","length","trim","stores"],"mappings":";;;;;;;AAAAA,QACC,sBACA,OACA,kBACC,SAASC,EAAOC,EAAIC,GAKrB,IAAIC,EAAY,iCAuDhB,OA5CAC,MAAMC,UAAUC,UAAY,SAASC,EAAIC,EAAOC,EAAMC,EAAKC,GAEtDX,EAAMY,WAAWL,KACpBG,EAAMD,EACNA,EAAOD,EACPA,OAAQK,EACRF,GAAQ,GAGT,IAAIG,EAAKC,EAAML,EAEf,GAAIC,IACHG,EAAM,MAAQP,EAAK,IAAMC,EACrBQ,OAAOC,KAAKH,IACf,OAAOE,OAAOC,KAAKH,GAIrB,IAAII,EAAQC,KAAKC,UAAUb,EAAIC,GAC/B,IAAe,IAAXU,EAAc,CACjB,IAAIG,EAAOF,KAAKD,GAEfG,GAD0B,IAAvBZ,EAAKa,QAAQ,KACTD,EAAKZ,GAELc,IAAId,EAAMY,GAElBV,IAAUK,OAAOC,KAAKH,GAAOC,GAC7BA,EAAc,MAARM,EAAeX,EAAMW,EAG5B,OAAON,GAGRS,OAAOnB,UAAUoB,OAASD,OAAOnB,UAAUqB,IAAM,SAASC,GACzD,OAAOR,KAAKS,QAAQzB,EAAW,SAAS0B,GAEvC,IAAIC,EAA2B,MAAvBD,EAAKE,WAAW,GAAa,EAAI,EACrChB,EAAMQ,IAAIM,EAAKG,UAAUF,EAAGD,EAAKI,OAASH,GAAGI,OAAQP,GACzD,OAAc,MAAPZ,EAAcc,EAAOd,KAMvBd,EAAGkC,QACTjC,MAAUA","file":"../stores.js","sourcesContent":["define([\r\n\t\"skylark-langx/langx\",\r\n\t\"./jc\",\r\n\t\"./stores/Store\"\r\n],function(langx, jc, Store){\r\n\r\n\r\n\t// paths -> view model\r\n\r\n\tvar REGPARAMS = /\\{{1,2}[a-z0-9_.-\\s]+\\}{1,2}/gi;\r\n\r\n\tvar proxy = {};\r\n\r\n\t// ===============================================================\r\n\t// PRIVATE FUNCTIONS\r\n\t// ===============================================================\r\n\r\n\tvar REGISARR = /\\[\\d+\\]$/;\r\n\r\n\r\n\tArray.prototype.findValue = function(cb, value, path, def, cache) {\r\n\r\n\t\tif (langx.isFunction(cb)) {\r\n\t\t\tdef = path;\r\n\t\t\tpath = value;\r\n\t\t\tvalue = undefined;\r\n\t\t\tcache = false;\r\n\t\t}\r\n\r\n\t\tvar key, val = def;\r\n\r\n\t\tif (cache) {\r\n\t\t\tkey = 'fv_' + cb + '=' + value;\r\n\t\t\tif (caches.temp[key]) {\r\n\t\t\t\treturn caches.temp[key];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar index = this.findIndex(cb, value);\r\n\t\tif (index !== -1) {\r\n\t\t\tvar item = this[index];\r\n\t\t\tif (path.indexOf('.') === -1) {\r\n\t\t\t\titem = item[path];\r\n\t\t\t} else {\r\n\t\t\t\titem = get(path, item);\r\n\t\t\t}\r\n\t\t\tcache && (caches.temp[key] = val);\r\n\t\t\tval = item == null ? def : item;\r\n\t\t}\r\n\r\n\t\treturn val;\r\n\t};\r\n\r\n\tString.prototype.params = String.prototype.arg = function(obj) {\r\n\t\treturn this.replace(REGPARAMS, function(text) {\r\n\t\t\t// Is double?\r\n\t\t\tvar l = text.charCodeAt(1) === 123 ? 2 : 1;\r\n\t\t\tvar val = get(text.substring(l, text.length - l).trim(), obj);\r\n\t\t\treturn val == null ? text : val;\r\n\t\t});\r\n\t};\r\n\r\n\r\n\r\n\treturn jc.stores  = {\r\n\t\t\"Store\" : Store\r\n\t}\r\n});"]}