{"version":3,"sources":["components/Scope.js"],"names":["define","langx","Scope","klass","[object Object]","elm","view","this","storing","eventer","SCP","prototype","unwatch","path","fn","off","_id","watch","init","on","reset","timeout","RESET","default","set","value","setx","push","update","get","can","except","errors","highlight","remove","arr","components","i","length","a","scope","isolated","Object","keys","proxy","substring","e","element","find","setTimeout2","cleaner2","FIND","selector","many","callback","SETTER","b","c","d","f","g","RECONFIGURE","name"],"mappings":"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","file":"../../components/Scope.js","sourcesContent":["define([\r\n\t\"../langx\"\r\n],function(langx){\r\n\t// ===============================================================\r\n\t// SCOPE\r\n\t// scopes can simplify paths in HTML declaration. In other words: \r\n\t// scopes can reduce paths in all nested components.\r\n\t// ===============================================================\r\n\r\n\tvar Scope = langx.klass({\r\n\t\t_construct(elm,view) {\r\n\t\t\tvar self = this;\r\n\t\t\tself.view = view;\r\n\t\t\tself.storing = view.storing;\r\n\t\t\tself.eventer = view.eventer;\r\n\t\t}\r\n\t});\r\n\r\n\tvar SCP = Scope.prototype;\r\n\r\n\tSCP.unwatch = function(path, fn) {\r\n\t\tvar self = this;\r\n\t\tself.eventer.off('scope' + self._id + '#watch', self.path + (path ? '.' + path : ''), fn); // OFF\r\n\t\treturn self;\r\n\t};\r\n\r\n\tSCP.watch = function(path, fn, init) {\r\n\t\tvar self = this;\r\n\t\tself.eventer.on('scope' + self._id + '#watch', self.path + (path ? '.' + path : ''), fn, init, self); // ON \r\n\t\treturn self;\r\n\t};\r\n\r\n\tSCP.reset = function(path, timeout) {\r\n\t\tif (path > 0) {\r\n\t\t\ttimeout = path;\r\n\t\t\tpath = '';\r\n\t\t}\r\n\t\treturn RESET(this.path + '.' + (path ? + path : '*'), timeout);\r\n\t};\r\n\r\n\tSCP.default = function(path, timeout) {\r\n\t\tif (path > 0) {\r\n\t\t\ttimeout = path;\r\n\t\t\tpath = '';\r\n\t\t}\r\n\t\treturn this.storing.default(this.path + '.' + (path ? path : '*'), timeout); // DEFAULT\r\n\t};\r\n\r\n\tSCP.set = function(path, value, timeout, reset) {\r\n\t\treturn this.storing.setx(this.path + (path ? '.' + path : ''), value, timeout, reset); // SET\r\n\t};\r\n\r\n\tSCP.push = function(path, value, timeout, reset) {\r\n\t\treturn this.storing.push(this.path + (path ? '.' + path : ''), value, timeout, reset); // PUSH\r\n\t};\r\n\r\n\tSCP.update = function(path, timeout, reset) {\r\n\t\treturn this.storing.update(this.path + (path ? '.' + path : ''), timeout, reset); // UPDATE\r\n\t};\r\n\r\n\tSCP.get = function(path) {\r\n\t\treturn this.storing.get(this.path + (path ? '.' + path : '')); // GET\r\n\t};\r\n\r\n\tSCP.can = function(except) {\r\n\t\treturn this.storing.can(this.path + '.*', except);  // CAN\r\n\t};\r\n\r\n\tSCP.errors = function(except, highlight) {\r\n\t\treturn this.storing.errors(this.path + '.*', except, highlight); // ERRORS\r\n\t};\r\n\r\n\tSCP.remove = function() {\r\n\t\tvar self = this;\r\n\t\tvar arr = self.view.components;//M.components;\r\n\r\n\t\tfor (var i = 0; i < arr.length; i++) {\r\n\t\t\tvar a = arr[i];\r\n\t\t\ta.scope && a.scope.path === self.path && a.remove(true);\r\n\t\t}\r\n\r\n\t\tif (self.isolated) {\r\n\t\t\tarr = Object.keys(proxy);\r\n\t\t\tfor (var i = 0; i < arr.length; i++) {\r\n\t\t\t\tvar a = arr[i];\r\n\t\t\t\tif (a.substring(0, self.path.length) === self.path)\r\n\t\t\t\t\tdelete proxy[a];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tself.eventer.off('scope' + self._id + '#watch'); // OFF\r\n\t\tvar e = self.element;\r\n\t\te.find('*').off();\r\n\t\te.off();\r\n\t\te.remove();\r\n\t\tlangx.setTimeout2('$cleaner', cleaner2, 100);\r\n\t};\r\n\r\n\tSCP.FIND = function(selector, many, callback, timeout) {\r\n\t\treturn this.element.FIND(selector, many, callback, timeout);\r\n\t};\r\n\r\n\tSCP.SETTER = function(a, b, c, d, e, f, g) {\r\n\t\treturn this.element.SETTER(a, b, c, d, e, f, g);\r\n\t};\r\n\r\n\tSCP.RECONFIGURE = function(selector, name) {\r\n\t\treturn this.element.RECONFIGURE(selector, name);\r\n\t};\r\n\r\n\treturn Scope;\r\n\t\r\n})"]}