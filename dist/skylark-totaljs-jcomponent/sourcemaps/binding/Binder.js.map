{"version":3,"sources":["binding/Binder.js"],"names":["define","$","langx","DEFMODEL","value","jBinder","prototype","exec","path","index","wakeup","can","item","this","el","child","notnull","selector","cache","find","length","delay","$delay","clearTimeout","setTimeout","obj","init","strict","track","i","def","format","tmp","show","$nn","call","tclass","hide","invisible","visible","classes","cls","fn","name","import","isFunction","$ic","http","config","$nv","c","$com","$ready","reconfigure","html","htmlbk","text","val","valbk","template","disabled","prop","disabledbk","enabled","enabledbk","checked","checkedbk","title","attr","titlebk","href","hrefbk","src","srcbk","setter","change","undefined"],"mappings":"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","file":"../../binding/Binder.js","sourcesContent":["define([\r\n\t\"../utils/query\",\r\n\t\"../utils/http\",\r\n\t\"../langx\"\r\n],function($, langx){\r\n\r\n\tvar DEFMODEL = { value: null };\r\n\t/*\r\n\t * A binder declaration:\r\n\t * <div data-bind=\"path.to.property__command1:exp__command2:exp__commandN:exp\"></div>\r\n\t */\r\n\tfunction jBinder() {\r\n\t\t//this.path = null;\r\n\t\t//this.format = null;\r\n\t\t//this.virtual = null;\r\n\t\t//this.com = null; \r\n\t\t//this.child = null;\r\n\r\n\t}\r\n\r\n\tvar JBP = jBinder.prototype;\r\n\r\n\tJBP.exec = function(value, path, index, wakeup, can) {\r\n\r\n\t\tvar item = this;\r\n\t\tvar el = item.el;\r\n\t\tif (index != null) {\r\n\t\t\tif (item.child == null)\r\n\t\t\t\treturn;\r\n\t\t\titem = item.child[index];\r\n\t\t\tif (item == null) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (item.notnull && value == null) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (item.selector) {\r\n\t\t\tif (item.cache) {\r\n\t\t\t\tel = item.cache;\r\n\t\t\t} else {\r\n\t\t\t\tel = el.find(item.selector);\r\n\t\t\t\tif (el.length) {\r\n\t\t\t\t\titem.cache = el;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (!el.length) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (!wakeup && item.delay) {\r\n\t\t\titem.$delay && clearTimeout(item.$delay);\r\n\t\t\titem.$delay = setTimeout(function(obj, value, path, index, can) {\r\n\t\t\t\tobj.$delay = null;\r\n\t\t\t\tobj.exec(value, path, index, true, can);\r\n\t\t\t}, item.delay, item, value, path, index, can);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (item.init) {\r\n\t\t\tif (item.strict && item.path !== path)\r\n\t\t\t\treturn;\r\n\t\t\tif (item.track && item.path !== path) {\r\n\t\t\t\tvar can = false;\r\n\t\t\t\tfor (var i = 0; i < item.track.length; i++) {\r\n\t\t\t\t\tif (item.track[i] === path) {\r\n\t\t\t\t\t\tcan = true;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (!can) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\titem.init = 1;\r\n\t\t}\r\n\r\n\t\tif (item.def && value == null) {\r\n\t\t\tvalue = item.def;\r\n\t\t}\r\n\r\n\t\tif (item.format) {\r\n\t\t\tvalue = item.format(value, path);\r\n\t\t}\r\n\r\n\t\tvar tmp = null;\r\n\r\n\t\tcan = can !== false;\r\n\r\n\t\tif (item.show && (value != null || !item.show.$nn)) {\r\n\t\t\ttmp = item.show.call(item.el, value, path, item.el);\r\n\t\t\tel.tclass('hidden', !tmp);\r\n\t\t\tif (!tmp) {\r\n\t\t\t\tcan = false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (item.hide && (value != null || !item.hide.$nn)) {\r\n\t\t\ttmp = item.hide.call(el, value, path, el);\r\n\t\t\tel.tclass('hidden', tmp);\r\n\t\t\tif (tmp) {\r\n\t\t\t\tcan = false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (item.invisible && (value != null || !item.invisible.$nn)) {\r\n\t\t\ttmp = item.invisible.call(item.el, value, path, item.el);\r\n\t\t\tel.tclass('invisible', tmp);\r\n\t\t\tif (!tmp) {\r\n\t\t\t\tcan = false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (item.visible && (value != null || !item.visible.$nn)) {\r\n\t\t\ttmp = item.visible.call(item.el, value, path, item.el);\r\n\t\t\tel.tclass('invisible', !tmp);\r\n\t\t\tif (!tmp) {\r\n\t\t\t\tcan = false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (item.classes) {\r\n\t\t\tfor (var i = 0; i < item.classes.length; i++) {\r\n\t\t\t\tvar cls = item.classes[i];\r\n\t\t\t\tif (!cls.fn.$nn || value != null)\r\n\t\t\t\t\tel.tclass(cls.name, !!cls.fn.call(el, value, path, el));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (can && item.import) {\r\n\t\t\tif (langx.isFunction(item.import)) {\r\n\t\t\t\tif (value) {\r\n\t\t\t\t\t!item.$ic && (item.$ic = {});\r\n\t\t\t\t\t!item.$ic[value] && http.import('ONCE ' + value, el); //IMPORT\r\n\t\t\t\t\titem.$ic[value] = 1;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\thttp.import(item.import, el); //IMPORT\r\n\t\t\t\tdelete item.import;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (item.config && (can || item.config.$nv)) {\r\n\t\t\tif (value != null || !item.config.$nn) {\r\n\t\t\t\ttmp = item.config.call(el, value, path, el);\r\n\t\t\t\tif (tmp) {\r\n\t\t\t\t\tfor (var i = 0; i < el.length; i++) {\r\n\t\t\t\t\t\tvar c = el[i].$com;\r\n\t\t\t\t\t\tc && c.$ready && c.reconfigure(tmp);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (item.html && (can || item.html.$nv)) {\r\n\t\t\tif (value != null || !item.html.$nn) {\r\n\t\t\t\ttmp = item.html.call(el, value, path, el);\r\n\t\t\t\tel.html(tmp == null ? (item.htmlbk || '') : tmp);\r\n\t\t\t} else\r\n\t\t\t\tel.html(item.htmlbk || '');\r\n\t\t}\r\n\r\n\t\tif (item.text && (can || item.text.$nv)) {\r\n\t\t\tif (value != null || !item.text.$nn) {\r\n\t\t\t\ttmp = item.text.call(el, value, path, el);\r\n\t\t\t\tel.text(tmp == null ? (item.htmlbk || '') : tmp);\r\n\t\t\t} else\r\n\t\t\t\tel.html(item.htmlbk || '');\r\n\t\t}\r\n\r\n\t\tif (item.val && (can || item.val.$nv)) {\r\n\t\t\tif (value != null || !item.val.$nn) {\r\n\t\t\t\ttmp = item.val.call(el, value, path, el);\r\n\t\t\t\tel.val(tmp == null ? (item.valbk || '') : tmp);\r\n\t\t\t} else\r\n\t\t\t\tel.val(item.valbk || '');\r\n\t\t}\r\n\r\n\t\tif (item.template && (can || item.template.$nv) && (value != null || !item.template.$nn)) {\r\n\t\t\tDEFMODEL.value = value;\r\n\t\t\tDEFMODEL.path = path;\r\n\t\t\tel.html(item.template(DEFMODEL));\r\n\t\t}\r\n\r\n\t\tif (item.disabled && (can || item.disabled.$nv)) {\r\n\t\t\tif (value != null || !item.disabled.$nn) {\r\n\t\t\t\ttmp = item.disabled.call(el, value, path, el);\r\n\t\t\t\tel.prop('disabled', tmp == true);\r\n\t\t\t} else\r\n\t\t\t\tel.prop('disabled', item.disabledbk == true);\r\n\t\t}\r\n\r\n\t\tif (item.enabled && (can || item.enabled.$nv)) {\r\n\t\t\tif (value != null || !item.enabled.$nn) {\r\n\t\t\t\ttmp = item.enabled.call(el, value, path, el);\r\n\t\t\t\tel.prop('disabled', !tmp);\r\n\t\t\t} else {\r\n\t\t\t\tel.prop('disabled', item.enabledbk == false);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (item.checked && (can || item.checked.$nv)) {\r\n\t\t\tif (value != null || !item.checked.$nn) {\r\n\t\t\t\ttmp = item.checked.call(el, value, path, el);\r\n\t\t\t\tel.prop('checked', tmp == true);\r\n\t\t\t} else {\r\n\t\t\t\tel.prop('checked', item.checkedbk == true);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (item.title && (can || item.title.$nv)) {\r\n\t\t\tif (value != null || !item.title.$nn) {\r\n\t\t\t\ttmp = item.title.call(el, value, path, el);\r\n\t\t\t\tel.attr('title', tmp == null ? (item.titlebk || '') : tmp);\r\n\t\t\t} else {\r\n\t\t\t\tel.attr('title', item.titlebk || '');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (item.href && (can || item.href.$nv)) {\r\n\t\t\tif (value != null || !item.href.$nn) {\r\n\t\t\t\ttmp = item.href.call(el, value, path, el);\r\n\t\t\t\tel.attr('href', tmp == null ? (item.hrefbk || '') : tmp);\r\n\t\t\t} else {\r\n\t\t\t\tel.attr(item.hrefbk || '');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (item.src && (can || item.src.$nv)) {\r\n\t\t\tif (value != null || !item.src.$nn) {\r\n\t\t\t\ttmp = item.src.call(el, value, path, el);\r\n\t\t\t\tel.attr('src', tmp == null ? (item.srcbk || '') : tmp);\r\n\t\t\t} else {\r\n\t\t\t\tel.attr('src', item.srcbk || '');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (item.setter && (can || item.setter.$nv) && (value != null || !item.setter.$nn))\r\n\t\t\titem.setter.call(el, value, path, el);\r\n\r\n\t\tif (item.change && (value != null || !item.change.$nn)) {\r\n\t\t\titem.change.call(el, value, path, el);\r\n\t\t}\r\n\r\n\t\tif (can && index == null && item.child) {\r\n\t\t\tfor (var i = 0; i < item.child.length; i++)\r\n\t\t\t\titem.exec(value, path, i, undefined, can);\r\n\t\t}\r\n\r\n\t\tif (item.tclass) {\r\n\t\t\tel.tclass(item.tclass);\r\n\t\t\tdelete item.tclass;\r\n\t\t}\r\n\t};\r\n\r\n\treturn jBinder;\r\n});"]}