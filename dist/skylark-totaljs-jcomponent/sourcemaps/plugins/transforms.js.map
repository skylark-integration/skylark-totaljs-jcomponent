{"version":3,"sources":["plugins/transforms.js"],"names":["define","jc","registry","transforms","register","name","callback","this","transform","value","m","arguments","length","val","cb","TYPE_S","SET","keys","split","async","context","i","key","trim","push","call","undefined","wait","fn","next"],"mappings":";;;;;;;AAAAA,QACC,QACC,SAASC,GACV,IAAIC,KA4DJ,OAAOD,EAAGE,YACTC,SAzDD,SAAkBC,EAAMC,GAEvB,OADAJ,EAASG,GAAQC,EACVC,MAwDPC,UArDD,SAASA,EAAUH,EAAMI,EAAOH,GAE/B,IAAII,EAAIR,EAER,GAAyB,IAArBS,UAAUC,OAEb,OAAO,SAASC,GACfL,EAAUH,EAAMQ,EAAKJ,IAIvB,IAAIK,EAAK,kBACE,IAAeC,OACxBC,IAAIV,EAAUG,GAEdH,EAASG,IAIPQ,EAAOZ,EAAKa,MAAM,KAClBC,KACAC,KAEJA,EAAQX,MAAQA,EAEhB,IAAK,IAAIY,EAAI,EAAGT,EAASK,EAAKL,OAAQS,EAAIT,EAAQS,IAAK,CACtD,IAAIC,EAAML,EAAKI,GAAGE,OAClBD,GAAOZ,EAAEY,IAAQH,EAAMK,KAAKd,EAAEY,IAqB/B,OAlBqB,IAAjBH,EAAMP,QACH,GAAGa,KAAKL,EAASX,EAAO,SAASI,QAC1Ba,IAARb,IACHJ,EAAQI,GACTC,MAEOK,EAAMP,OACdO,EAAMQ,KAAK,SAASC,EAAIC,GACvBD,EAAGH,KAAKL,EAASX,EAAO,SAASI,QACpBa,IAARb,IACHJ,EAAQI,GACTgB,OAECf,GAEHA,IAGMP","file":"../../plugins/transforms.js","sourcesContent":["define([\r\n\t\"./jc\"\r\n],function(jc){\r\n\tvar registry = { //M.transforms\r\n\r\n\t};\r\n\r\n\tfunction register(name, callback) { // W.NEWTRANSFORM\r\n\t\tregistry[name] = callback;  \r\n\t\treturn this;\r\n\t};\r\n\r\n\tfunction transform(name, value, callback) { //W.TRANSFORM\r\n\r\n\t\tvar m = registry;\r\n\r\n\t\tif (arguments.length === 2) {\r\n\t\t\t// name + value (is callback)\r\n\t\t\treturn function(val) {\r\n\t\t\t\ttransform(name, val, value);\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tvar cb = function() {\r\n\t\t\tif (typeof(callback) === TYPE_S) {\r\n\t\t\t\tSET(callback, value);\r\n\t\t\t} else {\r\n\t\t\t\tcallback(value);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tvar keys = name.split(',');\r\n\t\tvar async = [];\r\n\t\tvar context = {};\r\n\r\n\t\tcontext.value = value;\r\n\r\n\t\tfor (var i = 0, length = keys.length; i < length; i++) {\r\n\t\t\tvar key = keys[i].trim();\r\n\t\t\tkey && m[key] && async.push(m[key]);\r\n\t\t}\r\n\r\n\t\tif (async.length === 1)\r\n\t\t\tasync[0].call(context, value, function(val) {\r\n\t\t\t\tif (val !== undefined)\r\n\t\t\t\t\tvalue = val;\r\n\t\t\t\tcb();\r\n\t\t\t});\r\n\t\telse if (async.length) {\r\n\t\t\tasync.wait(function(fn, next) {\r\n\t\t\t\tfn.call(context, value, function(val) {\r\n\t\t\t\t\tif (val !== undefined)\r\n\t\t\t\t\t\tvalue = val;\r\n\t\t\t\t\tnext();\r\n\t\t\t\t});\r\n\t\t\t}, cb);\r\n\t\t} else {\r\n\t\t\tcb();\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t};\r\n\r\n\treturn jc.transforms = {\r\n\t\tregister,\r\n\t\ttransform\r\n\t}\r\n});"]}