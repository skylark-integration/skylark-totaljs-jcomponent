{"version":3,"sources":["plugins/Plugin.js"],"names":["define","$","jc","caches","registry","schedulers","Plugin","name","fn","test","warn","$remove","t","this","id","call","prototype","element","clearAll"],"mappings":";;;;;;;AAAAA,QACC,0BACA,QACA,iBACA,cACA,gBACC,SAASC,EAAGC,EAAIC,EAAQC,EAASC,GAElC,SAASC,EAAOC,EAAMC,GACjB,KAAOC,KAAKF,IACfG,KAAK,4CAEFN,EAASG,IACZH,EAASG,GAAMI,SAAQ,GAExB,IAAIC,EAAIC,KAERD,EAAEE,GAAK,OAASP,EAChBK,EAAEL,KAAOA,EACTH,EAASG,GAAQK,EAGjBJ,EAAGO,KAAKH,EAAGA,GA6CZ,OAxCAN,EAAOU,UAAUL,QAAU,WAG1B,OADWE,KACDI,UA2BVZ,EAAWa,SA5BAL,KA4BcC,IA5BdD,KA+BNI,QAAU,YAERb,EAjCIS,KAiCUN,OACd,IAIDD","file":"../../plugins/Plugin.js","sourcesContent":["define([\r\n\t\"skylark-utils-dom/query\",\r\n\t\"../jc\",\r\n\t\"../utils/cache\",\r\n\t\"./_registry\",\r\n\t\"./schedulers\"\r\n],function($, jc, caches, registry,schedulers){\r\n\t\r\n\tfunction Plugin(name, fn) {\r\n\t\tif ((/\\W/).test(name)) {\r\n\t\t\twarn('Plugin name must contain A-Z chars only.');\r\n\t\t}\r\n\t\tif (registry[name]) {\r\n\t\t\tregistry[name].$remove(true);\r\n\t\t}\r\n\t\tvar t = this;\r\n\t\t//t.element = $(caches.current.element || document.body); // TODO\r\n\t\tt.id = 'plug' + name;\r\n\t\tt.name = name;\r\n\t\tregistry[name] = t;\r\n\t\t//var a = caches.current.owner;\r\n\t\t//caches.current.owner = t.id;\r\n\t\tfn.call(t, t);\r\n\t\t//caches.current.owner = a;\r\n\t\t// topic.emit('plugin', t); // EMIT TODO\r\n\t}\r\n\r\n\tPlugin.prototype.$remove = function() {\r\n\r\n\t\tvar self = this;\r\n\t\tif (!self.element) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t/* TODO\r\n\t\ttopic.emit('plugin.destroy', self); // EMIT\r\n\t\tif (self.destroy) {\r\n\t\t\tself.destroy();\r\n\t\t}\r\n\r\n\t\t// Remove all global events\r\n\t\tObject.keys(events).forEach(function(e) {\r\n\t\t\tvar evt = events[e];\r\n\t\t\tevt = evt.remove('owner', self.id);\r\n\t\t\tif (!evt.length) {\r\n\t\t\t\tdelete events[e];\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\twatches = watches.remove('owner', self.id);\r\n\r\n\t\t// Remove events\r\n\t\ttopic.off(self.id + '#watch'); // OFF \r\n\t\t*/\r\n\r\n\t\t// Remove schedulers\r\n\t\t//schedulers = schedulers.remove('owner', self.id);\r\n\t\tschedulers.clearAll(self.id);\r\n\r\n\t\t// self.element.remove();\r\n\t\tself.element = null;\r\n\r\n\t\tdelete registry[self.name];\r\n\t\treturn true;\r\n\t};\r\n\r\n\r\n\treturn Plugin;\r\n});"]}