{"version":3,"sources":["domx.js"],"names":["define","query","jc","langx","caches","MD","devices","xs","max","sm","min","md","lg","knockknockcounter","mediaqueries","mediaquery","length","orientation","W","Math","abs","$w","$","w","width","h","height","d","i","mq","cw","ch","element","minW","maxW","minH","maxH","oldW","oldH","type","fn","id","resize","window","WW","WH","KEYPRESS","timeout","key","str","toString","beg","tkey","hashCode","substring","setTimeout2","aclass","a","this","addClass","rclass","removeClass","rattr","removeAttr","rattrd","rclass2","arr","attr","split","isReg","TYPE_O","cls","test","indexOf","hclass","hasClass","tclass","v","toggleClass","attrd","asvg","tag","el","document","createElementNS","append","innerHTML","f","createDocumentFragment","firstChild","appendChild","psvg","prepend","rescroll","offset","bottom","each","scrollIntoView","count","scrollTop","parentNode","off","getBoundingClientRect","scrollHeight","components","M","setInterval","now","c","knockknock","EMIT","on","domx","importscripts","scr","output","external","end","code","lastIndexOf","trim","replace","eid","statics","push","join"],"mappings":"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","file":"../domx.js","sourcesContent":["define([\r\n\t\"skylark-utils-dom/query\",\r\n\t\"./jc\",\r\n\t\"./langx\",\r\n\t\"./caches\"\r\n],function(query,jc,langx,caches){\r\n\tMD.devices = { xs: { max: 768 }, sm: { min: 768, max: 992 }, md: { min: 992, max: 1200 }, lg: { min: 1200 }};\r\n\r\n\tvar REGCSS = /<style\\b[^<]*(?:(?!<\\/style>)<[^<]*)*<\\/style>/gi;\r\n\tvar REGSCRIPT = /<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>|<style\\b[^<]*(?:(?!<\\/style>)<[^<]*)*<\\/style>/gi;\r\n\tvar mediaqueriescounter = 0;\r\n\tvar knockknockcounter = 0;\r\n\r\n \tvar mediaqueries = [];\r\n\tvar $domready = false;\r\n\t\r\n\tfunction mediaquery() {\r\n\r\n\t\tif (!mediaqueries || !mediaqueries.length)\r\n\t\t\treturn;\r\n\r\n\t\tvar orientation = W.orientation ? Math.abs(W.orientation) === 90 ? 'landscape' : 'portrait' : '';\r\n\r\n\t\tvar $w = $(W);\r\n\t\tvar w = $w.width();\r\n\t\tvar h = $w.height();\r\n\t\tvar d = MD.devices;\r\n\r\n\t\tfor (var i = 0, length = mediaqueries.length; i < length; i++) {\r\n\t\t\tvar mq = mediaqueries[i];\r\n\t\t\tvar cw = w;\r\n\t\t\tvar ch = h;\r\n\r\n\t\t\tif (mq.element) {\r\n\t\t\t\tcw = mq.element.width();\r\n\t\t\t\tch = mq.element.height();\r\n\t\t\t}\r\n\r\n\t\t\tif (mq.orientation) {\r\n\t\t\t\tif (!orientation && mq.orientation !== 'portrait')\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\telse if (orientation !== mq.orientation)\r\n\t\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tif (mq.minW && mq.minW >= cw)\r\n\t\t\t\tcontinue;\r\n\t\t\tif (mq.maxW && mq.maxW <= cw)\r\n\t\t\t\tcontinue;\r\n\t\t\tif (mq.minH && mq.minH >= ch)\r\n\t\t\t\tcontinue;\r\n\t\t\tif (mq.maxH && mq.maxH <= ch)\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\tif (mq.oldW === cw && mq.oldH !== ch) {\r\n\t\t\t\t// changed height\r\n\t\t\t\tif (!mq.maxH && !mq.minH)\r\n\t\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tif (mq.oldH === ch && mq.oldW !== cw) {\r\n\t\t\t\t// changed width\r\n\t\t\t\tif (!mq.maxW && !mq.minW)\r\n\t\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tif (mq.oldW === cw && mq.oldH === ch)\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\tvar type = null;\r\n\r\n\t\t\tif (cw >= d.md.min && cw <= d.md.max)\r\n\t\t\t\ttype = 'md';\r\n\t\t\telse if (cw >= d.sm.min && cw <= d.sm.max)\r\n\t\t\t\ttype = 'sm';\r\n\t\t\telse if (cw > d.lg.min)\r\n\t\t\t\ttype = 'lg';\r\n\t\t\telse if (cw <= d.xs.max)\r\n\t\t\t\ttype = 'xs';\r\n\r\n\t\t\tmq.oldW = cw;\r\n\t\t\tmq.oldH = ch;\r\n\t\t\tmq.fn(cw, ch, type, mq.id);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction inDOM(el) {\r\n\t\tif (!el)\r\n\t\t\treturn;\r\n\t\tif (el.nodeName === 'BODY')\r\n\t\t\treturn true;\r\n\t\tvar parent = el.parentNode;\r\n\t\twhile (parent) {\r\n\t\t\tif (parent.nodeName === 'BODY')\r\n\t\t\t\treturn true;\r\n\t\t\tparent = parent.parentNode;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction remove(el) {\r\n\t\tvar dom = el[0];\r\n\t\tdom.$com = null;\r\n\t\tel.attr(ATTRDEL, true);\r\n\t\tel.remove();\r\n\t}\r\n\r\n\tfunction removescripts(str) {\r\n\t\treturn str.replace(REGSCRIPT, function(text) {\r\n\t\t\tvar index = text.indexOf('>');\r\n\t\t\tvar scr = text.substring(0, index + 1);\r\n\t\t\treturn scr.substring(0, 6) === '<style' || (scr.substring(0, 7) === '<script' && scr.indexOf('type=\"') === -1) || scr.indexOf('/javascript\"') !== -1 ? '' : text;\r\n\t\t});\r\n\t}\r\n\r\n\tfunction importscripts(str) {\r\n\r\n\t\tvar beg = -1;\r\n\t\tvar output = str;\r\n\t\tvar external = [];\r\n\t\tvar scr;\r\n\r\n\t\twhile (true) {\r\n\r\n\t\t\tbeg = str.indexOf('<script', beg);\r\n\t\t\tif (beg === -1) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tvar end = str.indexOf('</script>', beg + 8);\r\n\t\t\tvar code = str.substring(beg, end + 9);\r\n\t\t\tbeg = end + 9;\r\n\t\t\tend = code.indexOf('>');\r\n\t\t\tscr = code.substring(0, end);\r\n\r\n\t\t\tif (scr.indexOf('type=') !== -1 && scr.lastIndexOf('javascript') === -1) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tvar tmp = code.substring(end + 1, code.length - 9).trim();\r\n\t\t\tif (!tmp) {\r\n\t\t\t\toutput = output.replace(code, '').trim();\r\n\t\t\t\tvar eid = 'external' + langx.hashCode(code);\r\n\t\t\t\tif (!statics[eid]) {\r\n\t\t\t\t\texternal.push(code);\r\n\t\t\t\t\tstatics[eid] = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (external.length) {\r\n\t\t\t$('head').append(external.join('\\n'));\r\n\t\t}\r\n\t\treturn output;\r\n\t}\r\n\r\n\tfunction importstyles(str, id) {\r\n\t\tvar builder = [];\r\n\r\n\t\tstr = str.replace(REGCSS, function(text) {\r\n\t\t\ttext = text.replace('<style>', '<style type=\"text/css\">');\r\n\t\t\tbuilder.push(text.substring(23, text.length - 8).trim());\r\n\t\t\treturn '';\r\n\t\t});\r\n\r\n\t\tvar key = 'css' + (id || '');\r\n\r\n\t\tif (id) {\r\n\t\t\tif (statics[key])\r\n\t\t\t\t$('#' + key).remove();\r\n\t\t\telse\r\n\t\t\t\tstatics[key] = true;\r\n\t\t}\r\n\r\n\t\tbuilder.length && $('<style' + (id ? ' id=\"' + key + '\"' : '') + '>{0}</style>'.format(builder.join('\\n'))).appendTo('head');\r\n\t\treturn str;\r\n\t}\r\n\r\n\tfunction scrollbarWidth() { //W.SCROLLBARWIDTH = \r\n\t\tvar id = 'jcscrollbarwidth';\r\n\t\t\tw = caches.get(id);\r\n\t\tif (w !== undefined) {\r\n\t\t\treturn w;\r\n\t\t}\r\n\t\tvar b = document.body;\r\n\t\t$(b).append('<div id=\"{0}\" style=\"width{1}height{1}overflow:scroll;position:absolute;top{2}left{2}\"></div>'.format(id, ':100px;', ':9999px;'));\r\n\t\tvar el = document.getElementById(id);\r\n\t\tw = el.offsetWidth - el.clientWidth;\r\n\t\tb.removeChild(el);\r\n\t\tcaches.set(id,w);\r\n\t\treturn w;\r\n\t}\r\n\r\n   /**\r\n   * Returns a current display size of the element. Display size can be:\r\n   * <ul>\r\n   *   <li>xs extra small display (mobile device)</li>\r\n   *   <li>sm small display (tablet)</li>\r\n   *   <li>md medium display (small laptop)</li>\r\n   *   <li>lg large display (desktop computer, laptop)</li>\r\n   * </ul>\r\n   * execute CSS() twice then the previous styles will be removed.\r\n   * @param  {String} value \r\n   * @param  {String} id \r\n   */\r\n\tfunction width(el) { //W.WIDTH = \r\n\t\tif (!el) {\r\n\t\t\tel = $(Window);\r\n\t\t}\r\n\t\tvar w = el.width();\r\n\t\tvar d = MD.devices;\r\n\t\treturn w >= d.md.min && w <= d.md.max ? 'md' : w >= d.sm.min && w <= d.sm.max ? 'sm' : w > d.lg.min ? 'lg' : w <= d.xs.max ? 'xs' : '';\r\n\t}\r\n\r\n   /**\r\n   * Registers a listener for specific size of the browser window or element.\r\n   * @param  {String} query media CSS query string \r\n   * @param  {jQuery Element} id \r\n   * @param  {Function(w, h, type, id)} fn \r\n   * @return {Number } an idetificator of MediaQuery\r\n   */\r\n\tfunction watchMedia(query, element, fn) { //W.MEDIAQUERY = \r\n\r\n\t\tif (typeof(query) === TYPE_N) {\r\n\t\t\tmediaqueries.remove('id', query);\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tif (typeof(element) === TYPE_FN) {\r\n\t\t\tfn = element;\r\n\t\t\telement = null;\r\n\t\t}\r\n\r\n\t\tquery = query.toLowerCase();\r\n\t\tif (query.indexOf(',') !== -1) {\r\n\t\t\tvar ids = [];\r\n\t\t\tquery.split(',').forEach(function(q) {\r\n\t\t\t\tq = q.trim();\r\n\t\t\t\tq && ids.push(MEDIAQUERY(q, element, fn));\r\n\t\t\t});\r\n\t\t\treturn ids;\r\n\t\t}\r\n\r\n\t\tvar d = MD.devices;\r\n\r\n\t\tif (query === 'md')\r\n\t\t\tquery = 'min-width:{0}px and max-width:{1}px'.format(d.md.min, d.md.max);\r\n\t\telse if (query === 'lg')\r\n\t\t\tquery = 'min-width:{0}px'.format(d.lg.min);\r\n\t\telse if (query === 'xs')\r\n\t\t\tquery = 'max-width:{0}px'.format(d.xs.max);\r\n\t\telse if (query === 'sm')\r\n\t\t\tquery = 'min-width:{0}px and max-width:{1}px'.format(d.sm.min, d.sm.max);\r\n\r\n\t\tvar arr = query.match(/(max-width|min-width|max-device-width|min-device-width|max-height|min-height|max-device-height|height|width):(\\s)\\d+(px|em|in)?/gi);\r\n\t\tvar obj = {};\r\n\r\n\t\tvar num = function(val) {\r\n\t\t\tvar n = parseInt(val.match(/\\d+/), 10);\r\n\t\t\treturn val.match(/\\d+(em)/) ? n * 16 : val.match(/\\d+(in)/) ? (n * 0.010416667) >> 0 : n;\r\n\t\t};\r\n\r\n\t\tif (arr) {\r\n\t\t\tfor (var i = 0, length = arr.length; i < length; i++) {\r\n\t\t\t\tvar item = arr[i];\r\n\t\t\t\tvar index = item.indexOf(':');\r\n\t\t\t\tswitch (item.substring(0, index).toLowerCase().trim()) {\r\n\t\t\t\t\tcase 'min-width':\r\n\t\t\t\t\tcase 'min-device-width':\r\n\t\t\t\t\tcase 'width':\r\n\t\t\t\t\t\tobj.minW = num(item);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'max-width':\r\n\t\t\t\t\tcase 'max-device-width':\r\n\t\t\t\t\t\tobj.maxW = num(item);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'min-height':\r\n\t\t\t\t\tcase 'min-device-height':\r\n\t\t\t\t\tcase 'height':\r\n\t\t\t\t\t\tobj.minH = num(item);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'max-height':\r\n\t\t\t\t\tcase 'max-device-height':\r\n\t\t\t\t\t\tobj.maxH = num(item);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tarr = query.match(/orientation:(\\s)(landscape|portrait)/gi);\r\n\t\tif (arr) {\r\n\t\t\tfor (var i = 0, length = arr.length; i < length; i++) {\r\n\t\t\t\tvar item = arr[i];\r\n\t\t\t\tif (item.toLowerCase().indexOf('portrait') !== -1) {\r\n\t\t\t\t\tobj.orientation = 'portrait';\r\n\t\t\t\t} else {\r\n\t\t\t\t\tobj.orientation = 'landscape';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tobj.id = mediaqueriescounter++;\r\n\t\tobj.fn = fn;\r\n\r\n\t\tif (element) {\r\n\t\t\tobj.element = element;\r\n\t\t}\r\n\r\n\t\tmediaqueries.push(obj);\r\n\t\treturn obj.id;\r\n\t};\r\n\r\n   /**\r\n   * creates inline CSS registered in the head tag. If you use id and \r\n   * execute CSS() twice then the previous styles will be removed.\r\n   * @param  {String} value \r\n   * @param  {String} id \r\n   */\r\n\tfunction style(value, id) { //W.CSS = W.STYLE = \r\n\t\tif (id) {\r\n\t\t $('#css' + id).remove();\r\n\t\t}\r\n\t\t$('<style type=\"text/css\"' + (id ? ' id=\"css' + id + '\"' : '') + '>' + (value instanceof Array ? value.join('') : value) + '</style>').appendTo('head');\r\n\t};\r\n\r\n\r\n\tW.KEYPRESS = function(fn, timeout, key) {\r\n\t\tif (!timeout) {\r\n\t\t\ttimeout = 300;\r\n\t\t}\r\n\t\tvar str = fn.toString();\r\n\t\tvar beg = str.length - 20;\r\n\t\tif (beg < 0) {\r\n\t\t\tbeg = 0;\r\n\t\t}\r\n\t\tvar tkey = key ? key : langx.hashCode(str.substring(0, 20) + 'X' + str.substring(beg)) + '_keypress';\r\n\t\tlangx.setTimeout2(tkey, fn, timeout);\r\n\t};\r\n\r\n\tfunction keypressdelay(self) {\r\n\t\tvar com = self.$com;\r\n\t\t// Reset timeout\r\n\t\tself.$jctimeout = 0;\r\n\t\t// It's not dirty\r\n\t\tcom.dirty(false, true);\r\n\t\t// Binds a value\r\n\t\tcom.getter(self.value, true);\r\n\t}\r\n\r\n\t\r\n\t//-- Waits for jQuery\r\n\t//WAIT(function() {\r\n\t//\treturn !!W.jQuery;\r\n\t//}, function() {\r\n\r\n\t//\tsetInterval(function() {\r\n\t//\t\ttemp = {};\r\n\t//\t\tpaths = {};\r\n\t//\t\tcleaner();\r\n\t//\t}, (1000 * 60) * 5);\r\n\r\n\t\t// scheduler\r\n\r\n\r\n\r\n\t\t$.fn.aclass = function(a) {\r\n\t\t\treturn this.addClass(a);\r\n\t\t};\r\n\r\n\t\t$.fn.rclass = function(a) {\r\n\t\t\treturn a == null ? this.removeClass() : this.removeClass(a);\r\n\t\t};\r\n\r\n\t\t$.fn.rattr = function(a) {\r\n\t\t\treturn this.removeAttr(a);\r\n\t\t};\r\n\r\n\t\t$.fn.rattrd = function(a) {\r\n\t\t\treturn this.removeAttr('data-' + a);\r\n\t\t};\r\n\r\n\t\t$.fn.rclass2 = function(a) {\r\n\r\n\t\t\tvar self = this;\r\n\t\t\tvar arr = (self.attr('class') || '').split(' ');\r\n\t\t\tvar isReg = typeof(a) === TYPE_O;\r\n\r\n\t\t\tfor (var i = 0, length = arr.length; i < length; i++) {\r\n\t\t\t\tvar cls = arr[i];\r\n\t\t\t\tif (cls) {\r\n\t\t\t\t\tif (isReg) {\r\n\t\t\t\t\t\ta.test(cls) && self.rclass(cls);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcls.indexOf(a) !== -1 && self.rclass(cls);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn self;\r\n\t\t};\r\n\r\n\t\t$.fn.hclass = function(a) {\r\n\t\t\treturn this.hasClass(a);\r\n\t\t};\r\n\r\n\t\t$.fn.tclass = function(a, v) {\r\n\t\t\treturn this.toggleClass(a, v);\r\n\t\t};\r\n\r\n\t\t$.fn.attrd = function(a, v) {\r\n\t\t\ta = 'data-' + a;\r\n\t\t\treturn v == null ? this.attr(a) : this.attr(a, v);\r\n\t\t};\r\n\r\n\t\t// Appends an SVG element\r\n\t\t$.fn.asvg = function(tag) {\r\n\r\n\t\t\tif (tag.indexOf('<') === -1) {\r\n\t\t\t\tvar el = document.createElementNS('http://www.w3.org/2000/svg', tag);\r\n\t\t\t\tthis.append(el);\r\n\t\t\t\treturn $(el);\r\n\t\t\t}\r\n\r\n\t\t\tvar d = document.createElementNS('http://www.w3.org/1999/xhtml', 'div');\r\n\t\t\td.innerHTML = '<svg xmlns=\"http://www.w3.org/2000/svg\">' + tag + '</svg>';\r\n\t\t\tvar f = document.createDocumentFragment();\r\n\t\t\twhile (d.firstChild.firstChild)\r\n\t\t\t\tf.appendChild(d.firstChild.firstChild);\r\n\t\t\tf = $(f);\r\n\t\t\tthis.append(f);\r\n\t\t\treturn f;\r\n\t\t};\r\n\r\n\t\t$.fn.psvg = function(tag) {\r\n\r\n\t\t\tif (tag.indexOf('<') === -1) {\r\n\t\t\t\tvar el = document.createElementNS('http://www.w3.org/2000/svg', tag);\r\n\t\t\t\tthis.prepend(el);\r\n\t\t\t\treturn $(el);\r\n\t\t\t}\r\n\r\n\t\t\tvar d = document.createElementNS('http://www.w3.org/1999/xhtml', 'div');\r\n\t\t\td.innerHTML = '<svg xmlns=\"http://www.w3.org/2000/svg\">' + tag + '</svg>';\r\n\t\t\tvar f = document.createDocumentFragment();\r\n\t\t\twhile (d.firstChild.firstChild)\r\n\t\t\t\tf.appendChild(d.firstChild.firstChild);\r\n\t\t\tf = $(f);\r\n\t\t\tthis.prepend(f);\r\n\t\t\treturn f;\r\n\t\t};\r\n\r\n\t\t$.fn.rescroll = function(offset, bottom) {\r\n\t\t\tvar t = this;\r\n\t\t\tt.each(function() {\r\n\t\t\t\tvar e = this;\r\n\t\t\t\tvar el = e;\r\n\t\t\t\tel.scrollIntoView(true);\r\n\t\t\t\tif (offset) {\r\n\t\t\t\t\tvar count = 0;\r\n\t\t\t\t\twhile (el && el.scrollTop == 0 && count++ < 25) {\r\n\t\t\t\t\t\tel = el.parentNode;\r\n\t\t\t\t\t\tif (el && el.scrollTop) {\r\n\r\n\t\t\t\t\t\t\tvar off = el.scrollTop + offset;\r\n\r\n\t\t\t\t\t\t\tif (bottom != false) {\r\n\t\t\t\t\t\t\t\tif (el.scrollTop + el.getBoundingClientRect().height >= el.scrollHeight) {\r\n\t\t\t\t\t\t\t\t\tel.scrollTop = el.scrollHeight;\r\n\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tel.scrollTop = off;\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn t;\r\n\t\t};\r\n\r\n\t\t$.components = M;\r\n\r\n\t\tsetInterval(function() {\r\n\t\t\t//W.DATETIME = W.NOW = new Date();\r\n\t\t\tlangx.now(true);\r\n\t\t\tvar c = M.components;\r\n\t\t\tfor (var i = 0, length = c.length; i < length; i++)\r\n\t\t\t\tc[i].knockknock && c[i].knockknock(knockknockcounter);\r\n\t\t\tEMIT('knockknock', knockknockcounter++);\r\n\t\t}, 60000);\r\n\r\n\t\tfunction resize() {\r\n\t\t\tvar w = $(window);\r\n\t\t\tW.WW = w.width();\r\n\t\t\tW.WH = w.height();\r\n\t\t\tmediaquery();\r\n\t\t}\r\n\r\n\t\tresize();\r\n\r\n\t\t$(window).on('resize', resize);\r\n\t//}, 100);\r\n\r\n\treturn jc.domx = {\r\n\t\tmediaquery,\r\n\t\timportscripts,\r\n\t}\r\n\r\n});"]}