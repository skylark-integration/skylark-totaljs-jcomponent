{"version":3,"sources":["binders.js"],"names":["define","$","jc","langx","plugins","ATTRBIND","REGCOMMA","REGEMPTY","jBinder","parser","value","path","type","isFunction","$parser","unshift","push","this","a","length","i","call","M","fn","scope","data","$scopedata","el","closest","ATTRSCOPE","prototype","exec","index","wakeup","can","item","child","notnull","selector","cache","find","delay","$delay","clearTimeout","setTimeout","obj","init","strict","track","def","format","tmp","show","$nn","tclass","hide","invisible","visible","classes","cls","name","import","TYPE_FN","$ic","IMPORT","config","$nv","c","$com","$ready","reconfigure","html","htmlbk","text","val","valbk","template","DEFMODEL","disabled","prop","disabledbk","enabled","enabledbk","checked","checkedbk","title","attr","titlebk","href","hrefbk","src","srcbk","setter","change","undefined","v","isString","replace","isNaN","Date","parseDate","getTime","VBinder","t","e","element","binders","b","attrd","$jcbind","parsebinder","empties","array","filter","each","VBP","vbind","on","apply","arguments","remove","off","set","model","$get","vbindArray","items","COM","$vbindarray","checksum","serialize","TYPE_N","TYPE_S","JSON","stringify","sum","binder","j","p","substring","HASH","Array","$bchecksum","rem","splice","$vbind","append"],"mappings":"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","file":"../binders.js","sourcesContent":["define([\r\n\t\"skylark-utils-dom/query\",\r\n\t\"./jc\",\r\n\t\"./langx\",\r\n\t\"./plugins\"\r\n],function($, jc,langx,plugins){\r\n\tvar ATTRBIND = '[data-bind],[bind],[data-vbind]';\r\n\r\n\tvar REGCOMMA = /,/g;\r\n\tvar REGEMPTY = /\\s/g;\r\n\tvar REGMETA = /_{2,}/;\r\n\r\n\r\n\t//var W = jc.W = {};\r\n\r\n\r\n\t// temporary\r\n\t//W.jctmp = {}; // not used\r\n\t//W.W = window; \r\n\t//W.FUNC = {};\r\n\r\n\r\n\tfunction attrcom(el, name) {\r\n\t\tname = name ? '-' + name : '';\r\n\t\treturn el.getAttribute ? el.getAttribute('data-jc' + name) : el.attrd('jc' + name);\r\n\t}\r\n\r\n\t$.fn.scope = function() {\r\n\r\n\t\tif (!this.length)\r\n\t\t\treturn null;\r\n\r\n\t\tvar data = this[0].$scopedata;\r\n\t\tif (data)\r\n\t\t\treturn data;\r\n\t\tvar el = this.closest('[' + ATTRSCOPE + ']');\r\n\t\tif (el.length) {\r\n\t\t\tdata = el[0].$scopedata;\r\n\t\t\tif (data)\r\n\t\t\t\treturn data;\r\n\t\t}\r\n\t\treturn null;\r\n\t};\r\n\r\n\r\n\tfunction initscopes(scopes) {\r\n\r\n\t\tvar scope = scopes[scopes.length - 1];\r\n\t\tif (scope.$scopedata) {\r\n\t\t\treturn scope.$scopedata;\r\n\t\t}\r\n\r\n\t\tvar path = attrcom(scope, 'scope');\r\n\t\tvar independent = path.substring(0, 1) === '!';\r\n\r\n\t\tif (independent) {\r\n\t\t\tpath = path.substring(1);\r\n\t\t}\r\n\r\n\t\tvar arr = [scope];\r\n\t\tif (!independent) {\r\n\t\t\tfor (var i = scopes.length - 1; i > -1; i--) {\r\n\t\t\t\tarr.push(scopes[i]);\r\n\t\t\t\tif (scopes[i].getAttribute(ATTRSCOPE).substring(0, 1) === '!') {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar absolute = '';\r\n\r\n\t\tarr.length && arr.reverse();\r\n\r\n\t\tfor (var i = 0, length = arr.length; i < length; i++) {\r\n\r\n\t\t\tvar sc = arr[i];\r\n\t\t\tvar p = sc.$scope || attrcom(sc, 'scope');\r\n\r\n\t\t\tsc.$initialized = true;\r\n\r\n\t\t\tif (sc.$processed) {\r\n\t\t\t\tabsolute = p;\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tsc.$processed = true;\r\n\t\t\tsc.$isolated = p.substring(0, 1) === '!';\r\n\r\n\t\t\tif (sc.$isolated) {\r\n\t\t\t\tp = p.substring(1);\r\n\t\t\t}\r\n\r\n\t\t\tif (!p || p === '?')\r\n\t\t\t\tp = GUID(25).replace(/\\d/g, '');\r\n\r\n\t\t\tif (sc.$isolated) {\r\n\t\t\t\tabsolute = p;\r\n\t\t\t} else {\r\n\t\t\t\tabsolute += (absolute ? '.' : '') + p;\r\n\t\t\t}\r\n\r\n\t\t\tsc.$scope = absolute;\r\n\t\t\tvar d = new Scope();\r\n\t\t\td._id = d.ID = d.id = GUID(10);\r\n\t\t\td.path = absolute;\r\n\t\t\td.elements = arr.slice(0, i + 1);\r\n\t\t\td.isolated = sc.$isolated;\r\n\t\t\td.element = $(arr[0]);\r\n\t\t\tsc.$scopedata = d;\r\n\r\n\t\t\tvar tmp = attrcom(sc, 'value');\r\n\t\t\tif (tmp) {\r\n\t\t\t\tvar fn = new Function('return ' + tmp);\r\n\t\t\t\tdefaults['#' + HASH(p)] = fn; // paths by path (DEFAULT() --> can reset scope object)\r\n\t\t\t\ttmp = fn();\r\n\t\t\t\tset(p, tmp);\r\n\t\t\t\temitwatch(p, tmp, 1);\r\n\t\t\t}\r\n\r\n\t\t\t// Applies classes\r\n\t\t\tvar cls = attrcom(sc, 'class');\r\n\t\t\tif (cls) {\r\n\t\t\t\t(function(cls) {\r\n\t\t\t\t\tcls = cls.split(' ');\r\n\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\tvar el = $(sc);\r\n\t\t\t\t\t\tfor (var i = 0, length = cls.length; i < length; i++) {\r\n\t\t\t\t\t\t\tel.tclass(cls[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, 5);\r\n\t\t\t\t})(cls);\r\n\t\t\t}\r\n\r\n\t\t\ttmp = attrcom(sc, 'init');\r\n\t\t\tif (tmp) {\r\n\t\t\t\ttmp = scopes.get(tmp);\r\n\t\t\t\tif (tmp) {\r\n\t\t\t\t\tvar a = current_owner;\r\n\t\t\t\t\tcurrent_owner = 'scope' + d._id;\r\n\t\t\t\t\ttmp.call(d, p, $(sc));\r\n\t\t\t\t\tcurrent_owner = a;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn scope.$scopedata;\r\n\t}\r\n\r\n\tfunction rebinddecode(val) {\r\n\t\treturn val.replace(/&#39;/g, '\\'');\r\n\t}\r\n\r\n\tfunction jBinder() {}\r\n\r\n\tvar JBP = jBinder.prototype;\r\n\tJBP.exec = function(value, path, index, wakeup, can) {\r\n\r\n\t\tvar item = this;\r\n\t\tvar el = item.el;\r\n\t\tif (index != null) {\r\n\t\t\tif (item.child == null)\r\n\t\t\t\treturn;\r\n\t\t\titem = item.child[index];\r\n\t\t\tif (item == null)\r\n\t\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (item.notnull && value == null)\r\n\t\t\treturn;\r\n\r\n\t\tif (item.selector) {\r\n\t\t\tif (item.cache)\r\n\t\t\t\tel = item.cache;\r\n\t\t\telse {\r\n\t\t\t\tel = el.find(item.selector);\r\n\t\t\t\tif (el.length)\r\n\t\t\t\t\titem.cache = el;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (!el.length)\r\n\t\t\treturn;\r\n\r\n\t\tif (!wakeup && item.delay) {\r\n\t\t\titem.$delay && clearTimeout(item.$delay);\r\n\t\t\titem.$delay = setTimeout(function(obj, value, path, index, can) {\r\n\t\t\t\tobj.$delay = null;\r\n\t\t\t\tobj.exec(value, path, index, true, can);\r\n\t\t\t}, item.delay, item, value, path, index, can);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (item.init) {\r\n\t\t\tif (item.strict && item.path !== path)\r\n\t\t\t\treturn;\r\n\t\t\tif (item.track && item.path !== path) {\r\n\t\t\t\tvar can = false;\r\n\t\t\t\tfor (var i = 0; i < item.track.length; i++) {\r\n\t\t\t\t\tif (item.track[i] === path) {\r\n\t\t\t\t\t\tcan = true;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (!can)\r\n\t\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\titem.init = 1;\r\n\t\t}\r\n\r\n\t\tif (item.def && value == null) {\r\n\t\t\tvalue = item.def;\r\n\t\t}\r\n\r\n\t\tif (item.format) {\r\n\t\t\tvalue = item.format(value, path);\r\n\t\t}\r\n\r\n\t\tvar tmp = null;\r\n\r\n\t\tcan = can !== false;\r\n\r\n\t\tif (item.show && (value != null || !item.show.$nn)) {\r\n\t\t\ttmp = item.show.call(item.el, value, path, item.el);\r\n\t\t\tel.tclass('hidden', !tmp);\r\n\t\t\tif (!tmp)\r\n\t\t\t\tcan = false;\r\n\t\t}\r\n\r\n\t\tif (item.hide && (value != null || !item.hide.$nn)) {\r\n\t\t\ttmp = item.hide.call(el, value, path, el);\r\n\t\t\tel.tclass('hidden', tmp);\r\n\t\t\tif (tmp)\r\n\t\t\t\tcan = false;\r\n\t\t}\r\n\r\n\t\tif (item.invisible && (value != null || !item.invisible.$nn)) {\r\n\t\t\ttmp = item.invisible.call(item.el, value, path, item.el);\r\n\t\t\tel.tclass('invisible', tmp);\r\n\t\t\tif (!tmp)\r\n\t\t\t\tcan = false;\r\n\t\t}\r\n\r\n\t\tif (item.visible && (value != null || !item.visible.$nn)) {\r\n\t\t\ttmp = item.visible.call(item.el, value, path, item.el);\r\n\t\t\tel.tclass('invisible', !tmp);\r\n\t\t\tif (!tmp)\r\n\t\t\t\tcan = false;\r\n\t\t}\r\n\r\n\t\tif (item.classes) {\r\n\t\t\tfor (var i = 0; i < item.classes.length; i++) {\r\n\t\t\t\tvar cls = item.classes[i];\r\n\t\t\t\tif (!cls.fn.$nn || value != null)\r\n\t\t\t\t\tel.tclass(cls.name, !!cls.fn.call(el, value, path, el));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (can && item.import) {\r\n\t\t\tif (typeof(item.import) === TYPE_FN) {\r\n\t\t\t\tif (value) {\r\n\t\t\t\t\t!item.$ic && (item.$ic = {});\r\n\t\t\t\t\t!item.$ic[value] && IMPORT('ONCE ' + value, el);\r\n\t\t\t\t\titem.$ic[value] = 1;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tIMPORT(item.import, el);\r\n\t\t\t\tdelete item.import;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (item.config && (can || item.config.$nv)) {\r\n\t\t\tif (value != null || !item.config.$nn) {\r\n\t\t\t\ttmp = item.config.call(el, value, path, el);\r\n\t\t\t\tif (tmp) {\r\n\t\t\t\t\tfor (var i = 0; i < el.length; i++) {\r\n\t\t\t\t\t\tvar c = el[i].$com;\r\n\t\t\t\t\t\tc && c.$ready && c.reconfigure(tmp);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (item.html && (can || item.html.$nv)) {\r\n\t\t\tif (value != null || !item.html.$nn) {\r\n\t\t\t\ttmp = item.html.call(el, value, path, el);\r\n\t\t\t\tel.html(tmp == null ? (item.htmlbk || '') : tmp);\r\n\t\t\t} else\r\n\t\t\t\tel.html(item.htmlbk || '');\r\n\t\t}\r\n\r\n\t\tif (item.text && (can || item.text.$nv)) {\r\n\t\t\tif (value != null || !item.text.$nn) {\r\n\t\t\t\ttmp = item.text.call(el, value, path, el);\r\n\t\t\t\tel.text(tmp == null ? (item.htmlbk || '') : tmp);\r\n\t\t\t} else\r\n\t\t\t\tel.html(item.htmlbk || '');\r\n\t\t}\r\n\r\n\t\tif (item.val && (can || item.val.$nv)) {\r\n\t\t\tif (value != null || !item.val.$nn) {\r\n\t\t\t\ttmp = item.val.call(el, value, path, el);\r\n\t\t\t\tel.val(tmp == null ? (item.valbk || '') : tmp);\r\n\t\t\t} else\r\n\t\t\t\tel.val(item.valbk || '');\r\n\t\t}\r\n\r\n\t\tif (item.template && (can || item.template.$nv) && (value != null || !item.template.$nn)) {\r\n\t\t\tDEFMODEL.value = value;\r\n\t\t\tDEFMODEL.path = path;\r\n\t\t\tel.html(item.template(DEFMODEL));\r\n\t\t}\r\n\r\n\t\tif (item.disabled && (can || item.disabled.$nv)) {\r\n\t\t\tif (value != null || !item.disabled.$nn) {\r\n\t\t\t\ttmp = item.disabled.call(el, value, path, el);\r\n\t\t\t\tel.prop('disabled', tmp == true);\r\n\t\t\t} else\r\n\t\t\t\tel.prop('disabled', item.disabledbk == true);\r\n\t\t}\r\n\r\n\t\tif (item.enabled && (can || item.enabled.$nv)) {\r\n\t\t\tif (value != null || !item.enabled.$nn) {\r\n\t\t\t\ttmp = item.enabled.call(el, value, path, el);\r\n\t\t\t\tel.prop('disabled', !tmp);\r\n\t\t\t} else\r\n\t\t\t\tel.prop('disabled', item.enabledbk == false);\r\n\t\t}\r\n\r\n\t\tif (item.checked && (can || item.checked.$nv)) {\r\n\t\t\tif (value != null || !item.checked.$nn) {\r\n\t\t\t\ttmp = item.checked.call(el, value, path, el);\r\n\t\t\t\tel.prop('checked', tmp == true);\r\n\t\t\t} else\r\n\t\t\t\tel.prop('checked', item.checkedbk == true);\r\n\t\t}\r\n\r\n\t\tif (item.title && (can || item.title.$nv)) {\r\n\t\t\tif (value != null || !item.title.$nn) {\r\n\t\t\t\ttmp = item.title.call(el, value, path, el);\r\n\t\t\t\tel.attr('title', tmp == null ? (item.titlebk || '') : tmp);\r\n\t\t\t} else\r\n\t\t\t\tel.attr('title', item.titlebk || '');\r\n\t\t}\r\n\r\n\t\tif (item.href && (can || item.href.$nv)) {\r\n\t\t\tif (value != null || !item.href.$nn) {\r\n\t\t\t\ttmp = item.href.call(el, value, path, el);\r\n\t\t\t\tel.attr('href', tmp == null ? (item.hrefbk || '') : tmp);\r\n\t\t\t} else\r\n\t\t\t\tel.attr(item.hrefbk || '');\r\n\t\t}\r\n\r\n\t\tif (item.src && (can || item.src.$nv)) {\r\n\t\t\tif (value != null || !item.src.$nn) {\r\n\t\t\t\ttmp = item.src.call(el, value, path, el);\r\n\t\t\t\tel.attr('src', tmp == null ? (item.srcbk || '') : tmp);\r\n\t\t\t} else\r\n\t\t\t\tel.attr('src', item.srcbk || '');\r\n\t\t}\r\n\r\n\t\tif (item.setter && (can || item.setter.$nv) && (value != null || !item.setter.$nn))\r\n\t\t\titem.setter.call(el, value, path, el);\r\n\r\n\t\tif (item.change && (value != null || !item.change.$nn))\r\n\t\t\titem.change.call(el, value, path, el);\r\n\r\n\t\tif (can && index == null && item.child) {\r\n\t\t\tfor (var i = 0; i < item.child.length; i++)\r\n\t\t\t\titem.exec(value, path, i, undefined, can);\r\n\t\t}\r\n\r\n\t\tif (item.tclass) {\r\n\t\t\tel.tclass(item.tclass);\r\n\t\t\tdelete item.tclass;\r\n\t\t}\r\n\t};\r\n\tfunction parsebinderskip(str) {\r\n\t\tvar a = arguments;\r\n\t\tfor (var i = 1; i < a.length; i++) {\r\n\t\t\tif (str.indexOf(a[i]) !== -1)\r\n\t\t\t\treturn false;\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\tfunction parsebinder(el, b, scopes, r) {\r\n\t\tvar meta = b.split(REGMETA);\r\n\t\tif (meta.indexOf('|') !== -1) {\r\n\t\t\t//Multiple watchers (__|__)\r\n\t\t\tif (!r) {\r\n\t\t\t\tvar tmp = [];\r\n\t\t\t\tvar output = [];\r\n\t\t\t\tfor (var i = 0; i < meta.length; i++) {\r\n\t\t\t\t\tvar m = meta[i];\r\n\t\t\t\t\tif (m === '|') {\r\n\t\t\t\t\t\tif (tmp.length) {\r\n\t\t\t\t\t\t\toutput.push(parsebinder(el, tmp.join('__'), scopes));\r\n\t\t\t\t\t\t} \r\n\t\t\t\t\t\ttmp = [];\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tm && tmp.push(m);\r\n\t\t\t\t}\r\n\t\t\t\tif (tmp.length) {\r\n\t\t\t\t\toutput.push(parsebinder(el, tmp.join('__'), scopes, true));\r\n\t\t\t\t} \r\n\t\t\t}\r\n\t\t\treturn output;\r\n\t\t}\r\n\r\n\t\tvar path = null;\r\n\t\tvar index = null;\r\n\t\tvar obj = new jBinder();\r\n\t\tvar cls = [];\r\n\t\tvar sub = {};\r\n\t\tvar e = obj.el = $(el);\r\n\r\n\t\tfor (var i = 0; i < meta.length; i++) {\r\n\t\t\tvar item = meta[i].trim();\r\n\t\t\tif (item) {\r\n\t\t\t\tif (i) {\r\n\r\n\t\t\t\t\tvar k, v;\r\n\r\n\t\t\t\t\tif (item !== 'template' && item !== '!template' && item !== 'strict') {\r\n\r\n\t\t\t\t\t\tindex = item.indexOf(':');\r\n\r\n\t\t\t\t\t\tif (index === -1) {\r\n\t\t\t\t\t\t\tindex = item.length;\r\n\t\t\t\t\t\t\titem += ':value';\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tk = item.substring(0, index).trim();\r\n\t\t\t\t\t\tv = item.substring(index + 1).trim();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tk = item;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (k === 'selector') {\r\n\t\t\t\t\t\tobj[k] = v;\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar rki = k.indexOf(' ');\r\n\t\t\t\t\tvar rk = rki === -1 ? k : k.substring(0, rki);\r\n\t\t\t\t\tvar fn = parsebinderskip(rk, 'setter', 'strict', 'track', 'delay', 'import', 'class', 'template') && k.substring(0, 3) !== 'def' ? v.indexOf('=>') !== -1 ? FN(rebinddecode(v)) : isValue(v) ? FN('(value,path,el)=>' + rebinddecode(v), true) : v.substring(0, 1) === '@' ? obj.com[v.substring(1)] : scopes.get(v) : 1;\r\n\t\t\t\t\tif (!fn)\r\n\t\t\t\t\t\treturn null;\r\n\r\n\t\t\t\t\tvar keys = k.split('+');\r\n\t\t\t\t\tfor (var j = 0; j < keys.length; j++) {\r\n\r\n\t\t\t\t\t\tk = keys[j].trim();\r\n\r\n\t\t\t\t\t\tvar s = '';\r\n\t\t\t\t\t\tvar notvisible = false;\r\n\t\t\t\t\t\tvar notnull = false;\r\n\t\t\t\t\t\tvar backup = false;\r\n\r\n\t\t\t\t\t\tindex = k.indexOf(' ');\r\n\t\t\t\t\t\tif (index !== -1) {\r\n\t\t\t\t\t\t\ts = k.substring(index + 1);\r\n\t\t\t\t\t\t\tk = k.substring(0, index);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tk = k.replace(/^(~!|!~|!|~)/, function(text) {\r\n\t\t\t\t\t\t\tif (text.indexOf('!') !== -1)\r\n\t\t\t\t\t\t\t\tnotnull = true;\r\n\t\t\t\t\t\t\tif (text.indexOf('~') !== -1)\r\n\t\t\t\t\t\t\t\tnotvisible = true;\r\n\t\t\t\t\t\t\treturn '';\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tvar c = k.substring(0, 1);\r\n\r\n\t\t\t\t\t\tif (k === 'class')\r\n\t\t\t\t\t\t\tk = 'tclass';\r\n\r\n\t\t\t\t\t\tif (c === '.') {\r\n\t\t\t\t\t\t\tif (notnull)\r\n\t\t\t\t\t\t\t\tfn.$nn = 1;\r\n\t\t\t\t\t\t\tcls.push({ name: k.substring(1), fn: fn });\r\n\t\t\t\t\t\t\tk = 'class';\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (typeof(fn) === TYPE_FN) {\r\n\t\t\t\t\t\t\tif (notnull)\r\n\t\t\t\t\t\t\t\tfn.$nn = 1;\r\n\t\t\t\t\t\t\tif (notvisible)\r\n\t\t\t\t\t\t\t\tfn.$nv = 1;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tswitch (k) {\r\n\t\t\t\t\t\t\tcase 'track':\r\n\t\t\t\t\t\t\t\tobj[k] = v.split(',').trim();\r\n\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\tcase 'strict':\r\n\t\t\t\t\t\t\t\tobj[k] = true;\r\n\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\tcase 'hidden':\r\n\t\t\t\t\t\t\t\tk = 'hide';\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 'exec':\r\n\t\t\t\t\t\t\t\tk = 'change';\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 'disable':\r\n\t\t\t\t\t\t\t\tk = 'disabled';\r\n\t\t\t\t\t\t\t\tbackup = true;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 'value':\r\n\t\t\t\t\t\t\t\tk = 'val';\r\n\t\t\t\t\t\t\t\tbackup = true;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 'default':\r\n\t\t\t\t\t\t\t\tk = 'def';\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 'delay':\r\n\t\t\t\t\t\t\t\tfn = +v;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 'href':\r\n\t\t\t\t\t\t\tcase 'src':\r\n\t\t\t\t\t\t\tcase 'val':\r\n\t\t\t\t\t\t\tcase 'title':\r\n\t\t\t\t\t\t\tcase 'html':\r\n\t\t\t\t\t\t\tcase 'text':\r\n\t\t\t\t\t\t\tcase 'disabled':\r\n\t\t\t\t\t\t\tcase 'enabled':\r\n\t\t\t\t\t\t\tcase 'checked':\r\n\t\t\t\t\t\t\t\tbackup = true;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\tcase 'setter':\r\n\t\t\t\t\t\t\t\tfn = langx.fn('(value,path,el)=>el.SETTER(' + v + ')');\r\n\t\t\t\t\t\t\t\tif (notnull)\r\n\t\t\t\t\t\t\t\t\tfn.$nn = 1;\r\n\t\t\t\t\t\t\t\tif (notvisible)\r\n\t\t\t\t\t\t\t\t\tfn.$nv =1;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 'import':\r\n\t\t\t\t\t\t\t\tvar c = v.substring(0, 1);\r\n\t\t\t\t\t\t\t\tif ((/^(https|http):\\/\\//).test(v) || c === '/' || c === '.') {\r\n\t\t\t\t\t\t\t\t\tif (c === '.')\r\n\t\t\t\t\t\t\t\t\t\tfn = v.substring(1);\r\n\t\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t\t\tfn = v;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t\tfn = FN(rebinddecode(v));\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 'tclass':\r\n\t\t\t\t\t\t\t\tfn = v;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 'template':\r\n\t\t\t\t\t\t\t\tvar scr = e.find('script');\r\n\t\t\t\t\t\t\t\tif (!scr.length) {\r\n\t\t\t\t\t\t\t\t\tscr = e;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tfn = Tangular.compile(scr.html());\r\n\t\t\t\t\t\t\t\tif (notnull) {\r\n\t\t\t\t\t\t\t\t\tfn.$nn = 1;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (notvisible) {\r\n\t\t\t\t\t\t\t\t\tfn.$nv = 1;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (k === 'def') {\r\n\t\t\t\t\t\t\tfn = new Function('return ' + v)();\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (backup && notnull) {\r\n\t\t\t\t\t\t\tobj[k + 'bk'] = (k == 'src' || k == 'href' || k == 'title') ? e.attr(k) : (k == 'html' || k == 'text') ? e.html() : k == 'val' ? e.val() : (k == 'disabled' || k == 'checked') ? e.prop(k) : '';\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (s) {\r\n\r\n\t\t\t\t\t\t\tif (!sub[s])\r\n\t\t\t\t\t\t\t\tsub[s] = {};\r\n\r\n\t\t\t\t\t\t\tif (k !== 'class')\r\n\t\t\t\t\t\t\t\tsub[s][k] = fn;\r\n\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tvar p = cls.pop();\r\n\t\t\t\t\t\t\t\tif (sub[s].cls) {\r\n\t\t\t\t\t\t\t\t\tsub[s].cls.push(p);\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tsub[s].cls = [p];\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif (k !== 'class') {\r\n\t\t\t\t\t\t\t\tobj[k] = fn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// path\r\n\t\t\t\t\tpath = item;\r\n\r\n\t\t\t\t\tvar c = path.substring(0, 1);\r\n\r\n\t\t\t\t\tif (c === '!') {\r\n\t\t\t\t\t\tpath = path.substring(1);\r\n\t\t\t\t\t\tobj.notnull = true;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (meta.length === 1) {\r\n\t\t\t\t\t\tvar fn = GET(path);\r\n\t\t\t\t\t\tfn && fn.call(obj.el, obj.el);\r\n\t\t\t\t\t\treturn fn ? fn : null;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar tmp = findFormat(path);\r\n\t\t\t\t\tif (tmp) {\r\n\t\t\t\t\t\tpath = tmp.path;\r\n\t\t\t\t\t\tobj.format = tmp.fn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Is virtual path?\r\n\t\t\t\t\tif (c === '.') {\r\n\t\t\t\t\t\tobj.virtual = true;\r\n\t\t\t\t\t\tpath = path.substring(1);\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (path.substring(path.length - 1) === '.')\r\n\t\t\t\t\t\tpath = path.substring(0, path.length - 1);\r\n\r\n\t\t\t\t\tif (path.substring(0, 1) === '@') {\r\n\t\t\t\t\t\tpath = path.substring(1);\r\n\r\n\t\t\t\t\t\tvar isCtrl = false;\r\n\t\t\t\t\t\tif (path.substring(0, 1) === '@') {\r\n\t\t\t\t\t\t\tisCtrl = true;\r\n\t\t\t\t\t\t\tpath = path.substring(1);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (!path)\r\n\t\t\t\t\t\t\tpath = '@';\r\n\r\n\t\t\t\t\t\tvar parent = el.parentNode;\r\n\t\t\t\t\t\twhile (parent) {\r\n\t\t\t\t\t\t\tif (isCtrl) {\r\n\t\t\t\t\t\t\t\tif (parent.$ctrl) {\r\n\t\t\t\t\t\t\t\t\tobj.com = parent.$ctrl;\r\n\t\t\t\t\t\t\t\t\tif (path === '@' && !obj.com.$dataw) {\r\n\t\t\t\t\t\t\t\t\t\tobj.com.$dataw = 1;\r\n\t\t\t\t\t\t\t\t\t\tobj.com.watch(function(path, value) {\r\n\t\t\t\t\t\t\t\t\t\t\tobj.com.data('@', value);\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tif (parent.$com) {\r\n\t\t\t\t\t\t\t\t\tobj.com = parent.$com;\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tparent = parent.parentNode;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (!obj.com)\r\n\t\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar keys = Object.keys(sub);\r\n\t\tfor (var i = 0; i < keys.length; i++) {\r\n\t\t\tvar key = keys[i];\r\n\t\t\tif (!obj.child)\r\n\t\t\t\tobj.child = [];\r\n\t\t\tvar o = sub[key];\r\n\t\t\to.selector = key;\r\n\t\t\tobj.child.push(o);\r\n\t\t}\r\n\r\n\t\tif (cls.length)\r\n\t\t\tobj.classes = cls;\r\n\r\n\t\tif (obj.virtual) {\r\n\t\t\tpath = pathmaker(path);\r\n\t\t} else {\r\n\r\n\t\t\tvar bj = obj.com && path.substring(0, 1) === '@';\r\n\t\t\tpath = bj ? path : pathmaker(path);\r\n\r\n\t\t\tif (path.indexOf('?') !== -1) {\r\n\t\t\t\t// jComponent scopes\r\n\t\t\t\t// You can use data-bind in jComponent scopes, but you need to defined ? (question mark) \r\n\t\t\t\t// on the start of data-bind path. Question mark ? will be replaced for a scope path.\r\n\t\t\t\tvar scope = initscopes(scopes);\r\n\t\t\t\tif (scope)\r\n\t\t\t\t\tpath = path.replace(/\\?/g, scope.path);\r\n\t\t\t\telse\r\n\t\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar arr = path.split('.');\r\n\t\t\tvar p = '';\r\n\r\n\t\t\tif (obj.com) {\r\n\t\t\t\t!obj.com.$data[path] && (obj.com.$data[path] = { value: null, items: [] });\r\n\t\t\t\tobj.com.$data[path].items.push(obj);\r\n\t\t\t} else {\r\n\t\t\t\tfor (var i = 0, length = arr.length; i < length; i++) {\r\n\t\t\t\t\tp += (p ? '.' : '') + arr[i];\r\n\t\t\t\t\tvar k = i === length - 1 ? p : '!' + p;\r\n\t\t\t\t\tif (binders[k]) {\r\n\t\t\t\t\t\tbinders[k].push(obj);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbinders[k] = [obj];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tobj.path = path;\r\n\r\n\t\tif (obj.track) {\r\n\t\t\tfor (var i = 0; i < obj.track.length; i++)\r\n\t\t\t\tobj.track[i] = path + '.' + obj.track[i];\r\n\t\t}\r\n\r\n\t\tobj.init = 0;\r\n\t\t!obj.virtual && bindersnew.push(obj);\r\n\t\treturn obj;\r\n\t}\r\n\t\r\n\t// ===============================================================\r\n\t// MAIN FUNCTIONS\r\n\t// ===============================================================\r\n\r\n   /**\r\n   * Evaluates a global parser.\r\n   * @param  {String} path \r\n   * @param  {Object} value\r\n   * @param  {String} type \r\n   * @returns {Boolean}   \r\n   * OR\r\n   * Registers a global parser.\r\n   * @param  {Function} value \r\n   */\r\n\tfunction parser(value, path, type) { //W.PARSER = M.parser =  \r\n\r\n\t\tif (langx.isFunction(value)) {\r\n\t\t\t!jc.$parser && (jc.$parser = []);\r\n\r\n\t\t\t// Prepend\r\n\t\t\tif (path === true) {\r\n\t\t\t\tjc.$parser.unshift(value);\r\n\t\t\t} else {\r\n\t\t\t\tjc.$parser.push(value);\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tvar a = jc.$parser;\r\n\t\tif (a && a.length) {\r\n\t\t\tfor (var i = 0, length = a.length; i < length; i++) {\r\n\t\t\t\tvalue = a[i].call(M, path, value, type);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn value;\r\n\t};\r\n\r\n\r\n\tfunction findFormat(val) {\r\n\t\tvar a = val.indexOf('-->');\r\n\t\tvar s = 3;\r\n\r\n\t\tif (a === -1) {\r\n\t\t\ta = val.indexOf('->');\r\n\t\t\ts = 2;\r\n\t\t}\r\n\r\n\t\tif (a !== -1) {\r\n\t\t\tif (val.indexOf('/') !== -1 && val.indexOf('(') === -1)\r\n\t\t\t\tval += '(value)';\r\n\t\t}\r\n\r\n\t\treturn a === -1 ? null : { \r\n\t\t\tpath: val.substring(0, a).trim(), \r\n\t\t\tfn: langx.fn(val.substring(a + s).trim()) \r\n\t\t};\r\n\t}\r\n\r\n\tjc.$parser.push(function(path, value, type) {\r\n\r\n\t\tswitch (type) {\r\n\t\t\tcase 'number':\r\n\t\t\tcase 'currency':\r\n\t\t\tcase 'float':\r\n\t\t\t\tvar v = +(langx.isString(value) ? value.replace(REGEMPTY, '').replace(REGCOMMA, '.') : value);\r\n\t\t\t\treturn isNaN(v) ? null : v;\r\n\r\n\t\t\tcase 'date':\r\n\t\t\tcase 'datetime':\r\n\r\n\t\t\t\tif (!value) {\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (value instanceof Date) {\r\n\t\t\t\t\treturn value;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvalue = value.parseDate();\r\n\t\t\t\treturn value && value.getTime() ? value : null;\r\n\t\t}\r\n\r\n\t\treturn value;\r\n\t});\r\n\r\n\tvar REGFNPLUGIN = /[a-z0-9_-]+\\/[a-z0-9_]+\\(|(^|(?=[^a-z0-9]))@[a-z0-9-_]+\\./i;\r\n\r\n\r\n\tvar regfnplugin = function(v) {\r\n\t\tvar l = v.length;\r\n\t\treturn pathmaker(v.substring(0, l - 1)) + v.substring(l - 1);\r\n\t};\r\n\r\n   /**\r\n   * Generates Function from expression of Arrow Function.\r\n   * @example var fn = FN('n => n.toUpperCase()');\r\n   *          console.log(fn('peter')); //Output: PETER\r\n   * @param  {String} exp \r\n   * @return {Function} \r\n   */\r\n\tfunction arrowFn(exp, notrim) {  // W.FN = \r\n\r\n\t\texp = exp.replace(REGFNPLUGIN, regfnplugin);\r\n\r\n\t\tvar index = exp.indexOf('=>');\r\n\t\tif (index === -1)\r\n\t\t\treturn isValue(exp) ? FN('value=>' + rebinddecode(exp), true) : new Function('return ' + (exp.indexOf('(') === -1 ? 'typeof({0})==\\'function\\'?{0}.apply(this,arguments):{0}'.format(exp) : exp));\r\n\r\n\t\tvar arg = exp.substring(0, index).trim();\r\n\t\tvar val = exp.substring(index + 2).trim();\r\n\t\tvar is = false;\r\n\r\n\t\targ = arg.replace(/\\(|\\)|\\s/g, '').trim();\r\n\t\tif (arg)\r\n\t\t\targ = arg.split(',');\r\n\r\n\t\tif (val.charCodeAt(0) === 123 && !notrim) {\r\n\t\t\tis = true;\r\n\t\t\tval = val.substring(1, val.length - 1).trim();\r\n\t\t}\r\n\r\n\r\n\t\tvar output = (is ? '' : 'return ') + val;\r\n\t\tswitch (arg.length) {\r\n\t\t\tcase 1:\r\n\t\t\t\treturn new Function(arg[0], output);\r\n\t\t\tcase 2:\r\n\t\t\t\treturn new Function(arg[0], arg[1], output);\r\n\t\t\tcase 3:\r\n\t\t\t\treturn new Function(arg[0], arg[1], arg[2], output);\r\n\t\t\tcase 4:\r\n\t\t\t\treturn new Function(arg[0], arg[1], arg[2], arg[3], output);\r\n\t\t\tcase 0:\r\n\t\t\tdefault:\r\n\t\t\t\treturn new Function(output);\r\n\t\t}\r\n\t};\r\n\r\n\tfunction VBinder(html) {\r\n\t\tvar t = this;\r\n\t\tvar e = t.element = $(html);\r\n\t\tt.binders = [];\r\n\t\tvar fn = function() {\r\n\t\t\tvar dom = this;\r\n\t\t\tvar el = $(dom);\r\n\t\t\tvar b = el.attrd('bind') || el.attr('bind') || el.attrd('vbind');\r\n\t\t\tdom.$jcbind = parser.parsebinder(dom, b, langx.empties.array); //EMPTYARRAY);\r\n\t\t\tif(dom.$jcbind) {\r\n\t\t\t   t.binders.push(dom.$jcbind);\r\n\t\t\t}\r\n\t\t};\r\n\t\te.filter(ATTRBIND).each(fn);\r\n\t\te.find(ATTRBIND).each(fn);\r\n\t}\r\n\r\n\tvar VBP = VBinder.prototype;\r\n\r\n\tVBP.on = function() {\r\n\t\tvar t = this;\r\n\t\tt.element.on.apply(t.element, arguments);\r\n\t\treturn t;\r\n\t};\r\n\r\n\tVBP.remove = function() {\r\n\t\tvar t = this;\r\n\t\tvar e = t.element;\r\n\t\te.find('*').off();\r\n\t\te.off().remove();\r\n\t\tt.element = null;\r\n\t\tt.binders = null;\r\n\t\tt = null;\r\n\t\treturn t;\r\n\t};\r\n\r\n\tVBP.set = function(path, model) {\r\n\r\n\t\tvar t = this;\r\n\r\n\t\tif (model == null) {\r\n\t\t\tmodel = path;\r\n\t\t\tpath = '';\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < t.binders.length; i++) {\r\n\t\t\tvar b = t.binders[i];\r\n\t\t\tif (!path || path === b.path) {\r\n\t\t\t\tvar val = path || !b.path ? model : $get(b.path, model);\r\n\t\t\t\tt.binders[i].exec(val, b.path);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn t;\r\n\t};\r\n\r\n\r\n\tfunction vbind(html) { // W.VBIND = \r\n\t\treturn new VBinder(html);\r\n\t};\r\n\r\n\tfunction vbindArray(html, el) { //W.VBINDARRAY = \r\n\t\tvar obj = {};\r\n\t\tobj.html = html;\r\n\t\tobj.items = [];\r\n\t\tobj.element = el instanceof COM ? el.element : $(el);\r\n\t\tobj.element[0].$vbindarray = obj;\r\n\t\tobj.remove = function() {\r\n\t\t\tfor (var i = 0; i < obj.items.length; i++)\r\n\t\t\t\tobj.items[i].remove();\r\n\t\t\tobj.checksum = null;\r\n\t\t\tobj.items = null;\r\n\t\t\tobj.html = null;\r\n\t\t\tobj.element = null;\r\n\t\t};\r\n\r\n\t\tvar serialize = function(val) {\r\n\t\t\tswitch (typeof(val)) {\r\n\t\t\t\tcase TYPE_N:\r\n\t\t\t\t\treturn val + '';\r\n\t\t\t\tcase 'boolean':\r\n\t\t\t\t\treturn val ? '1' : '0';\r\n\t\t\t\tcase TYPE_S:\r\n\t\t\t\t\treturn val;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\treturn val == null ? '' : val instanceof Date ? val.getTime() : JSON.stringify(val);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tvar checksum = function(item) {\r\n\t\t\tvar sum = 0;\r\n\t\t\tvar binder = obj.items[0];\r\n\t\t\tif (binder) {\r\n\t\t\t\tfor (var j = 0; j < binder.binders.length; j++) {\r\n\t\t\t\t\tvar b = binder.binders[j];\r\n\t\t\t\t\tvar p = b.path;\r\n\t\t\t\t\tif (b.track) {\r\n\t\t\t\t\t\tfor (var i = 0; i < b.track.length; i++)\r\n\t\t\t\t\t\t\tsum += serialize($get((p ? (p + '.') : '') + b.track[i].substring(1), item));\r\n\t\t\t\t\t} else\r\n\t\t\t\t\t\tsum += serialize(p ? $get(p, item) : item);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn HASH(sum);\r\n\t\t};\r\n\r\n\t\tobj.set = function(index, value) {\r\n\r\n\t\t\tvar sum = null;\r\n\r\n\t\t\tif (!(index instanceof Array)) {\r\n\t\t\t\tvar item = obj.items[index];\r\n\t\t\t\tif (item) {\r\n\t\t\t\t\tsum = checksum(value);\r\n\t\t\t\t\tvar el = item.element[0];\r\n\t\t\t\t\tif (el.$bchecksum !== sum) {\r\n\t\t\t\t\t\tel.$bchecksum = sum;\r\n\t\t\t\t\t\titem.set(value);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn obj;\r\n\t\t\t}\r\n\r\n\t\t\tvalue = index;\r\n\r\n\t\t\tif (obj.items.length > value.length) {\r\n\t\t\t\tvar rem = obj.items.splice(value.length);\r\n\t\t\t\tfor (var i = 0; i < rem.length; i++)\r\n\t\t\t\t\trem[i].remove();\r\n\t\t\t}\r\n\r\n\t\t\tfor (var i = 0; i < value.length; i++) {\r\n\t\t\t\tvar val = value[i];\r\n\t\t\t\tvar item = obj.items[i];\r\n\r\n\t\t\t\tif (!item) {\r\n\t\t\t\t\titem = vbind(obj.html); //VBIND\r\n\t\t\t\t\tobj.items.push(item);\r\n\t\t\t\t\titem.element.attrd('index', i);\r\n\t\t\t\t\titem.element[0].$vbind = item;\r\n\t\t\t\t\titem.index = i;\r\n\t\t\t\t\tobj.element.append(item.element);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar el = item.element[0];\r\n\t\t\t\tsum = checksum(val);\r\n\r\n\t\t\t\tif (el.$bchecksum !== sum) {\r\n\t\t\t\t\tel.$bchecksum = sum;\r\n\t\t\t\t\titem.set(val);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\treturn obj;\r\n\t};\r\n\r\n\treturn jc.binders = {\r\n\t\tparser,\r\n\r\n\t\tjBinder,\r\n\r\n\t\tVBinder,\r\n\t\tvbind,\r\n\t\tvbindArray\r\n\t};\r\n\r\n});"]}