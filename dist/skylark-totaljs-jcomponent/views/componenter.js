/**
 * skylark-totaljs-jcomponent - A version of totaljs jcomponent that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylarkui/skylark-totaljs-jcomponent/
 * @license MIT
 */
define(["../langx","../utils/domx","../utils/logs","../components/extensions","../components/registry"],function(e,t,i,n,a){var r=i.warn;return function(i){var a=i.helper,l=i.eventer,d=(i.storing,i.compiler),o=[],s={},v={dirty:{},valid:{},find:{},clear:function(e,t,i){for(var n=1;n<arguments.length;n++)this[arguments[n]]={}},get:function(e,t){this[e][t]},set:function(e,t,i){this[e][t]=i}},f={},u=0;function c(t,i,n,o){var f=!1;if(e.isFunction(i))f=!0,o=i,i=void 0;else if(e.isFunction(n)){var u=o;f=!0,o=n,n=u}if(!f){if("object"==typeof t){t instanceof jQuery||(t=$(t));var h=a.findComponent(t,"");return i?h:h[0]}var m;if(!n&&(m=t+"."+(i?0:1),h=v.get("find",m)))return h;var g=a.findComponent(null,t);return i||(g=g[0]),h=g,n||v.set("find",m,h),h}e.wait(function(){var e=c(t,i,n);return s[t]&&1===s[t].state&&(s[t].state=2,l.emit("lazy",t,!0),r("Lazy load: "+t),d.compile()),e instanceof Array?e.length>0:!!e},function(e){if(!e){var n=c(t,i);o.call(n||window,n)}},500,n)}function h(e,t){for(var i=[],n=!0===e?3:2,o=n;o<arguments.length;o++)i.push(arguments[o]);if(3===n){if(s[e=t]&&3!==s[e].state)return 1===s[e].state&&(s[e].state=2,l.emit("lazy",e,!0),r("Lazy load: "+e),d.compile()),setTimeout(function(e){e[0]=!0,h.apply(window,e)},555,arguments),SETTER;t=arguments[2],c(e,!0,function(e){for(var n=0,a=e.length;n<a;n++){var r=e[n];typeof r[t]===TYPE_FN?r[t].apply(r,i):r[t]=i[0]}})}else{if(s[e]&&3!==s[e].state)return 1===s[e].state&&(s[e].state=2,l.emit("lazy",e,!0),r("Lazy load: "+e),d.compile()),setTimeout(function(e){h.apply(window,e)},555,arguments),SETTER;for(var v=a.find(e,!0),f=(o=0,v.length);o<f;o++){var u=v[o];typeof u[t]===TYPE_FN?u[t].apply(u,i):u[t]=i[0]}}return this}return setInterval(function(){e.now(!0);for(var t=o,i=0,n=t.length;i<n;i++)t[i].knockknock&&t[i].knockknock(u);l.emit("knockknock",u++)},6e4),{autofill:[],cache:v,checkLazy:function(e){var t=s[e];if(!t){var i=e.substring(0,e.indexOf("@"));t=s[e]=i&&e!==i?s[i]={state:1}:{state:1}}return t},clean:function(){var e=o,i=0;for(length=e.length;i<length;){var n=e[i++];if(n){var a=n.element;!n.$removed&&a&&t.inDOM(a[0])?(n.$parser&&!n.$parser.length&&(n.$parser=void 0),n.$formatter&&!n.$formatter.length&&(n.$formatter=void 0)):(l.emit("destroy",n.name,n),l.emit("component.destroy",n.name,n),delete statics["$ST_"+n.name],n.destroy&&n.destroy(),$("#css"+n.ID).remove(),"BODY"!==a[0].nodeName&&(a.off(),a.find("*").off(),a.remove()),n.$main=void 0,n.$data=null,n.dom=null,n.$removed=2,n.path=null,n.setter=null,n.setter2=null,n.getter=null,n.getter2=null,n.make=null,i--,e.splice(i,1),length=e.length,is=!0)}else i--,e.splice(i,1),length=e.length}v.clear("dirty","valid","find")},components:o,com_valid:function(t,i,n){var a=i instanceof Array,r=t+(a?">"+i.join("|"):""),l=null;a&&(l=i,i=void 0);var d=v.get("valid",r);if("boolean"!=typeof i&&void 0!==d)return d;var s=null;if(a){var f=!1;s={},l=l.remove(function(e){return"@"===e.substring(0,1)&&(s[e.substring(1)]=!0,f=!0,!0)}),!f&&(s=null),a=l.length>0}d=!0;var u=void 0!==i?[]:null,c=t.lastIndexOf(".*"),h=-1!==c;-1!==c&&(t=t.substring(0,c)),t=pathmaker(t);for(var $=o,m=0,g=$.length;m<g;m++){var p=$[m];!(p&&!p.$removed&&p.$loaded&&p.path&&p.$compare(t))||a&&p.$except(l)||s&&(s.visible&&!p.visible()||s.hidden&&!p.hidden()||s.enabled&&p.find(SELINPUT).is(":disabled")||s.disabled&&p.find(SELINPUT).is(":enabled"))||(p.disabled||p.$valid_disabled?u&&p.state&&u.push(p):void 0!==i?(p.state&&u.push(p),n?n._id===p._id&&(p.$valid=i,p.$interaction(102)):(h||p.path===t)&&(p.$valid=i,p.$interaction(102)),!1===p.$valid&&(d=!1)):!1===p.$valid&&(d=!1))}return v.clear("valid"),v.set("valid",r,d),e.state(u,1,1),d},com_validate2:function(t){var i=!0;if(t.disabled)return i;if(t.$valid_disabled)return i;var n=[];return t.state&&n.push(t),t.$validate=!0,t.validate&&(t.$valid=t.validate(get(t.path)),t.$interaction(102),t.$valid||(i=!1)),v.clear("valid"),e.state(n,1,1),i},com_dirty:function(e,t,i,n){var a=t instanceof Array,r=e+(a?">"+t.join("|"):""),l=null;a&&(l=t,t=void 0);var d=v.get("dirty",r);if("boolean"!=typeof t&&void 0!==d)return d;d=!0;var s=void 0!==t?[]:null,f=null;if(a){var u=!1;f={},l=l.remove(function(e){return"@"===e.substring(0,1)&&(f[e.substring(1)]=!0,u=!0,!0)}),!u&&(f=null),a=l.length>0}var c=e.lastIndexOf(".*"),h=-1!==c;-1!==c&&(e=e.substring(0,c)),e=pathmaker(e);for(var $=o,m=0,g=$.length;m<g;m++){var p=$[m];!(p&&!p.$removed&&p.$loaded&&p.path&&p.$compare(e))||a&&p.$except(l)||f&&(f.visible&&!p.visible()||f.hidden&&!p.hidden()||f.enabled&&p.find(SELINPUT).is(":disabled")||f.disabled&&p.find(SELINPUT).is(":enabled"))||(p.disabled||p.$dirty_disabled?s&&p.state&&s.push(p):void 0!==t?(p.state&&s.push(p),i?i._id===p._id&&(p.$dirty=t,p.$interaction(101)):(h||p.path===e)&&(p.$dirty=t,p.$interaction(101)),!1===p.$dirty&&(d=!1)):!1===p.$dirty&&(d=!1))}return v.clear("dirty"),v.set("dirty",r,d),!n&&state(s,1,2),d},each:function(e,t){var i=!!t&&-1!==t.lastIndexOf("*");i&&(t=t.replace(".*",""));for(var n=o,a=0,r=0,l=n.length;r<l;r++){var d=n[r];if(d&&d.$loaded&&!d.$removed&&(!t||d.path&&d.$compare(t))&&!0===e(d,a++,i))return this}return this},find:c,notify:function(){for(var e=arguments,t=o,i=Math.random().toString().substring(2,8),n=0;n<e.length;n++){var a=e[n];binders[a]&&binderbind(a,a,i)}for(var r=0,d=t.length;r<d;r++){var s=t[r];if(s&&!s.$removed&&!s.disabled&&s.$loaded&&s.path){var v=0;for(n=0;n<e.length;n++)if(s.path===e[n]){v=1;break}if(v){var f=s.get();s.setter&&s.setterX(f,s.path,1),s.state&&s.stateX(1,6),s.$interaction(1)}}}for(n=0;n<e.length;n++)l.emitwatch(e[n],getx(e[n]),1);return this},prepare:function(t){if(t){var r=t.element;n[t.name]&&n[t.name].forEach(function(i){i.config&&t.reconfigure(i.config,e.empties.fn),i.fn.call(t,t,t.config)});var d,o=t.get();t.configure&&t.reconfigure(t.config,void 0,!0),t.$loaded=!0,t.setter?t.$prepared||(t.$prepared=!0,t.$ready=!0,(d=a.attrcom(t,"value"))&&(f[d]||(f[d]=new Function("return "+d)),t.$default=f[d],void 0===o&&(o=t.$default(),i.storing.set(t.path,o),l.emitwatch(t.path,o,0))),t.$binded?t.$interaction(0):(t.$binded=!0,t.setterX(o,t.path,0),t.$interaction(0))):t.$binded=!0,t.validate&&!t.$valid_disabled&&(t.$valid=t.validate(t.get(),!0)),t.done&&setTimeout(t.done,20),t.state&&t.stateX(0,3),t.$init&&setTimeout(function(){var i=get(t.$init);e.isFunction(i)&&i.call(t,t),t.$init=void 0},5);var s="component";r.trigger(s),r.off(s);var u=a.attrcom(r,"class");u&&function(e){setTimeout(function(){e=e.split(" ");for(var t=r[0].$jclass||{},i=0,n=e.length;i<n;i++)t[e[i]]||(r.tclass(e[i]),t[e[i]]=!0);r[0].$jclass=t},5)}(u),t.id&&l.emit("#"+t.id,t),l.emit("@"+t.name,t),l.emit(s,t),v.clear("find"),t.$lazy&&(t.$lazy.state=3,delete t.$lazy,l.emit("lazy",t.$name,!1))}},reconfigure:function(e,t){return h(!0,e,"reconfigure",t),this},setter:h,usage:function(t,i,n,a){e.isString(i)?i=e.now(!0).add("-"+i.env()).getTime():e.isNumber(i)&&(i=Date.now()-i),e.isFunction(n)&&(a=n,n=void 0);var r=[],l=null;l=n?c("."+n,!0):o;for(var d=0;d<l.length;d++){var s=l[d];s.usage[t]>=i&&(a?a(s):r.push(s))}return a?M:r},validate:function(e,t){var i=[],n=!0;e=pathmaker(e.replaceWildcard());var a=null;if(t){var r=!1;a={},t=t.remove(function(e){return"@"===e.substring(0,1)&&(a[e.substring(1)]=!0,r=!0,!0)}),!r&&(a=null),!t.length&&(t=null)}for(var l=o,d=0,s=l.length;d<s;d++){var f=l[d];f&&!f.$removed&&!f.disabled&&f.$loaded&&f.path&&f.$compare(e)&&(a&&(a.visible&&!f.visible()||a.hidden&&!f.hidden()||a.enabled&&f.find(SELINPUT).is(":disabled")||a.disabled&&f.find(SELINPUT).is(":enabled"))||(f.state&&i.push(f),f.$valid_disabled||(f.$validate=!0,f.validate&&(f.$valid=f.validate(get(f.path)),f.$interaction(102),f.$valid||(n=!1)))))}return v.clear("valid"),state(i,1,1),n}}}});
//# sourceMappingURL=../sourcemaps/views/componenter.js.map
